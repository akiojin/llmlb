var Ks=s=>{throw TypeError(s)};var Ns=(s,t,a)=>t.has(s)||Ks("Cannot "+a);var I=(s,t,a)=>(Ns(s,t,"read from private field"),a?a.call(s):t.get(s)),Ce=(s,t,a)=>t.has(s)?Ks("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(s):t.set(s,a),ke=(s,t,a,n)=>(Ns(s,t,"write to private field"),n?n.call(s,a):t.set(s,a),a),Se=(s,t,a)=>(Ns(s,t,"access private method"),a);import{r,i as Vs,a as bs,b as Zt,j as e,c as E,g as Jt,d as Ms,P as Qs,e as be,u as Ws,f as xs,h as _e,k as Xt,l as T,m as Yt,n as Zs,B as b,o as me,L as F,I as L,t as A,p as ws,U as Js,q as ns,s as Cs,C as Xs,v as U,w as ks,x as As,y as Ne,z as Ae,A as is,D as ea,T as sa,E as ta}from"./index-DUI-Q704.js";import{S as aa,s as ra,h as Us,g as na,n as Ys,u as ye,a as ia,b as la,c as ca,C as De,d as et,O as oa,P as da,W as ha,e as ua,T as ma,D as xa,f as st,R as pa,i as ja,j as ie,k as Q,l as W,m as Z,o as J,p as X,q as Be,r as we,t as $e,v as Ee,B as D,w as Ve,x as xe,y as Me,z as Te,A as Ie,E as Fe,F as q,M as ds,G as ga,H as fa,I as va,J as ya,K as Na,L as ba,N as Ss,Q as Ke,U as zs,V as wa,X as tt,Y as Ca,Z as ka,_ as at,$ as Sa,a0 as _a,a1 as Aa,a2 as Ra,a3 as Da,a4 as Ea,a5 as Ma}from"./switch-BF5otp4n.js";import{T as Rs,C as hs}from"./ticket-BxasYKSl.js";import{C as re,a as ne,b as fe,c as ve}from"./card-DWuEv-p2.js";var de,je,V,he,ue,cs,Ds,Bs,Ta=(Bs=class extends aa{constructor(t,a){super();Ce(this,ue);Ce(this,de);Ce(this,je);Ce(this,V);Ce(this,he);ke(this,de,t),this.setOptions(a),this.bindMethods(),Se(this,ue,cs).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var n;const a=this.options;this.options=I(this,de).defaultMutationOptions(t),ra(this.options,a)||I(this,de).getMutationCache().notify({type:"observerOptionsUpdated",mutation:I(this,V),observer:this}),a!=null&&a.mutationKey&&this.options.mutationKey&&Us(a.mutationKey)!==Us(this.options.mutationKey)?this.reset():((n=I(this,V))==null?void 0:n.state.status)==="pending"&&I(this,V).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=I(this,V))==null||t.removeObserver(this)}onMutationUpdate(t){Se(this,ue,cs).call(this),Se(this,ue,Ds).call(this,t)}getCurrentResult(){return I(this,je)}reset(){var t;(t=I(this,V))==null||t.removeObserver(this),ke(this,V,void 0),Se(this,ue,cs).call(this),Se(this,ue,Ds).call(this)}mutate(t,a){var n;return ke(this,he,a),(n=I(this,V))==null||n.removeObserver(this),ke(this,V,I(this,de).getMutationCache().build(I(this,de),this.options)),I(this,V).addObserver(this),I(this,V).execute(t)}},de=new WeakMap,je=new WeakMap,V=new WeakMap,he=new WeakMap,ue=new WeakSet,cs=function(){var a;const t=((a=I(this,V))==null?void 0:a.state)??na();ke(this,je,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},Ds=function(t){Ys.batch(()=>{var a,n,i,l,c,u,f,d;if(I(this,he)&&this.hasListeners()){const m=I(this,je).variables,p=I(this,je).context,j={client:I(this,de),meta:this.options.meta,mutationKey:this.options.mutationKey};if((t==null?void 0:t.type)==="success"){try{(n=(a=I(this,he)).onSuccess)==null||n.call(a,t.data,m,p,j)}catch(w){Promise.reject(w)}try{(l=(i=I(this,he)).onSettled)==null||l.call(i,t.data,null,m,p,j)}catch(w){Promise.reject(w)}}else if((t==null?void 0:t.type)==="error"){try{(u=(c=I(this,he)).onError)==null||u.call(c,t.error,m,p,j)}catch(w){Promise.reject(w)}try{(d=(f=I(this,he)).onSettled)==null||d.call(f,void 0,t.error,m,p,j)}catch(w){Promise.reject(w)}}}this.listeners.forEach(m=>{m(I(this,je))})})},Bs);function Y(s,t){const a=ye(),[n]=r.useState(()=>new Ta(a,s));r.useEffect(()=>{n.setOptions(s)},[n,s]);const i=r.useSyncExternalStore(r.useCallback(c=>n.subscribe(Ys.batchCalls(c)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),l=r.useCallback((c,u)=>{n.mutate(c,u).catch(ia)},[n]);if(i.error&&la(n.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:l,mutateAsync:i.mutate}}const rt=r.createContext(null);function Ia({children:s}){const[t,a]=r.useState(null),[n,i]=r.useState(!0),l=r.useCallback(async()=>{if(!Vs()){a(null),i(!1);return}try{const f=await bs.me();a(f)}catch{Zt(),a(null)}finally{i(!1)}},[]),c=r.useCallback(async(f,d)=>{await bs.login(f,d),await l()},[l]),u=r.useCallback(async()=>{await bs.logout(),a(null),window.location.href="/dashboard/login.html"},[]);return r.useEffect(()=>{l()},[l]),e.jsx(rt.Provider,{value:{user:t,isLoading:n,isLoggedIn:!!t,login:c,logout:u,checkAuth:l},children:s})}function Ts(){const s=r.useContext(rt);if(!s)throw new Error("useAuth must be used within an AuthProvider");return s}/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fa=E("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pa=E("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=E("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qa=E("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oa=E("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=E("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=E("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=E("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=E("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ls=E("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const La=E("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ka=E("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ua=E("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=E("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const za=E("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $a=E("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=E("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ha=E("Hourglass",[["path",{d:"M5 22h14",key:"ehvnwv"}],["path",{d:"M5 2h14",key:"pdyrp9"}],["path",{d:"M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22",key:"1d314k"}],["path",{d:"M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2",key:"1vvvr6"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ga=E("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=E("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=E("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=E("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=E("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Va=E("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=E("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=E("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qa=E("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wa=E("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Za=E("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Es=E("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ja=E("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function Xa(s={}){const{onMessage:t,onConnect:a,onDisconnect:n,reconnectInterval:i=3e3}=s,l=ye(),c=r.useRef(null),u=r.useRef(null),[f,d]=r.useState(!1),[m,p]=r.useState(null),j=r.useCallback(()=>{const v=Jt();if(!v){console.warn("No JWT token available for WebSocket connection"),u.current=setTimeout(j,i);return}const S=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws/dashboard?token=${encodeURIComponent(v)}`;try{const k=new WebSocket(S);c.current=k,k.onopen=()=>{d(!0),a==null||a()},k.onmessage=x=>{try{const _=JSON.parse(x.data);switch(p(_),t==null||t(_),_.type){case"NodeRegistered":case"NodeRemoved":case"NodeStatusChanged":l.invalidateQueries({queryKey:["dashboard-overview"]}),l.invalidateQueries({queryKey:["request-responses"]});break;case"MetricsUpdated":l.invalidateQueries({queryKey:["dashboard-overview"]});break}}catch(_){console.error("Failed to parse WebSocket message:",_)}},k.onclose=()=>{d(!1),n==null||n(),c.current=null,u.current&&clearTimeout(u.current),u.current=setTimeout(j,i)},k.onerror=x=>{console.error("WebSocket error:",x),k.close()}}catch(k){console.error("Failed to create WebSocket:",k),u.current=setTimeout(j,i)}},[t,a,n,i,l]),w=r.useCallback(()=>{u.current&&(clearTimeout(u.current),u.current=null),c.current&&(c.current.close(),c.current=null),d(!1)},[]);return r.useEffect(()=>(j(),()=>{w()}),[j,w]),{isConnected:f,lastEvent:m,reconnect:j,disconnect:w}}function Ya(){const{isConnected:s,lastEvent:t,reconnect:a}=Xa({onConnect:()=>{console.log("Dashboard WebSocket connected")},onDisconnect:()=>{console.log("Dashboard WebSocket disconnected")}});return{isConnected:s,lastEvent:t,reconnect:a}}const _s="llmlb-theme";function er(){const[s,t]=r.useState(()=>{if(typeof window>"u")return"dark";const n=localStorage.getItem(_s);return n==="light"||n==="dark"?n:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"});r.useEffect(()=>{document.documentElement.classList.toggle("dark",s==="dark"),localStorage.setItem(_s,s)},[s]),r.useEffect(()=>{const n=window.matchMedia("(prefers-color-scheme: dark)"),i=l=>{localStorage.getItem(_s)||t(l.matches?"dark":"light")};return n.addEventListener("change",i),()=>n.removeEventListener("change",i)},[]);const a=r.useCallback(()=>{t(n=>n==="dark"?"light":"dark")},[]);return{theme:s,setTheme:t,toggleTheme:a}}var ps="Checkbox",[sr]=Ms(ps),[tr,Is]=sr(ps);function ar(s){const{__scopeCheckbox:t,checked:a,children:n,defaultChecked:i,disabled:l,form:c,name:u,onCheckedChange:f,required:d,value:m="on",internal_do_not_use_render:p}=s,[j,w]=Ws({prop:a,defaultProp:i??!1,onChange:f,caller:ps}),[v,y]=r.useState(null),[S,k]=r.useState(null),x=r.useRef(!1),_=v?!!c||!!v.closest("form"):!0,O={checked:j,disabled:l,setChecked:w,control:v,setControl:y,name:u,form:c,value:m,hasConsumerStoppedPropagationRef:x,required:d,defaultChecked:ge(i)?!1:i,isFormControl:_,bubbleInput:S,setBubbleInput:k};return e.jsx(tr,{scope:t,...O,children:rr(p)?p(O):n})}var dt="CheckboxTrigger",ht=r.forwardRef(({__scopeCheckbox:s,onKeyDown:t,onClick:a,...n},i)=>{const{control:l,value:c,disabled:u,checked:f,required:d,setControl:m,setChecked:p,hasConsumerStoppedPropagationRef:j,isFormControl:w,bubbleInput:v}=Is(dt,s),y=xs(i,m),S=r.useRef(f);return r.useEffect(()=>{const k=l==null?void 0:l.form;if(k){const x=()=>p(S.current);return k.addEventListener("reset",x),()=>k.removeEventListener("reset",x)}},[l,p]),e.jsx(be.button,{type:"button",role:"checkbox","aria-checked":ge(f)?"mixed":f,"aria-required":d,"data-state":jt(f),"data-disabled":u?"":void 0,disabled:u,value:c,...n,ref:y,onKeyDown:_e(t,k=>{k.key==="Enter"&&k.preventDefault()}),onClick:_e(a,k=>{p(x=>ge(x)?!0:!x),v&&w&&(j.current=k.isPropagationStopped(),j.current||k.stopPropagation())})})});ht.displayName=dt;var Fs=r.forwardRef((s,t)=>{const{__scopeCheckbox:a,name:n,checked:i,defaultChecked:l,required:c,disabled:u,value:f,onCheckedChange:d,form:m,...p}=s;return e.jsx(ar,{__scopeCheckbox:a,checked:i,defaultChecked:l,disabled:u,required:c,onCheckedChange:d,name:n,form:m,value:f,internal_do_not_use_render:({isFormControl:j})=>e.jsxs(e.Fragment,{children:[e.jsx(ht,{...p,ref:t,__scopeCheckbox:a}),j&&e.jsx(pt,{__scopeCheckbox:a})]})})});Fs.displayName=ps;var ut="CheckboxIndicator",mt=r.forwardRef((s,t)=>{const{__scopeCheckbox:a,forceMount:n,...i}=s,l=Is(ut,a);return e.jsx(Qs,{present:n||ge(l.checked)||l.checked===!0,children:e.jsx(be.span,{"data-state":jt(l.checked),"data-disabled":l.disabled?"":void 0,...i,ref:t,style:{pointerEvents:"none",...s.style}})})});mt.displayName=ut;var xt="CheckboxBubbleInput",pt=r.forwardRef(({__scopeCheckbox:s,...t},a)=>{const{control:n,hasConsumerStoppedPropagationRef:i,checked:l,defaultChecked:c,required:u,disabled:f,name:d,value:m,form:p,bubbleInput:j,setBubbleInput:w}=Is(xt,s),v=xs(a,w),y=ca(l),S=Xt(n);r.useEffect(()=>{const x=j;if(!x)return;const _=window.HTMLInputElement.prototype,K=Object.getOwnPropertyDescriptor(_,"checked").set,z=!i.current;if(y!==l&&K){const N=new Event("click",{bubbles:z});x.indeterminate=ge(l),K.call(x,ge(l)?!1:l),x.dispatchEvent(N)}},[j,y,l,i]);const k=r.useRef(ge(l)?!1:l);return e.jsx(be.input,{type:"checkbox","aria-hidden":!0,defaultChecked:c??k.current,required:u,disabled:f,name:d,value:m,form:p,...t,tabIndex:-1,ref:v,style:{...t.style,...S,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});pt.displayName=xt;function rr(s){return typeof s=="function"}function ge(s){return s==="indeterminate"}function jt(s){return ge(s)?"indeterminate":s?"checked":"unchecked"}const gt=r.forwardRef(({className:s,...t},a)=>e.jsx(Fs,{ref:a,className:T("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...t,children:e.jsx(mt,{className:T("flex items-center justify-center text-current"),children:e.jsx(De,{className:"h-4 w-4"})})}));gt.displayName=Fs.displayName;const Pe=r.forwardRef(({className:s,...t},a)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:a,className:T("w-full caption-bottom text-sm",s),...t})}));Pe.displayName="Table";const qe=r.forwardRef(({className:s,...t},a)=>e.jsx("thead",{ref:a,className:T("[&_tr]:border-b",s),...t}));qe.displayName="TableHeader";const Oe=r.forwardRef(({className:s,...t},a)=>e.jsx("tbody",{ref:a,className:T("[&_tr:last-child]:border-0",s),...t}));Oe.displayName="TableBody";const nr=r.forwardRef(({className:s,...t},a)=>e.jsx("tfoot",{ref:a,className:T("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...t}));nr.displayName="TableFooter";const ee=r.forwardRef(({className:s,...t},a)=>e.jsx("tr",{ref:a,className:T("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...t}));ee.displayName="TableRow";const M=r.forwardRef(({className:s,...t},a)=>e.jsx("th",{ref:a,className:T("h-11 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...t}));M.displayName="TableHead";const R=r.forwardRef(({className:s,...t},a)=>e.jsx("td",{ref:a,className:T("p-4 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...t}));R.displayName="TableCell";const ir=r.forwardRef(({className:s,...t},a)=>e.jsx("caption",{ref:a,className:T("mt-4 text-sm text-muted-foreground",s),...t}));ir.displayName="TableCaption";var ft="AlertDialog",[lr]=Ms(ft,[et]),pe=et(),vt=s=>{const{__scopeAlertDialog:t,...a}=s,n=pe(t);return e.jsx(pa,{...n,...a,modal:!0})};vt.displayName=ft;var cr="AlertDialogTrigger",or=r.forwardRef((s,t)=>{const{__scopeAlertDialog:a,...n}=s,i=pe(a);return e.jsx(ja,{...i,...n,ref:t})});or.displayName=cr;var dr="AlertDialogPortal",yt=s=>{const{__scopeAlertDialog:t,...a}=s,n=pe(t);return e.jsx(da,{...n,...a})};yt.displayName=dr;var hr="AlertDialogOverlay",Nt=r.forwardRef((s,t)=>{const{__scopeAlertDialog:a,...n}=s,i=pe(a);return e.jsx(oa,{...i,...n,ref:t})});Nt.displayName=hr;var Re="AlertDialogContent",[ur,mr]=lr(Re),xr=Yt("AlertDialogContent"),bt=r.forwardRef((s,t)=>{const{__scopeAlertDialog:a,children:n,...i}=s,l=pe(a),c=r.useRef(null),u=xs(t,c),f=r.useRef(null);return e.jsx(ha,{contentName:Re,titleName:wt,docsSlug:"alert-dialog",children:e.jsx(ur,{scope:a,cancelRef:f,children:e.jsxs(ua,{role:"alertdialog",...l,...i,ref:u,onOpenAutoFocus:_e(i.onOpenAutoFocus,d=>{var m;d.preventDefault(),(m=f.current)==null||m.focus({preventScroll:!0})}),onPointerDownOutside:d=>d.preventDefault(),onInteractOutside:d=>d.preventDefault(),children:[e.jsx(xr,{children:n}),e.jsx(jr,{contentRef:c})]})})})});bt.displayName=Re;var wt="AlertDialogTitle",Ct=r.forwardRef((s,t)=>{const{__scopeAlertDialog:a,...n}=s,i=pe(a);return e.jsx(ma,{...i,...n,ref:t})});Ct.displayName=wt;var kt="AlertDialogDescription",St=r.forwardRef((s,t)=>{const{__scopeAlertDialog:a,...n}=s,i=pe(a);return e.jsx(xa,{...i,...n,ref:t})});St.displayName=kt;var pr="AlertDialogAction",_t=r.forwardRef((s,t)=>{const{__scopeAlertDialog:a,...n}=s,i=pe(a);return e.jsx(st,{...i,...n,ref:t})});_t.displayName=pr;var At="AlertDialogCancel",Rt=r.forwardRef((s,t)=>{const{__scopeAlertDialog:a,...n}=s,{cancelRef:i}=mr(At,a),l=pe(a),c=xs(t,i);return e.jsx(st,{...l,...n,ref:c})});Rt.displayName=At;var jr=({contentRef:s})=>{const t=`\`${Re}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Re}\` by passing a \`${kt}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Re}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return r.useEffect(()=>{var n;document.getElementById((n=s.current)==null?void 0:n.getAttribute("aria-describedby"))||console.warn(t)},[t,s]),null},gr=vt,fr=yt,Dt=Nt,Et=bt,Mt=_t,Tt=Rt,It=Ct,Ft=St;const js=gr,vr=fr,Pt=r.forwardRef(({className:s,...t},a)=>e.jsx(Dt,{className:T("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t,ref:a}));Pt.displayName=Dt.displayName;const Qe=r.forwardRef(({className:s,...t},a)=>e.jsxs(vr,{children:[e.jsx(Pt,{}),e.jsx(Et,{ref:a,className:T("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...t})]}));Qe.displayName=Et.displayName;const We=({className:s,...t})=>e.jsx("div",{className:T("flex flex-col space-y-2 text-center sm:text-left",s),...t});We.displayName="AlertDialogHeader";const Ze=({className:s,...t})=>e.jsx("div",{className:T("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t});Ze.displayName="AlertDialogFooter";const Je=r.forwardRef(({className:s,...t},a)=>e.jsx(It,{ref:a,className:T("text-lg font-semibold",s),...t}));Je.displayName=It.displayName;const Xe=r.forwardRef(({className:s,...t},a)=>e.jsx(Ft,{ref:a,className:T("text-sm text-muted-foreground",s),...t}));Xe.displayName=Ft.displayName;const Ye=r.forwardRef(({className:s,...t},a)=>e.jsx(Mt,{ref:a,className:T(Zs(),s),...t}));Ye.displayName=Mt.displayName;const es=r.forwardRef(({className:s,...t},a)=>e.jsx(Tt,{ref:a,className:T(Zs({variant:"outline"}),"mt-2 sm:mt-0",s),...t}));es.displayName=Tt.displayName;function yr({open:s,onOpenChange:t}){const a=ye(),[n,i]=r.useState(!1),[l,c]=r.useState(null),[u,f]=r.useState(""),[d,m]=r.useState(""),[p,j]=r.useState(["api"]),[w,v]=r.useState(null),[y,S]=r.useState(null),[k,x]=r.useState(null),{data:_,isLoading:O,refetch:K}=ie({queryKey:["api-keys"],queryFn:ws.list,enabled:s}),z=Y({mutationFn:g=>ws.create(g),onSuccess:g=>{a.invalidateQueries({queryKey:["api-keys"]}),v(g.key),f(""),m(""),j(["api"]),A({title:"API key created"})},onError:g=>{A({title:"Failed to create API key",description:g instanceof Error?g.message:"Unknown error",variant:"destructive"})}}),N=Y({mutationFn:g=>ws.delete(g),onSuccess:()=>{a.invalidateQueries({queryKey:["api-keys"]}),c(null),A({title:"API key deleted"})},onError:g=>{A({title:"Failed to delete API key",description:g instanceof Error?g.message:"Unknown error",variant:"destructive"})}});r.useEffect(()=>{s||(v(null),S(null))},[s]),r.useEffect(()=>{n||(f(""),m(""),j(["api"]))},[n]);const H=async(g,P)=>{try{await navigator.clipboard.writeText(g),x(P),setTimeout(()=>x(null),2e3),A({title:"Copied to clipboard"})}catch{A({title:"Failed to copy",variant:"destructive"})}},C=()=>{z.mutate({name:u,expires_at:d||void 0,scopes:p})},se=g=>g?new Date(g)<new Date:!1,le=(g,P)=>{j(o=>P?o.includes(g)?o:[...o,g]:o.filter($=>$!==g))},ce=[{value:"api",label:"api",description:"OpenAI-compatible API inference access"},{value:"node",label:"node",description:"Endpoint registration and sync"},{value:"admin",label:"admin",description:"Administrator (full access)"}];return e.jsxs(e.Fragment,{children:[e.jsx(Q,{open:s,onOpenChange:t,children:e.jsxs(W,{id:"api-keys-modal",className:"max-w-3xl max-h-[80vh] overflow-hidden",children:[e.jsxs(Z,{children:[e.jsxs(J,{className:"flex items-center gap-2",children:[e.jsx(ms,{className:"h-5 w-5"}),"API Keys"]}),e.jsx(X,{children:"Manage your API keys for programmatic access."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(b,{id:"create-api-key",onClick:()=>i(!0),children:[e.jsx(Be,{className:"mr-2 h-4 w-4"}),"Create Key"]}),e.jsx(b,{variant:"outline",size:"icon",onClick:()=>K(),children:e.jsx(we,{className:"h-4 w-4"})})]}),w&&e.jsxs("div",{className:"rounded-lg border border-success/50 bg-success/10 p-4",children:[e.jsx("p",{className:"text-sm font-medium text-success mb-2",children:"API Key Created Successfully"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Copy this key now. You won't be able to see it again."}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"flex-1 rounded bg-muted px-2 py-1 text-xs font-mono break-all",children:y==="created"?w:"•".repeat(32)}),e.jsx(b,{variant:"ghost",size:"icon",onClick:()=>S(y==="created"?null:"created"),children:y==="created"?e.jsx(Ka,{className:"h-4 w-4"}):e.jsx(Ua,{className:"h-4 w-4"})}),e.jsx(b,{id:"copy-api-key",variant:"ghost",size:"icon",onClick:()=>H(w,"created"),children:k==="created"?e.jsx(De,{className:"h-4 w-4"}):e.jsx($e,{className:"h-4 w-4"})})]})]}),e.jsx(Ee,{className:"h-64 rounded-md border",children:O?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(te,{className:"h-6 w-6 animate-spin"})}):!_||_.length===0?e.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-2 text-muted-foreground",children:[e.jsx(ms,{className:"h-8 w-8"}),e.jsx("p",{children:"No API keys"})]}):e.jsxs(Pe,{children:[e.jsx(qe,{children:e.jsxs(ee,{children:[e.jsx(M,{children:"Name"}),e.jsx(M,{children:"Scopes"}),e.jsx(M,{children:"Key"}),e.jsx(M,{children:"Created"}),e.jsx(M,{children:"Expires"}),e.jsx(M,{className:"text-right",children:"Actions"})]})}),e.jsx(Oe,{children:_.map(g=>e.jsxs(ee,{children:[e.jsx(R,{className:"font-medium",children:g.name}),e.jsx(R,{children:e.jsx("div",{className:"flex flex-wrap gap-1",children:g.scopes.map(P=>e.jsx(D,{variant:"secondary",children:P},P))})}),e.jsx(R,{children:g.key_prefix?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("code",{className:"text-xs font-mono",children:[g.key_prefix,"..."]}),e.jsx(b,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>H(g.key_prefix,g.id),children:k===g.id?e.jsx(De,{className:"h-3 w-3"}):e.jsx($e,{className:"h-3 w-3"})})]}):e.jsxs("span",{className:"text-xs text-muted-foreground",children:[g.id.slice(0,8),"..."]})}),e.jsx(R,{className:"text-sm text-muted-foreground",children:me(g.created_at)}),e.jsx(R,{children:g.expires_at?e.jsx(D,{variant:se(g.expires_at)?"destructive":"outline",children:se(g.expires_at)?"Expired":me(g.expires_at)}):e.jsx(D,{variant:"secondary",children:"Never"})}),e.jsx(R,{className:"text-right",children:e.jsx(b,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>c(g),children:e.jsx(Ve,{className:"h-4 w-4 text-destructive"})})})]},g.id))})]})})]})]})}),e.jsx(Q,{open:n,onOpenChange:i,children:e.jsxs(W,{children:[e.jsxs(Z,{children:[e.jsx(J,{children:"Create API Key"}),e.jsx(X,{children:"Create a new API key for programmatic access."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"api-key-name",children:"Name"}),e.jsx(L,{id:"api-key-name",placeholder:"My API Key",value:u,onChange:g=>f(g.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"key-expires",children:"Expires (optional)"}),e.jsx(L,{id:"key-expires",type:"datetime-local",value:d,onChange:g=>m(g.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{children:"Scopes"}),e.jsx("div",{className:"grid gap-2",children:ce.map(g=>{const P=`scope-${g.value.replace(/[^a-z0-9]/gi,"-")}`;return e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx(gt,{id:P,checked:p.includes(g.value),onCheckedChange:o=>le(g.value,!!o)}),e.jsxs("label",{htmlFor:P,className:"flex flex-col gap-1 cursor-pointer",children:[e.jsx("span",{className:"font-mono text-xs",children:g.label}),e.jsx("span",{className:"text-xs text-muted-foreground",children:g.description})]})]},g.value)})})]})]}),e.jsxs(xe,{children:[e.jsx(b,{variant:"outline",onClick:()=>i(!1),children:"Cancel"}),e.jsxs(b,{onClick:C,disabled:!u||p.length===0||z.isPending,children:[z.isPending&&e.jsx(te,{className:"mr-2 h-4 w-4 animate-spin"}),"Create"]})]})]})}),e.jsx(js,{open:!!l,onOpenChange:()=>c(null),children:e.jsxs(Qe,{children:[e.jsxs(We,{children:[e.jsx(Je,{children:"Delete API Key"}),e.jsxs(Xe,{children:['Are you sure you want to delete "',l==null?void 0:l.name,'"? This action cannot be undone.']})]}),e.jsxs(Ze,{children:[e.jsx(es,{children:"Cancel"}),e.jsxs(Ye,{onClick:()=>l&&N.mutate(l.id),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:[N.isPending&&e.jsx(te,{className:"mr-2 h-4 w-4 animate-spin"}),"Delete"]})]})]})})]})}function Nr({open:s,onOpenChange:t}){const a=ye(),[n,i]=r.useState(!1),[l,c]=r.useState(null),[u,f]=r.useState(null),[d,m]=r.useState(""),[p,j]=r.useState(""),[w,v]=r.useState("user"),{data:y,isLoading:S,refetch:k}=ie({queryKey:["users"],queryFn:ns.list,enabled:s}),x=Y({mutationFn:C=>ns.create(C),onSuccess:()=>{a.invalidateQueries({queryKey:["users"]}),K(),i(!1),A({title:"User created"})},onError:C=>{A({title:"Failed to create user",description:C instanceof Error?C.message:"Unknown error",variant:"destructive"})}}),_=Y({mutationFn:({id:C,data:se})=>ns.update(C,se),onSuccess:()=>{a.invalidateQueries({queryKey:["users"]}),K(),c(null),A({title:"User updated"})},onError:C=>{A({title:"Failed to update user",description:C instanceof Error?C.message:"Unknown error",variant:"destructive"})}}),O=Y({mutationFn:C=>ns.delete(C),onSuccess:()=>{a.invalidateQueries({queryKey:["users"]}),f(null),A({title:"User deleted"})},onError:C=>{A({title:"Failed to delete user",description:C instanceof Error?C.message:"Unknown error",variant:"destructive"})}}),K=()=>{m(""),j(""),v("user")};r.useEffect(()=>{l?(m(l.username),j(""),v(l.role)):K()},[l]);const z=()=>{x.mutate({username:d,password:p,role:w})},N=()=>{if(!l)return;const C={};d!==l.username&&(C.username=d),p&&(C.password=p),w!==l.role&&(C.role=w),_.mutate({id:l.id,data:C})},H=C=>C==="admin"?e.jsxs(D,{variant:"default",className:"gap-1",children:[e.jsx(Qa,{className:"h-3 w-3"}),"Admin"]}):e.jsxs(D,{variant:"secondary",className:"gap-1",children:[e.jsx(Js,{className:"h-3 w-3"}),"User"]});return e.jsxs(e.Fragment,{children:[e.jsx(Q,{open:s,onOpenChange:t,children:e.jsxs(W,{className:"max-w-2xl max-h-[80vh] overflow-hidden",children:[e.jsxs(Z,{children:[e.jsxs(J,{className:"flex items-center gap-2",children:[e.jsx(Es,{className:"h-5 w-5"}),"User Management"]}),e.jsx(X,{children:"Manage dashboard users and their permissions."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(b,{onClick:()=>i(!0),children:[e.jsx(Be,{className:"mr-2 h-4 w-4"}),"Add User"]}),e.jsx(b,{variant:"outline",size:"icon",onClick:()=>k(),children:e.jsx(we,{className:"h-4 w-4"})})]}),e.jsx(Ee,{className:"h-64 rounded-md border",children:S?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(te,{className:"h-6 w-6 animate-spin"})}):!y||y.length===0?e.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-2 text-muted-foreground",children:[e.jsx(Es,{className:"h-8 w-8"}),e.jsx("p",{children:"No users"})]}):e.jsxs(Pe,{children:[e.jsx(qe,{children:e.jsxs(ee,{children:[e.jsx(M,{children:"Username"}),e.jsx(M,{children:"Role"}),e.jsx(M,{children:"Created"}),e.jsx(M,{className:"text-right",children:"Actions"})]})}),e.jsx(Oe,{children:y.map(C=>e.jsxs(ee,{children:[e.jsx(R,{className:"font-medium",children:C.username}),e.jsx(R,{children:H(C.role)}),e.jsx(R,{className:"text-sm text-muted-foreground",children:me(C.created_at)}),e.jsx(R,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx(b,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>c(C),children:e.jsx(Wa,{className:"h-4 w-4"})}),e.jsx(b,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>f(C),children:e.jsx(Ve,{className:"h-4 w-4 text-destructive"})})]})})]},C.id))})]})})]})]})}),e.jsx(Q,{open:n,onOpenChange:i,children:e.jsxs(W,{children:[e.jsxs(Z,{children:[e.jsx(J,{children:"Create User"}),e.jsx(X,{children:"Add a new dashboard user."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"create-username",children:"Username"}),e.jsx(L,{id:"create-username",placeholder:"johndoe",value:d,onChange:C=>m(C.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"create-password",children:"Password"}),e.jsx(L,{id:"create-password",type:"password",placeholder:"••••••••",value:p,onChange:C=>j(C.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"create-role",children:"Role"}),e.jsxs(Me,{value:w,onValueChange:C=>v(C),children:[e.jsx(Te,{children:e.jsx(Ie,{})}),e.jsxs(Fe,{children:[e.jsx(q,{value:"user",children:"User"}),e.jsx(q,{value:"admin",children:"Admin"})]})]})]})]}),e.jsxs(xe,{children:[e.jsx(b,{variant:"outline",onClick:()=>i(!1),children:"Cancel"}),e.jsxs(b,{onClick:z,disabled:!d||!p||x.isPending,children:[x.isPending&&e.jsx(te,{className:"mr-2 h-4 w-4 animate-spin"}),"Create"]})]})]})}),e.jsx(Q,{open:!!l,onOpenChange:()=>c(null),children:e.jsxs(W,{children:[e.jsxs(Z,{children:[e.jsx(J,{children:"Edit User"}),e.jsxs(X,{children:['Update user "',l==null?void 0:l.username,'".']})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"edit-username",children:"Username"}),e.jsx(L,{id:"edit-username",value:d,onChange:C=>m(C.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"edit-password",children:"Password (leave blank to keep)"}),e.jsx(L,{id:"edit-password",type:"password",placeholder:"••••••••",value:p,onChange:C=>j(C.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"edit-role",children:"Role"}),e.jsxs(Me,{value:w,onValueChange:C=>v(C),children:[e.jsx(Te,{children:e.jsx(Ie,{})}),e.jsxs(Fe,{children:[e.jsx(q,{value:"user",children:"User"}),e.jsx(q,{value:"admin",children:"Admin"})]})]})]})]}),e.jsxs(xe,{children:[e.jsx(b,{variant:"outline",onClick:()=>c(null),children:"Cancel"}),e.jsxs(b,{onClick:N,disabled:!d||_.isPending,children:[_.isPending&&e.jsx(te,{className:"mr-2 h-4 w-4 animate-spin"}),"Update"]})]})]})}),e.jsx(js,{open:!!u,onOpenChange:()=>f(null),children:e.jsxs(Qe,{children:[e.jsxs(We,{children:[e.jsx(Je,{children:"Delete User"}),e.jsxs(Xe,{children:['Are you sure you want to delete "',u==null?void 0:u.username,'"? This action cannot be undone.']})]}),e.jsxs(Ze,{children:[e.jsx(es,{children:"Cancel"}),e.jsxs(Ye,{onClick:()=>u&&O.mutate(u.id),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:[O.isPending&&e.jsx(te,{className:"mr-2 h-4 w-4 animate-spin"}),"Delete"]})]})]})})]})}function br({open:s,onOpenChange:t}){const a=ye(),[n,i]=r.useState(!1),[l,c]=r.useState(72),[u,f]=r.useState(null),[d,m]=r.useState(null),[p,j]=r.useState(!1),{data:w,isLoading:v,refetch:y}=ie({queryKey:["invitations"],queryFn:Cs.list,enabled:s}),S=Y({mutationFn:N=>Cs.create(N),onSuccess:N=>{a.invalidateQueries({queryKey:["invitations"]}),m(N),A({title:"Invitation code created"})},onError:N=>{A({title:"Failed to create invitation code",description:N instanceof Error?N.message:"Unknown error",variant:"destructive"})}}),k=Y({mutationFn:N=>Cs.revoke(N),onSuccess:()=>{a.invalidateQueries({queryKey:["invitations"]}),f(null),A({title:"Invitation code revoked"})},onError:N=>{A({title:"Failed to revoke invitation code",description:N instanceof Error?N.message:"Unknown error",variant:"destructive"})}}),x=()=>{S.mutate(l)},_=async()=>{d!=null&&d.code&&(await navigator.clipboard.writeText(d.code),j(!0),setTimeout(()=>j(!1),2e3))},O=()=>{m(null),i(!1),j(!1)},K=N=>{switch(N){case"active":return e.jsxs(D,{variant:"default",className:"gap-1 bg-green-600",children:[e.jsx(He,{className:"h-3 w-3"}),"Active"]});case"used":return e.jsxs(D,{variant:"secondary",className:"gap-1",children:[e.jsx(hs,{className:"h-3 w-3"}),"Used"]});case"revoked":return e.jsxs(D,{variant:"destructive",className:"gap-1",children:[e.jsx(us,{className:"h-3 w-3"}),"Revoked"]});default:return e.jsx(D,{variant:"outline",children:N})}},z=N=>new Date(N)<new Date;return e.jsxs(e.Fragment,{children:[e.jsx(Q,{open:s,onOpenChange:t,children:e.jsxs(W,{className:"max-w-3xl max-h-[80vh] overflow-hidden",children:[e.jsxs(Z,{children:[e.jsxs(J,{className:"flex items-center gap-2",children:[e.jsx(Rs,{className:"h-5 w-5"}),"Invitation Codes"]}),e.jsx(X,{children:"Create and manage invitation codes for user registration."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(b,{onClick:()=>i(!0),children:[e.jsx(Be,{className:"mr-2 h-4 w-4"}),"Create Code"]}),e.jsx(b,{variant:"outline",size:"icon",onClick:()=>y(),children:e.jsx(we,{className:"h-4 w-4"})})]}),e.jsx(Ee,{className:"h-80 rounded-md border",children:v?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(te,{className:"h-6 w-6 animate-spin"})}):!w||w.length===0?e.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-2 text-muted-foreground",children:[e.jsx(Rs,{className:"h-8 w-8"}),e.jsx("p",{children:"No invitation codes"})]}):e.jsxs(Pe,{children:[e.jsx(qe,{children:e.jsxs(ee,{children:[e.jsx(M,{children:"ID"}),e.jsx(M,{children:"Status"}),e.jsx(M,{children:"Created"}),e.jsx(M,{children:"Expires"}),e.jsx(M,{children:"Used By"}),e.jsx(M,{className:"text-right",children:"Actions"})]})}),e.jsx(Oe,{children:w.map(N=>e.jsxs(ee,{children:[e.jsxs(R,{className:"font-mono text-xs",children:[N.id.slice(0,8),"..."]}),e.jsx(R,{children:N.status==="active"&&z(N.expires_at)?e.jsxs(D,{variant:"outline",className:"gap-1",children:[e.jsx(us,{className:"h-3 w-3"}),"Expired"]}):K(N.status)}),e.jsx(R,{className:"text-sm text-muted-foreground",children:me(N.created_at)}),e.jsx(R,{className:"text-sm text-muted-foreground",children:me(N.expires_at)}),e.jsx(R,{className:"font-mono text-xs text-muted-foreground",children:N.used_by?`${N.used_by.slice(0,8)}...`:"-"}),e.jsx(R,{className:"text-right",children:N.status==="active"&&!z(N.expires_at)&&e.jsx(b,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>f(N),children:e.jsx(Pa,{className:"h-4 w-4 text-destructive"})})})]},N.id))})]})})]})]})}),e.jsx(Q,{open:n&&!d,onOpenChange:N=>!N&&i(!1),children:e.jsxs(W,{children:[e.jsxs(Z,{children:[e.jsx(J,{children:"Create Invitation Code"}),e.jsx(X,{children:"Generate a new invitation code for user registration."})]}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"expires-in",children:"Expires In"}),e.jsxs(Me,{value:String(l),onValueChange:N=>c(Number(N)),children:[e.jsx(Te,{children:e.jsx(Ie,{})}),e.jsxs(Fe,{children:[e.jsx(q,{value:"24",children:"24 hours (1 day)"}),e.jsx(q,{value:"48",children:"48 hours (2 days)"}),e.jsx(q,{value:"72",children:"72 hours (3 days)"}),e.jsx(q,{value:"168",children:"168 hours (1 week)"}),e.jsx(q,{value:"720",children:"720 hours (30 days)"})]})]})]})}),e.jsxs(xe,{children:[e.jsx(b,{variant:"outline",onClick:()=>i(!1),children:"Cancel"}),e.jsxs(b,{onClick:x,disabled:S.isPending,children:[S.isPending&&e.jsx(te,{className:"mr-2 h-4 w-4 animate-spin"}),"Create"]})]})]})}),e.jsx(Q,{open:!!d,onOpenChange:O,children:e.jsxs(W,{children:[e.jsxs(Z,{children:[e.jsxs(J,{className:"flex items-center gap-2 text-green-600",children:[e.jsx(hs,{className:"h-5 w-5"}),"Invitation Code Created"]}),e.jsx(X,{children:"Copy this code and share it with the user. This code will only be shown once."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{children:"Invitation Code"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("code",{className:"flex-1 rounded-md bg-muted px-4 py-3 font-mono text-sm break-all",children:d==null?void 0:d.code}),e.jsx(b,{variant:"outline",size:"icon",onClick:_,className:"shrink-0",children:p?e.jsx(De,{className:"h-4 w-4 text-green-600"}):e.jsx($e,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:e.jsxs("p",{children:["Expires: ",d&&new Date(d.expires_at).toLocaleString()]})})]}),e.jsx(xe,{children:e.jsx(b,{onClick:O,children:"Done"})})]})}),e.jsx(js,{open:!!u,onOpenChange:()=>f(null),children:e.jsxs(Qe,{children:[e.jsxs(We,{children:[e.jsx(Je,{children:"Revoke Invitation Code"}),e.jsx(Xe,{children:"Are you sure you want to revoke this invitation code? It will no longer be usable for registration."})]}),e.jsxs(Ze,{children:[e.jsx(es,{children:"Cancel"}),e.jsxs(Ye,{onClick:()=>u&&k.mutate(u.id),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:[k.isPending&&e.jsx(te,{className:"mr-2 h-4 w-4 animate-spin"}),"Revoke"]})]})]})})]})}function wr({user:s,isConnected:t=!0,lastRefreshed:a,fetchTimeMs:n}){const{logout:i}=Ts(),{theme:l,toggleTheme:c}=er(),[u,f]=r.useState(!1),[d,m]=r.useState(!1),[p,j]=r.useState(!1),[w,v]=r.useState(!1),y=()=>{v(!0),window.location.reload()},S=()=>{window.open("/dashboard/playground.html","_blank")};return e.jsxs(e.Fragment,{children:[e.jsx("header",{className:"sticky top-0 z-40 border-b border-border/50 bg-background/80 backdrop-blur-xl",children:e.jsxs("div",{className:"mx-auto flex h-16 max-w-[1600px] items-center justify-between px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-lg bg-primary/10 glow-sm",children:e.jsx(Xs,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-display text-lg font-semibold tracking-tight",children:"LLM Load Balancer"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Dashboard"})]})]}),e.jsxs("div",{className:"hidden md:flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{id:"connection-status",className:"flex items-center gap-1.5",children:[e.jsx("span",{className:`h-2 w-2 rounded-full ${t?"bg-green-500":"bg-red-500"}`}),"Connection: ",t?"Online":"Offline"]}),a&&e.jsxs("span",{id:"last-refreshed",children:["Last updated: ",a.toLocaleTimeString()]}),!a&&e.jsx("span",{id:"last-refreshed",children:"Last updated: --:--:--"}),n!=null&&e.jsxs("span",{id:"refresh-metrics",children:["Fetch time: ",n,"ms"]}),n==null&&e.jsx("span",{id:"refresh-metrics",children:"Fetch time: --ms"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(b,{id:"chat-open",variant:"outline",size:"sm",onClick:S,className:"hidden sm:inline-flex",children:[e.jsx(ds,{className:"mr-2 h-4 w-4"}),"Playground"]}),e.jsxs(b,{id:"api-keys-button",variant:"outline",size:"sm",onClick:()=>f(!0),className:"hidden sm:inline-flex",children:[e.jsx(ms,{className:"mr-2 h-4 w-4"}),"API Keys"]}),e.jsx(b,{id:"refresh-button",variant:"ghost",size:"icon",onClick:y,disabled:w,children:e.jsx(we,{className:`h-4 w-4 ${w?"animate-spin":""}`})}),e.jsx(b,{id:"theme-toggle",variant:"ghost",size:"icon",onClick:c,children:l==="dark"?e.jsx(ga,{className:"h-4 w-4"}):e.jsx(fa,{className:"h-4 w-4"})}),e.jsxs(va,{children:[e.jsx(ya,{asChild:!0,children:e.jsx(b,{variant:"ghost",size:"icon",className:"relative",children:e.jsx(Js,{className:"h-4 w-4"})})}),e.jsxs(Na,{align:"end",className:"w-56",children:[e.jsx(ba,{children:e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:s==null?void 0:s.username}),e.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:s==null?void 0:s.role})]})}),e.jsx(Ss,{}),e.jsxs(Ke,{onClick:S,className:"sm:hidden",children:[e.jsx(ds,{className:"mr-2 h-4 w-4"}),"Playground"]}),e.jsxs(Ke,{onClick:()=>f(!0),className:"sm:hidden",children:[e.jsx(ms,{className:"mr-2 h-4 w-4"}),"API Keys"]}),e.jsx(Ss,{className:"sm:hidden"}),(s==null?void 0:s.role)==="admin"&&e.jsxs(e.Fragment,{children:[e.jsxs(Ke,{onClick:()=>m(!0),children:[e.jsx(Es,{className:"mr-2 h-4 w-4"}),"Manage Users"]}),e.jsxs(Ke,{onClick:()=>j(!0),children:[e.jsx(Rs,{className:"mr-2 h-4 w-4"}),"Invitation Codes"]}),e.jsx(Ss,{})]}),e.jsxs(Ke,{onClick:i,className:"text-destructive",children:[e.jsx(Ba,{className:"mr-2 h-4 w-4"}),"Sign out"]})]})]})]})]})}),e.jsx(yr,{open:u,onOpenChange:f}),e.jsx(Nr,{open:d,onOpenChange:m}),e.jsx(br,{open:p,onOpenChange:j})]})}const $s={primary:"bg-primary/10 group-hover:bg-primary/20","chart-1":"bg-chart-1/10 group-hover:bg-chart-1/20","chart-2":"bg-chart-2/10 group-hover:bg-chart-2/20","chart-3":"bg-chart-3/10 group-hover:bg-chart-3/20","chart-4":"bg-chart-4/10 group-hover:bg-chart-4/20","chart-5":"bg-chart-5/10 group-hover:bg-chart-5/20",success:"bg-success/10 group-hover:bg-success/20",warning:"bg-warning/10 group-hover:bg-warning/20",destructive:"bg-destructive/10 group-hover:bg-destructive/20"};function Cr({title:s,value:t,subtitle:a,icon:n,accentColor:i="primary",isLoading:l,delay:c=0,dataStat:u}){return e.jsx(re,{className:"stat-card group overflow-hidden animate-fade-up",style:{animationDelay:`${c}ms`},"data-stat":u,children:e.jsx(ne,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:s}),l?e.jsx("div",{className:"h-8 w-24 shimmer rounded"}):e.jsx("p",{className:"text-3xl font-bold tracking-tight",children:t}),a&&!l&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a})]}),e.jsx("div",{className:`flex h-10 w-10 items-center justify-center rounded-lg transition-colors ${$s[i]||$s.primary}`,children:n})]})})})}function kr({stats:s,isLoading:t}){const a=[{title:"Total Nodes",value:s?U(s.total_nodes):"—",subtitle:s?`${s.online_nodes} online, ${s.pending_nodes} pending, ${s.registering_nodes} registering, ${s.offline_nodes} offline`:void 0,icon:e.jsx(Ge,{className:"h-5 w-5 text-primary"}),accentColor:"primary",dataStat:"total-nodes"},{title:"Total Requests",value:s?U(s.total_requests):"—",subtitle:s?`${U(s.successful_requests)} successful`:void 0,icon:e.jsx(Fa,{className:"h-5 w-5 text-chart-2"}),accentColor:"chart-2",dataStat:"total-requests"},{title:"Total Tokens",value:s?U(s.total_tokens):"—",subtitle:s?`In: ${U(s.total_input_tokens)} / Out: ${U(s.total_output_tokens)}`:void 0,icon:e.jsx(ds,{className:"h-5 w-5 text-chart-5"}),accentColor:"chart-5",dataStat:"total-tokens"},{title:"Active Requests",value:s?U(s.total_active_requests):"—",icon:e.jsx(Xs,{className:"h-5 w-5 text-chart-1"}),accentColor:"chart-1",dataStat:"active-requests"},{title:"Queued Requests",value:s?U(s.queued_requests):"—",icon:e.jsx(Ha,{className:"h-5 w-5 text-chart-5"}),accentColor:"chart-5",dataStat:"queued-requests"},{title:"Success Rate",value:s&&s.total_requests>0?ks(s.successful_requests/s.total_requests*100):"—",subtitle:s?`${U(s.failed_requests)} failed`:void 0,icon:s&&s.failed_requests>0?e.jsx(us,{className:"h-5 w-5 text-destructive"}):e.jsx(hs,{className:"h-5 w-5 text-success"}),accentColor:s&&s.failed_requests>0?"destructive":"success",dataStat:"success-rate"},{title:"Avg Response Time",value:s?As(s.average_response_time_ms):"—",icon:e.jsx(He,{className:"h-5 w-5 text-warning"}),accentColor:"warning",dataStat:"average-response-time-ms"},{title:"Avg GPU Usage",value:s?ks(s.average_gpu_usage):"—",icon:e.jsx(Ja,{className:"h-5 w-5 text-chart-3"}),accentColor:"chart-3",dataStat:"average-gpu-usage"},{title:"Avg GPU Memory",value:s?ks(s.average_gpu_memory_usage):"—",icon:e.jsx($a,{className:"h-5 w-5 text-chart-4"}),accentColor:"chart-4",dataStat:"average-gpu-memory-usage"}];return e.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6",children:a.map((n,i)=>e.jsx(Cr,{...n,isLoading:t,delay:i*50},n.title))})}function Sr(s){switch(s){case"online":return"default";case"pending":return"secondary";case"offline":return"outline";case"error":return"destructive";default:return"outline"}}function _r(s){switch(s){case"online":return"Online";case"pending":return"Pending";case"offline":return"Offline";case"error":return"Error";default:return s}}function Ar({endpoint:s,open:t,onOpenChange:a}){var S,k;const n=ye(),[i,l]=r.useState((s==null?void 0:s.name)||""),[c,u]=r.useState((s==null?void 0:s.notes)||""),[f,d]=r.useState(((S=s==null?void 0:s.health_check_interval_secs)==null?void 0:S.toString())||"30"),[m,p]=r.useState(((k=s==null?void 0:s.inference_timeout_secs)==null?void 0:k.toString())||"120"),j=Y({mutationFn:x=>Ne.update(s.id,x),onSuccess:()=>{n.invalidateQueries({queryKey:["dashboard-endpoints"]}),A({title:"Update Complete",description:"Endpoint settings updated"})},onError:x=>{A({title:"Update Failed",description:String(x),variant:"destructive"})}}),w=Y({mutationFn:()=>Ne.test(s.id),onSuccess:x=>{n.invalidateQueries({queryKey:["dashboard-endpoints"]}),A({title:x.success?"Connection Successful":"Connection Failed",description:x.message||(x.latency_ms?`Latency: ${x.latency_ms}ms`:""),variant:x.success?"default":"destructive"})},onError:x=>{A({title:"Connection Test Failed",description:String(x),variant:"destructive"})}}),v=Y({mutationFn:()=>Ne.sync(s.id),onSuccess:x=>{n.invalidateQueries({queryKey:["dashboard-endpoints"]}),A({title:"Sync Complete",description:`Synced ${x.synced_models} models`})},onError:x=>{A({title:"Sync Failed",description:String(x),variant:"destructive"})}}),y=()=>{j.mutate({name:i!==(s==null?void 0:s.name)?i:void 0,notes:c!==(s==null?void 0:s.notes)?c:void 0,health_check_interval_secs:parseInt(f)!==(s==null?void 0:s.health_check_interval_secs)?parseInt(f):void 0,inference_timeout_secs:parseInt(m)!==(s==null?void 0:s.inference_timeout_secs)?parseInt(m):void 0})};return s?e.jsx(Q,{open:t,onOpenChange:a,children:e.jsxs(W,{className:"max-w-2xl",children:[e.jsxs(Z,{children:[e.jsxs(J,{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"h-5 w-5"}),s.name]}),e.jsx(X,{children:s.base_url})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(D,{variant:Sr(s.status),children:_r(s.status)}),s.supports_responses_api&&e.jsx(D,{variant:"outline",children:"Responses API"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Models: ",s.model_count]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>w.mutate(),disabled:w.isPending,children:[e.jsx(ct,{className:"h-4 w-4 mr-1"}),"Test Connection"]}),e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>v.mutate(),disabled:v.isPending||s.status!=="online",children:[e.jsx(we,{className:`h-4 w-4 mr-1 ${v.isPending?"animate-spin":""}`}),"Sync Models"]})]})]}),e.jsx(zs,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Latency:"}),e.jsx("span",{className:"ml-2",children:s.latency_ms!=null?`${s.latency_ms}ms`:"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Registered:"}),e.jsx("span",{className:"ml-2",children:me(s.registered_at)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Last Seen:"}),e.jsx("span",{className:"ml-2",children:s.last_seen?me(s.last_seen):"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Error Count:"}),e.jsx("span",{className:"ml-2",children:s.error_count})]})]}),s.last_error&&e.jsxs("div",{className:"bg-destructive/10 border border-destructive/20 rounded-md p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-destructive",children:[e.jsx(it,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Last Error"})]}),e.jsx("p",{className:"text-sm text-destructive/80 mt-1",children:s.last_error})]}),e.jsx(zs,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"name",children:"Display Name"}),e.jsx(L,{id:"name",value:i,onChange:x=>l(x.target.value),placeholder:"Endpoint name"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(F,{htmlFor:"healthCheckInterval",children:[e.jsx(He,{className:"h-4 w-4 inline mr-1"}),"Health Check Interval (sec)"]}),e.jsx(L,{id:"healthCheckInterval",type:"number",min:"5",max:"3600",value:f,onChange:x=>d(x.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(F,{htmlFor:"inferenceTimeout",children:[e.jsx(He,{className:"h-4 w-4 inline mr-1"}),"Inference Timeout (sec)"]}),e.jsx(L,{id:"inferenceTimeout",type:"number",min:"10",max:"600",value:m,onChange:x=>p(x.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"notes",children:"Notes"}),e.jsx(wa,{id:"notes",value:c,onChange:x=>u(x.target.value),placeholder:"Notes about this endpoint...",rows:3})]})]})]}),e.jsxs(xe,{children:[e.jsx(b,{variant:"outline",onClick:()=>a(!1),children:"Close"}),e.jsxs(b,{onClick:y,disabled:j.isPending,children:[e.jsx(Va,{className:"h-4 w-4 mr-1"}),j.isPending?"Saving...":"Save"]})]})]})}):null}const Ue=10;function Rr(s){switch(s){case"online":return"default";case"pending":return"secondary";case"offline":return"outline";case"error":return"destructive";default:return"outline"}}function Dr(s){switch(s){case"online":return"Online";case"pending":return"Pending";case"offline":return"Offline";case"error":return"Error";default:return s}}function Er({endpoints:s,isLoading:t}){const a=ye(),[n,i]=r.useState(""),[l,c]=r.useState("all"),[u,f]=r.useState("status"),[d,m]=r.useState("desc"),[p,j]=r.useState(1),[w,v]=r.useState(null),[y,S]=r.useState(null),[k,x]=r.useState(!1),[_,O]=r.useState(null),[K,z]=r.useState(null),[N,H]=r.useState(!1),[C,se]=r.useState(!1),[le,ce]=r.useState(null),[g,P]=r.useState({name:"",base_url:"",api_key:"",notes:""}),o=async()=>{if(!(!g.name||!g.base_url)){se(!0),ce(null);try{await Ne.create({name:g.name,base_url:g.base_url,api_key:g.api_key||void 0,notes:g.notes||void 0}),await a.invalidateQueries({queryKey:["dashboard-endpoints"]}),H(!1),P({name:"",base_url:"",api_key:"",notes:""})}catch(h){console.error("Failed to create endpoint:",h),ce(h instanceof Error?h.message:"Failed to create endpoint")}finally{se(!1)}}},$=async()=>{if(y){x(!0);try{await Ne.delete(y.id),await a.invalidateQueries({queryKey:["dashboard-endpoints"]})}catch(h){console.error("Failed to delete endpoint:",h)}finally{x(!1),S(null)}}},qs=async h=>{O(h.id);try{await Ne.test(h.id),await a.invalidateQueries({queryKey:["dashboard-endpoints"]})}catch(ae){console.error("Failed to test endpoint:",ae)}finally{O(null)}},vs=async h=>{z(h.id);try{await Ne.sync(h.id),await a.invalidateQueries({queryKey:["dashboard-endpoints"]})}catch(ae){console.error("Failed to sync endpoint:",ae)}finally{z(null)}},ys=r.useMemo(()=>s.filter(h=>{const ae=h.name.toLowerCase().includes(n.toLowerCase())||h.base_url.toLowerCase().includes(n.toLowerCase()),oe=l==="all"||h.status===l;return ae&&oe}),[s,n,l]),Le=r.useMemo(()=>[...ys].sort((h,ae)=>{let oe=0;switch(u){case"name":oe=h.name.localeCompare(ae.name);break;case"status":{const Ls={online:0,pending:1,offline:2,error:3};oe=Ls[h.status]-Ls[ae.status];break}case"latency_ms":oe=(h.latency_ms??1/0)-(ae.latency_ms??1/0);break;case"model_count":oe=h.model_count-ae.model_count;break;case"registered_at":oe=new Date(h.registered_at).getTime()-new Date(ae.registered_at).getTime();break}return d==="asc"?oe:-oe}),[ys,u,d]),Os=r.useMemo(()=>{const h=(p-1)*Ue;return Le.slice(h,h+Ue)},[Le,p]),ts=Math.ceil(Le.length/Ue),as=h=>{u===h?m(d==="asc"?"desc":"asc"):(f(h),m("desc"))},rs=({field:h})=>u!==h?null:d==="asc"?e.jsx(Ca,{className:"ml-1 h-4 w-4 inline"}):e.jsx(ka,{className:"ml-1 h-4 w-4 inline"});return t&&s.length===0?e.jsxs(re,{children:[e.jsx(fe,{children:e.jsxs(ve,{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"h-5 w-5"}),"Endpoints"]})}),e.jsx(ne,{children:e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(re,{children:[e.jsx(fe,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(ve,{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"h-5 w-5"}),"Endpoints",e.jsx(D,{variant:"secondary",className:"ml-2",children:ys.length})]}),e.jsxs(b,{onClick:()=>H(!0),children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),"Add Endpoint"]})]})}),e.jsxs(ne,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ot,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(L,{placeholder:"Search by name or URL...",value:n,onChange:h=>{i(h.target.value),j(1)},className:"pl-10"})]}),e.jsxs(Me,{value:l,onValueChange:h=>{c(h),j(1)},children:[e.jsx(Te,{className:"w-[180px]",children:e.jsx(Ie,{placeholder:"Status"})}),e.jsxs(Fe,{children:[e.jsx(q,{value:"all",children:"All"}),e.jsx(q,{value:"online",children:"Online"}),e.jsx(q,{value:"pending",children:"Pending"}),e.jsx(q,{value:"offline",children:"Offline"}),e.jsx(q,{value:"error",children:"Error"})]})]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(Pe,{children:[e.jsx(qe,{children:e.jsxs(ee,{children:[e.jsxs(M,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>as("name"),children:["Name",e.jsx(rs,{field:"name"})]}),e.jsx(M,{children:"URL"}),e.jsxs(M,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>as("status"),children:["Status",e.jsx(rs,{field:"status"})]}),e.jsxs(M,{className:"cursor-pointer hover:bg-muted/50 text-right",onClick:()=>as("latency_ms"),children:["Latency",e.jsx(rs,{field:"latency_ms"})]}),e.jsxs(M,{className:"cursor-pointer hover:bg-muted/50 text-right",onClick:()=>as("model_count"),children:["Models",e.jsx(rs,{field:"model_count"})]}),e.jsx(M,{children:"Last Seen"}),e.jsx(M,{className:"text-right",children:"Actions"})]})}),e.jsx(Oe,{children:Os.length===0?e.jsx(ee,{children:e.jsx(R,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:n||l!=="all"?"No endpoints match the filter criteria":"No endpoints registered"})}):Os.map(h=>e.jsxs(ee,{children:[e.jsx(R,{className:"font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:h.name}),h.supports_responses_api&&e.jsx(D,{variant:"outline",className:"text-xs",children:"Responses API"})]})}),e.jsx(R,{children:e.jsx("span",{className:"text-muted-foreground font-mono text-sm",children:h.base_url})}),e.jsxs(R,{children:[e.jsx(D,{variant:Rr(h.status),children:Dr(h.status)}),h.last_error&&e.jsxs("span",{className:"ml-2 text-xs text-destructive",children:["(",h.error_count," errors)"]})]}),e.jsx(R,{className:"text-right",children:h.latency_ms!=null?`${h.latency_ms}ms`:"-"}),e.jsx(R,{className:"text-right",children:h.model_count}),e.jsx(R,{children:h.last_seen?me(h.last_seen):"-"}),e.jsx(R,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(b,{variant:"ghost",size:"icon",onClick:()=>v(h),title:"Details",children:e.jsx(Ga,{className:"h-4 w-4"})}),e.jsx(b,{variant:"ghost",size:"icon",onClick:()=>qs(h),disabled:_===h.id,title:"Test Connection",children:e.jsx(ct,{className:T("h-4 w-4",_===h.id&&"animate-pulse")})}),e.jsx(b,{variant:"ghost",size:"icon",onClick:()=>vs(h),disabled:K===h.id||h.status!=="online",title:"Sync Models",children:e.jsx(we,{className:T("h-4 w-4",K===h.id&&"animate-spin")})}),e.jsx(b,{variant:"ghost",size:"icon",onClick:()=>S(h),title:"Delete",children:e.jsx(Ve,{className:"h-4 w-4 text-destructive"})})]})})]},h.id))})]})}),ts>1&&e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",(p-1)*Ue+1," -"," ",Math.min(p*Ue,Le.length)," of ",Le.length]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{variant:"outline",size:"sm",onClick:()=>j(h=>Math.max(1,h-1)),disabled:p===1,children:e.jsx(nt,{className:"h-4 w-4"})}),e.jsxs("span",{className:"text-sm",children:[p," / ",ts]}),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>j(h=>Math.min(ts,h+1)),disabled:p===ts,children:e.jsx(tt,{className:"h-4 w-4"})})]})]})]})]}),w&&e.jsx(Ar,{endpoint:w,open:!!w,onOpenChange:h=>!h&&v(null)}),e.jsx(js,{open:!!y,onOpenChange:h=>!h&&S(null),children:e.jsxs(Qe,{children:[e.jsxs(We,{children:[e.jsx(Je,{children:"Delete Endpoint?"}),e.jsxs(Xe,{children:['This will delete "',y==null?void 0:y.name,'". This action cannot be undone. Models associated with this endpoint will no longer be available.']})]}),e.jsxs(Ze,{children:[e.jsx(es,{disabled:k,children:"Cancel"}),e.jsx(Ye,{onClick:$,disabled:k,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:k?"Deleting...":"Delete"})]})]})}),e.jsx(Q,{open:N,onOpenChange:h=>{h||(ce(null),P({name:"",base_url:"",api_key:"",notes:""})),H(h)},children:e.jsxs(W,{className:"sm:max-w-[500px]",children:[e.jsxs(Z,{children:[e.jsx(J,{children:"Add New Endpoint"}),e.jsx(X,{children:"Register a new inference service endpoint (Ollama, vLLM, etc.)"})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(F,{htmlFor:"endpoint-name",children:"Name *"}),e.jsx(L,{id:"endpoint-name",placeholder:"e.g., Production Ollama",value:g.name,onChange:h=>P({...g,name:h.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(F,{htmlFor:"endpoint-url",children:"Base URL *"}),e.jsx(L,{id:"endpoint-url",placeholder:"e.g., http://localhost:11434",value:g.base_url,onChange:h=>P({...g,base_url:h.target.value})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"The base URL of the OpenAI-compatible API endpoint"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(F,{htmlFor:"endpoint-api-key",children:"API Key (optional)"}),e.jsx(L,{id:"endpoint-api-key",type:"password",placeholder:"sk-...",value:g.api_key,onChange:h=>P({...g,api_key:h.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(F,{htmlFor:"endpoint-notes",children:"Notes (optional)"}),e.jsx(L,{id:"endpoint-notes",placeholder:"Description or notes about this endpoint",value:g.notes,onChange:h=>P({...g,notes:h.target.value})})]}),le&&e.jsx("p",{className:"text-sm text-destructive",children:le})]}),e.jsxs(xe,{children:[e.jsx(b,{variant:"outline",onClick:()=>H(!1),disabled:C,children:"Cancel"}),e.jsx(b,{onClick:o,disabled:C||!g.name||!g.base_url,children:C?"Creating...":"Create Endpoint"})]})]})})]})}var gs="Tabs",[Mr]=Ms(gs,[at]),qt=at(),[Tr,Ps]=Mr(gs),Ot=r.forwardRef((s,t)=>{const{__scopeTabs:a,value:n,onValueChange:i,defaultValue:l,orientation:c="horizontal",dir:u,activationMode:f="automatic",...d}=s,m=Aa(u),[p,j]=Ws({prop:n,onChange:i,defaultProp:l??"",caller:gs});return e.jsx(Tr,{scope:a,baseId:Ra(),value:p,onValueChange:j,orientation:c,dir:m,activationMode:f,children:e.jsx(be.div,{dir:m,"data-orientation":c,...d,ref:t})})});Ot.displayName=gs;var Lt="TabsList",Kt=r.forwardRef((s,t)=>{const{__scopeTabs:a,loop:n=!0,...i}=s,l=Ps(Lt,a),c=qt(a);return e.jsx(Sa,{asChild:!0,...c,orientation:l.orientation,dir:l.dir,loop:n,children:e.jsx(be.div,{role:"tablist","aria-orientation":l.orientation,...i,ref:t})})});Kt.displayName=Lt;var Ut="TabsTrigger",zt=r.forwardRef((s,t)=>{const{__scopeTabs:a,value:n,disabled:i=!1,...l}=s,c=Ps(Ut,a),u=qt(a),f=Gt(c.baseId,n),d=Bt(c.baseId,n),m=n===c.value;return e.jsx(_a,{asChild:!0,...u,focusable:!i,active:m,children:e.jsx(be.button,{type:"button",role:"tab","aria-selected":m,"aria-controls":d,"data-state":m?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:f,...l,ref:t,onMouseDown:_e(s.onMouseDown,p=>{!i&&p.button===0&&p.ctrlKey===!1?c.onValueChange(n):p.preventDefault()}),onKeyDown:_e(s.onKeyDown,p=>{[" ","Enter"].includes(p.key)&&c.onValueChange(n)}),onFocus:_e(s.onFocus,()=>{const p=c.activationMode!=="manual";!m&&!i&&p&&c.onValueChange(n)})})})});zt.displayName=Ut;var $t="TabsContent",Ht=r.forwardRef((s,t)=>{const{__scopeTabs:a,value:n,forceMount:i,children:l,...c}=s,u=Ps($t,a),f=Gt(u.baseId,n),d=Bt(u.baseId,n),m=n===u.value,p=r.useRef(m);return r.useEffect(()=>{const j=requestAnimationFrame(()=>p.current=!1);return()=>cancelAnimationFrame(j)},[]),e.jsx(Qs,{present:i||m,children:({present:j})=>e.jsx(be.div,{"data-state":m?"active":"inactive","data-orientation":u.orientation,role:"tabpanel","aria-labelledby":f,hidden:!j,id:d,tabIndex:0,...c,ref:t,style:{...s.style,animationDuration:p.current?"0s":void 0},children:j&&l})})});Ht.displayName=$t;function Gt(s,t){return`${s}-trigger-${t}`}function Bt(s,t){return`${s}-content-${t}`}var Ir=Ot,Vt=Kt,Qt=zt,Wt=Ht;const fs=Ir,ss=r.forwardRef(({className:s,...t},a)=>e.jsx(Vt,{ref:a,className:T("inline-flex h-10 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",s),...t}));ss.displayName=Vt.displayName;const G=r.forwardRef(({className:s,...t},a)=>e.jsx(Qt,{ref:a,className:T("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...t}));G.displayName=Qt.displayName;const B=r.forwardRef(({className:s,...t},a)=>e.jsx(Wt,{ref:a,className:T("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...t}));B.displayName=Wt.displayName;const Fr=[25,50,100];function Pr({history:s,isLoading:t}){var w;const[a,n]=r.useState(25),[i,l]=r.useState(1),[c,u]=r.useState(null),[f,d]=r.useState(null),m=Math.ceil(s.length/a),p=s.slice((i-1)*a,i*a),j=async(v,y)=>{try{await navigator.clipboard.writeText(v),d(y),setTimeout(()=>d(null),2e3),A({title:"Copied to clipboard"})}catch{A({title:"Failed to copy",variant:"destructive"})}};return t?e.jsxs(re,{children:[e.jsx(fe,{children:e.jsxs(ve,{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"h-5 w-5"}),"Request History"]})}),e.jsx(ne,{children:e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((v,y)=>e.jsx("div",{className:"h-12 shimmer rounded"},y))})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(re,{children:[e.jsx(fe,{className:"pb-4",children:e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs(ve,{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"h-5 w-5"}),"Request History",e.jsx(D,{variant:"secondary",className:"ml-2",children:s.length})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Show"}),e.jsxs(Me,{value:a.toString(),onValueChange:v=>{n(Number(v)),l(1)},children:[e.jsx(Te,{id:"history-per-page",className:"w-20",children:e.jsx(Ie,{})}),e.jsx(Fe,{children:Fr.map(v=>e.jsx(q,{value:v.toString(),children:v},v))})]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"entries"})]})]})}),e.jsxs(ne,{className:"px-0",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Pe,{children:[e.jsx(qe,{children:e.jsxs(ee,{children:[e.jsx(M,{children:"Time"}),e.jsx(M,{children:"Model"}),e.jsx(M,{children:"Node"}),e.jsx(M,{children:"Status"}),e.jsx(M,{children:"Duration"}),e.jsx(M,{children:"Tokens"})]})}),e.jsx(Oe,{id:"request-history-tbody",children:p.length===0?e.jsx(ee,{children:e.jsx(R,{colSpan:6,className:"h-32 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2 text-muted-foreground",children:[e.jsx(ze,{className:"h-8 w-8"}),e.jsx("p",{children:"No request history"})]})})}):p.map(v=>{var y,S;return e.jsxs(ee,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>u(v),children:[e.jsx(R,{className:"font-mono text-xs",children:me(v.timestamp)}),e.jsx(R,{children:e.jsx(D,{variant:"secondary",children:v.model})}),e.jsx(R,{className:"text-sm",children:v.node_name||((y=v.node_id)==null?void 0:y.slice(0,8))||"—"}),e.jsx(R,{children:e.jsxs(D,{variant:v.status==="success"?"online":"destructive",className:"gap-1",children:[v.status==="success"?e.jsx(hs,{className:"h-3 w-3"}):e.jsx(us,{className:"h-3 w-3"}),v.status]})}),e.jsx(R,{children:e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(He,{className:"h-3 w-3 text-muted-foreground"}),As(v.duration_ms)]})}),e.jsx(R,{className:"text-sm",children:((S=v.total_tokens)==null?void 0:S.toLocaleString())||"—"})]},v.request_id)})})]})}),m>1&&e.jsxs("div",{className:"flex items-center justify-between border-t px-6 py-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",(i-1)*a+1," to"," ",Math.min(i*a,s.length)," of ",s.length]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{id:"history-page-prev",variant:"outline",size:"sm",onClick:()=>l(v=>Math.max(1,v-1)),disabled:i===1,children:e.jsx(nt,{className:"h-4 w-4"})}),e.jsxs("span",{id:"history-page-info",className:"text-sm",children:["Page ",i," of ",m]}),e.jsx(b,{id:"history-page-next",variant:"outline",size:"sm",onClick:()=>l(v=>Math.min(m,v+1)),disabled:i===m,children:e.jsx(tt,{className:"h-4 w-4"})})]})]})]})]}),e.jsx(Q,{open:!!c,onOpenChange:()=>u(null),children:e.jsxs(W,{id:"request-modal",className:"max-w-2xl max-h-[80vh] overflow-hidden",children:[e.jsxs(Z,{children:[e.jsxs(J,{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"h-5 w-5"}),"Request Details"]}),e.jsxs(X,{children:["Request ID: ",e.jsx("code",{className:"text-xs",children:c==null?void 0:c.request_id})]})]}),c&&e.jsxs(fs,{defaultValue:"overview",className:"mt-4",children:[e.jsxs(ss,{className:"grid w-full grid-cols-3",children:[e.jsx(G,{value:"overview",children:"Overview"}),e.jsx(G,{value:"request",children:"Request"}),e.jsx(G,{value:"response",children:"Response"})]}),e.jsxs(B,{value:"overview",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Model"}),e.jsx(D,{variant:"secondary",children:c.model})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Status"}),e.jsx(D,{variant:c.status==="success"?"online":"destructive",children:c.status})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Node"}),e.jsx("p",{className:"text-sm",children:c.node_name||c.node_id||"—"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Duration"}),e.jsx("p",{className:"text-sm",children:As(c.duration_ms)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Timestamp"}),e.jsx("p",{className:"text-sm",children:new Date(c.timestamp).toLocaleString()})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Tokens"}),e.jsx("p",{className:"text-sm",children:((w=c.total_tokens)==null?void 0:w.toLocaleString())||"—"})]})]}),c.error&&e.jsxs("div",{className:"rounded-lg border border-destructive/50 bg-destructive/10 p-4",children:[e.jsx("p",{className:"text-sm font-medium text-destructive",children:"Error"}),e.jsx("p",{className:"mt-1 text-sm",children:c.error})]})]}),e.jsx(B,{value:"request",className:"mt-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(b,{variant:"ghost",size:"sm",className:"absolute right-2 top-2",onClick:()=>j(JSON.stringify(c.request_body,null,2),"request"),children:f==="request"?e.jsx(De,{className:"h-4 w-4"}):e.jsx($e,{className:"h-4 w-4"})}),e.jsx(Ee,{className:"h-64 rounded-md border",children:e.jsx("pre",{className:"p-4 text-xs",children:JSON.stringify(c.request_body,null,2)||"No request body"})})]})}),e.jsx(B,{value:"response",className:"mt-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(b,{variant:"ghost",size:"sm",className:"absolute right-2 top-2",onClick:()=>j(JSON.stringify(c.response_body,null,2),"response"),children:f==="response"?e.jsx(De,{className:"h-4 w-4"}):e.jsx($e,{className:"h-4 w-4"})}),e.jsx(Ee,{className:"h-64 rounded-md border",children:e.jsx("pre",{className:"p-4 text-xs",children:JSON.stringify(c.response_body,null,2)||"No response body"})})]})})]})]})})]})}function qr({nodes:s}){const[t,a]=r.useState("all"),[n,i]=r.useState(!0),l=r.useRef(null),{data:c,refetch:u,isRefetching:f}=ie({queryKey:["router-logs"],queryFn:()=>Ae.getRouterLogs({limit:200}),refetchInterval:5e3}),d=c==null?void 0:c.entries,m=d==null?void 0:d.filter(y=>t==="all"?!0:y.level.toLowerCase()===t);r.useEffect(()=>{if(n&&l.current){const y=l.current.querySelector("[data-radix-scroll-area-viewport]");y&&(y.scrollTop=y.scrollHeight)}},[m,n]);const p=()=>{u()},j=()=>{A({title:"Log clearing is handled on the server side"})},w=()=>{if(!m||m.length===0){A({title:"No logs to download",variant:"destructive"});return}const y=m.map(_=>`[${_.timestamp}] [${_.level}] ${_.target?`[${_.target}] `:""}${_.message||""}`).join(`
`),S=new Blob([y],{type:"text/plain"}),k=URL.createObjectURL(S),x=document.createElement("a");x.href=k,x.download=`logs-router-${new Date().toISOString().slice(0,10)}.txt`,x.click(),URL.revokeObjectURL(k),A({title:"Logs downloaded"})},v=y=>{const S=y.toLowerCase();return S==="error"?"text-destructive":S==="warn"||S==="warning"?"text-warning":S==="info"?"text-primary":S==="debug"?"text-muted-foreground":"text-foreground"};return e.jsxs(re,{children:[e.jsx(fe,{className:"pb-4",children:e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs(ve,{className:"flex items-center gap-2",children:[e.jsx(lt,{className:"h-5 w-5"}),"Log Viewer",m&&e.jsx(D,{variant:"secondary",className:"ml-2",children:m.length})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 border rounded-md bg-muted/30",children:[e.jsx(Ge,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Router"})]}),e.jsxs(Me,{value:t,onValueChange:y=>a(y),children:[e.jsx(Te,{className:"w-28",children:e.jsx(Ie,{})}),e.jsxs(Fe,{children:[e.jsx(q,{value:"all",children:"All"}),e.jsx(q,{value:"error",children:"Error"}),e.jsx(q,{value:"warn",children:"Warn"}),e.jsx(q,{value:"info",children:"Info"}),e.jsx(q,{value:"debug",children:"Debug"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Da,{id:"auto-scroll",checked:n,onCheckedChange:i}),e.jsx(F,{htmlFor:"auto-scroll",className:"text-sm",children:"Auto-scroll"})]})]})]})}),e.jsxs(ne,{children:[e.jsxs("div",{className:"mb-4 flex gap-2",children:[e.jsxs(b,{id:"logs-router-refresh",variant:"outline",size:"sm",onClick:p,disabled:f,children:[e.jsx(we,{className:T("mr-2 h-4 w-4",f&&"animate-spin")}),"Refresh"]}),e.jsxs(b,{variant:"outline",size:"sm",onClick:w,children:[e.jsx(La,{className:"mr-2 h-4 w-4"}),"Download"]}),e.jsxs(b,{variant:"outline",size:"sm",onClick:j,children:[e.jsx(Ve,{className:"mr-2 h-4 w-4"}),"Clear"]})]}),e.jsx(Ee,{className:"h-96 rounded-md border bg-muted/30",ref:l,children:e.jsx("div",{id:"logs-router-list",className:"p-4 font-mono text-xs space-y-0.5",children:!m||m.length===0?e.jsx("div",{className:"flex h-32 items-center justify-center text-muted-foreground",children:"No logs available"}):m.map((y,S)=>e.jsxs("div",{className:"flex gap-2 py-0.5 hover:bg-muted/50 rounded px-1 -mx-1",children:[e.jsx("span",{className:"text-muted-foreground shrink-0",children:new Date(y.timestamp).toLocaleTimeString()}),e.jsx("span",{className:T("uppercase w-12 shrink-0 font-semibold",v(y.level)),children:y.level}),y.target&&e.jsxs("span",{className:"text-muted-foreground shrink-0",children:["[",y.target,"]"]}),e.jsx("span",{className:"break-all",children:y.message||""})]},S))})})]})]})}function Or(){const{data:s,isLoading:t}=ie({queryKey:["token-stats-daily"],queryFn:()=>Ae.getDailyTokenStats(7)}),{data:a,isLoading:n}=ie({queryKey:["token-stats-monthly"],queryFn:()=>Ae.getMonthlyTokenStats(6)});return e.jsxs(re,{children:[e.jsx(fe,{children:e.jsxs(ve,{className:"flex items-center gap-2",children:[e.jsx(ds,{className:"h-5 w-5"}),"Token Statistics"]})}),e.jsx(ne,{children:e.jsxs(fs,{defaultValue:"daily",className:"space-y-4",children:[e.jsxs(ss,{children:[e.jsxs(G,{value:"daily",className:"gap-2",children:[e.jsx(Za,{className:"h-4 w-4"}),"Daily"]}),e.jsxs(G,{value:"monthly",className:"gap-2",children:[e.jsx(qa,{className:"h-4 w-4"}),"Monthly"]})]}),e.jsx(B,{value:"daily",children:t?e.jsx("div",{className:"space-y-2",children:[...Array(5)].map((i,l)=>e.jsx("div",{className:"h-10 shimmer rounded"},l))}):s&&s.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-5 gap-2 text-sm font-medium text-muted-foreground border-b pb-2",children:[e.jsx("div",{children:"Date"}),e.jsx("div",{className:"text-right",children:"Requests"}),e.jsx("div",{className:"text-right",children:"Input"}),e.jsx("div",{className:"text-right",children:"Output"}),e.jsx("div",{className:"text-right",children:"Total"})]}),s.map(i=>e.jsxs("div",{className:"grid grid-cols-5 gap-2 text-sm py-2 border-b border-border/50",children:[e.jsx("div",{className:"font-medium",children:i.date}),e.jsx("div",{className:"text-right",children:U(i.request_count)}),e.jsx("div",{className:"text-right text-muted-foreground",children:U(i.total_input_tokens)}),e.jsx("div",{className:"text-right text-muted-foreground",children:U(i.total_output_tokens)}),e.jsx("div",{className:"text-right font-medium",children:U(i.total_tokens)})]},i.date))]}):e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No daily statistics available"})}),e.jsx(B,{value:"monthly",children:n?e.jsx("div",{className:"space-y-2",children:[...Array(3)].map((i,l)=>e.jsx("div",{className:"h-10 shimmer rounded"},l))}):a&&a.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-5 gap-2 text-sm font-medium text-muted-foreground border-b pb-2",children:[e.jsx("div",{children:"Month"}),e.jsx("div",{className:"text-right",children:"Requests"}),e.jsx("div",{className:"text-right",children:"Input"}),e.jsx("div",{className:"text-right",children:"Output"}),e.jsx("div",{className:"text-right",children:"Total"})]}),a.map(i=>e.jsxs("div",{className:"grid grid-cols-5 gap-2 text-sm py-2 border-b border-border/50",children:[e.jsx("div",{className:"font-medium",children:i.month}),e.jsx("div",{className:"text-right",children:U(i.request_count)}),e.jsx("div",{className:"text-right text-muted-foreground",children:U(i.total_input_tokens)}),e.jsx("div",{className:"text-right text-muted-foreground",children:U(i.total_output_tokens)}),e.jsx("div",{className:"text-right font-medium",children:U(i.total_tokens)})]},i.month))]}):e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No monthly statistics available"})})]})})]})}function Hs(s){return s==null||Number.isNaN(s)?"—":`${s.toFixed(1)} GB`}function Lr(s){return s==null||Number.isNaN(s)?"—":`${(s/(1024*1024*1024)).toFixed(1)} GB`}function Kr(s,t){if(t)return e.jsx(D,{variant:"online",children:"Ready"});switch(s){case"registered":return e.jsx(D,{variant:"online",children:"Registered"});case"pending":return e.jsx(D,{variant:"outline",children:"Pending"});case"error":return e.jsx(D,{variant:"destructive",children:"Error"});default:return e.jsx(D,{variant:"outline",children:s})}}const Gs={openai:{name:"OpenAI",color:"text-green-600"},anthropic:{name:"Anthropic",color:"text-orange-600"},google:{name:"Google",color:"text-blue-600"}};function Ur(){const s=ye(),[t,a]=r.useState(""),[n,i]=r.useState(!1),[l,c]=r.useState(""),[u,f]=r.useState(""),[d,m]=r.useState(""),[p,j]=r.useState(!1),[w,v]=r.useState(""),[y,S]=r.useState([]);function k(){c(""),f(""),m(""),j(!1),v(""),S([])}const{data:x,isLoading:_}=ie({queryKey:["registered-models"],queryFn:is.getRegistered,refetchInterval:1e4}),O=Y({mutationFn:o=>is.register(o),onSuccess:()=>{s.invalidateQueries({queryKey:["registered-models"]}),A({title:"Model registered"}),i(!1),k()},onError:o=>{A({title:"Failed to register model",description:o instanceof Error?o.message:"Unknown error",variant:"destructive"})}}),K=Y({mutationFn:o=>is.discoverGguf(o),onSuccess:o=>{v(o.base_model),S(o.gguf_alternatives),j(!0)},onError:o=>{A({title:"Failed to discover GGUF alternatives",description:o instanceof Error?o.message:"Unknown error",variant:"destructive"})}}),z=Y({mutationFn:o=>is.delete(o),onSuccess:()=>{s.invalidateQueries({queryKey:["registered-models"]}),s.invalidateQueries({queryKey:["models-hub"]}),A({title:"Model deleted"})},onError:o=>{A({title:"Failed to delete model",description:o instanceof Error?o.message:"Unknown error",variant:"destructive"})}}),N=x,H=N==null?void 0:N.filter(o=>o.owned_by==="router"||!o.owned_by),C=N==null?void 0:N.filter(o=>o.owned_by==="openai"),se=N==null?void 0:N.filter(o=>o.owned_by==="anthropic"),le=N==null?void 0:N.filter(o=>o.owned_by==="google"),ce=H==null?void 0:H.filter(o=>o.name.toLowerCase().includes(t.toLowerCase())),g=o=>e.jsx(re,{className:"overflow-hidden",children:e.jsxs(ne,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0 space-y-1",children:[e.jsx("h4",{className:"truncate font-medium",children:o.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:o.owned_by||"cloud"})]}),e.jsx(D,{variant:"online",children:"Ready"})]}),o.description&&e.jsx("p",{className:"mt-2 text-sm text-muted-foreground line-clamp-2",children:o.description})]})},o.name),P=(o,$)=>_?e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((qs,vs)=>e.jsx("div",{className:"h-24 shimmer rounded"},vs))}):!o||o.length===0?e.jsxs("div",{className:"flex h-32 flex-col items-center justify-center gap-2 text-muted-foreground",children:[e.jsx(ls,{className:"h-8 w-8"}),e.jsxs("p",{children:["No ",Gs[$].name," models available"]}),e.jsxs("p",{className:"text-sm",children:["Configure ",Gs[$].name," API key to access models"]})]}):e.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:o.map(g)});return e.jsxs(e.Fragment,{children:[e.jsxs(re,{children:[e.jsx(fe,{children:e.jsxs(ve,{className:"flex items-center gap-2",children:[e.jsx(os,{className:"h-5 w-5"}),"Models"]})}),e.jsx(ne,{children:e.jsxs(fs,{defaultValue:"local",className:"space-y-4",children:[e.jsxs(ss,{className:"flex-wrap",children:[e.jsxs(G,{value:"local",className:"gap-2",children:[e.jsx(os,{className:"h-4 w-4"}),"Local",H&&e.jsx(D,{variant:"secondary",className:"ml-1",children:H.length})]}),C&&C.length>0&&e.jsxs(G,{value:"openai",className:"gap-2",children:[e.jsx(ls,{className:"h-4 w-4 text-green-600"}),"OpenAI",e.jsx(D,{variant:"secondary",className:"ml-1",children:C.length})]}),se&&se.length>0&&e.jsxs(G,{value:"anthropic",className:"gap-2",children:[e.jsx(ls,{className:"h-4 w-4 text-orange-600"}),"Anthropic",e.jsx(D,{variant:"secondary",className:"ml-1",children:se.length})]}),le&&le.length>0&&e.jsxs(G,{value:"google",className:"gap-2",children:[e.jsx(ls,{className:"h-4 w-4 text-blue-600"}),"Google",e.jsx(D,{variant:"secondary",className:"ml-1",children:le.length})]})]}),e.jsxs(B,{value:"local",className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ot,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(L,{placeholder:"Search local models...",value:t,onChange:o=>a(o.target.value),className:"pl-9"})]}),e.jsxs(b,{id:"register-model",variant:"outline",onClick:()=>i(!0),children:[e.jsx(Be,{className:"mr-2 h-4 w-4"}),"Register"]})]}),_?e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((o,$)=>e.jsx("div",{className:"h-24 shimmer rounded"},$))}):!ce||ce.length===0?e.jsxs("div",{className:"flex h-32 flex-col items-center justify-center gap-2 text-muted-foreground",children:[e.jsx(os,{className:"h-8 w-8"}),e.jsx("p",{children:"No local models"}),e.jsx("p",{className:"text-sm",children:"Register a model from Hugging Face using the Register button"})]}):e.jsx("div",{id:"local-models-list",className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:ce.map(o=>e.jsx(re,{className:"overflow-hidden",children:e.jsxs(ne,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0 space-y-1",children:[e.jsx("h4",{className:"truncate font-medium",children:o.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[o.source||"local",o.repo?` • ${o.repo}`:""]})]}),Kr(o.lifecycle_status,o.ready)]}),e.jsxs("div",{className:"mt-3 space-y-1 text-sm",children:[e.jsxs("p",{className:"text-muted-foreground",children:["Size: ",Hs(o.size_gb)]}),e.jsxs("p",{className:"text-muted-foreground",children:["Required VRAM: ",Hs(o.required_memory_gb)]})]}),e.jsx("div",{className:"mt-4 flex gap-2",children:e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>z.mutate(o.name),disabled:z.isPending,children:e.jsx(Ve,{className:"h-4 w-4 text-destructive"})})})]})},o.name))})]}),e.jsx(B,{value:"openai",className:"space-y-4",children:P(C,"openai")}),e.jsx(B,{value:"anthropic",className:"space-y-4",children:P(se,"anthropic")}),e.jsx(B,{value:"google",className:"space-y-4",children:P(le,"google")})]})})]}),e.jsx(Q,{open:n,onOpenChange:o=>{i(o),o||k()},children:e.jsxs(W,{id:"register-modal",children:[e.jsxs(Z,{children:[e.jsx(J,{children:"Register Model"}),e.jsxs(X,{children:["Register a model from Hugging Face. If a repository contains multiple artifacts, specify the exact filename to use. Nodes download artifacts directly. Browse models at"," ",e.jsx("a",{href:"https://huggingface.co/models",target:"_blank",rel:"noopener noreferrer",className:"text-primary underline",children:"huggingface.co"})]})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"register-repo",children:"Repo"}),e.jsx(L,{id:"register-repo",placeholder:"nvidia/NVIDIA-Nemotron-3-Nano-30B-A3B-BF16",value:l,onChange:o=>c(o.target.value)})]}),e.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-md border bg-muted/30 px-3 py-2",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"If the repo you entered is a base model repo (safetensors), you can discover GGUF alternatives."}),e.jsxs(b,{id:"discover-gguf",variant:"outline",size:"sm",disabled:!l.trim()||K.isPending,onClick:()=>K.mutate(l.trim()),children:[K.isPending?e.jsx(te,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Discover"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"register-filename",children:"Filename (optional)"}),e.jsx(L,{id:"register-filename",placeholder:"model.safetensors or model.Q4_K_M.gguf",value:u,onChange:o=>f(o.target.value)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"If the repo has multiple artifacts, specify the exact filename you want the node to download."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"register-display-name",children:"Display name (optional)"}),e.jsx(L,{id:"register-display-name",placeholder:"Optional display name",value:d,onChange:o=>m(o.target.value)})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"The router stores metadata only. Nodes download model artifacts directly from Hugging Face."})]}),e.jsxs(xe,{children:[e.jsx(b,{id:"register-modal-close",variant:"outline",onClick:()=>i(!1),children:"Cancel"}),e.jsxs(b,{id:"register-submit",onClick:()=>O.mutate({repo:l.trim(),filename:u.trim()?u.trim():void 0,display_name:d.trim()?d.trim():void 0}),disabled:!l.trim()||O.isPending,children:[O.isPending?e.jsx(te,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Register"]})]})]})}),e.jsx(Q,{open:p,onOpenChange:j,children:e.jsxs(W,{id:"discover-gguf-modal",className:"max-w-3xl max-h-[80vh] overflow-hidden",children:[e.jsxs(Z,{children:[e.jsx(J,{children:"GGUF alternatives"}),e.jsxs(X,{children:["Discover GGUF repos for ",e.jsx("code",{children:w||l||"model"})," and pick an exact file."]})]}),e.jsx("div",{className:"max-h-[60vh] space-y-3 overflow-y-auto pr-1",children:y.length===0?e.jsx("div",{className:"rounded-md border bg-muted/30 p-4 text-sm text-muted-foreground",children:"No GGUF alternatives found. Try a different search term or check Hugging Face manually."}):y.map(o=>e.jsxs(re,{className:"border-border/50",children:[e.jsxs(fe,{className:"pb-3",children:[e.jsxs(ve,{className:"text-base",children:[o.repo," ",o.trusted?e.jsx(D,{variant:"secondary",className:"ml-2",children:"trusted"}):null]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Provider: ",o.provider]})]}),e.jsx(ne,{className:"space-y-2",children:o.files.map($=>e.jsxs("div",{className:"flex flex-col gap-2 rounded-md border bg-background px-3 py-2 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-medium",children:$.filename}),e.jsxs("div",{className:"mt-0.5 text-xs text-muted-foreground",children:[$.quantization?e.jsxs("span",{children:[$.quantization," - "]}):null,Lr($.size_bytes)]})]}),e.jsx(b,{size:"sm",variant:"outline",onClick:()=>{c(o.repo),f($.filename),j(!1),A({title:"Selected GGUF file",description:`${o.repo} - ${$.filename}`})},children:"Use"})]},`${o.repo}/${$.filename}`))})]},o.repo))}),e.jsx(xe,{children:e.jsx(b,{variant:"outline",onClick:()=>j(!1),children:"Close"})})]})})]})}function zr(){const{user:s}=Ts(),{isConnected:t}=Ya(),[a,n]=r.useState(null),[i,l]=r.useState(null),c=r.useRef(null),u=t?1e4:5e3,f=r.useCallback(async()=>{c.current=performance.now();const x=await Ae.getOverview(),_=performance.now();return l(Math.round(_-(c.current||_))),n(new Date),x},[]),{data:d,isLoading:m,error:p,refetch:j}=ie({queryKey:["dashboard-overview"],queryFn:f,refetchInterval:u}),{data:w,isLoading:v}=ie({queryKey:["request-responses"],queryFn:()=>Ae.getRequestResponses({limit:100}),refetchInterval:u}),{data:y,isLoading:S}=ie({queryKey:["dashboard-endpoints"],queryFn:()=>Ae.getEndpoints(),refetchInterval:u}),k=r.useMemo(()=>w!=null&&w.records?w.records.map(x=>({request_id:x.id,timestamp:x.timestamp,model:x.model,node_id:x.node_id,node_name:x.node_machine_name,status:x.status.type,duration_ms:x.duration_ms,error:x.status.type==="error"?x.status.message:void 0,request_body:x.request_body,response_body:x.response_body})):[],[w]);return p?e.jsx("div",{className:"flex h-screen w-full items-center justify-center bg-background",children:e.jsxs("div",{className:"flex flex-col items-center gap-4 text-center",children:[e.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-full bg-destructive/10",children:e.jsx(it,{className:"h-8 w-8 text-destructive"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Failed to load dashboard"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:p instanceof Error?p.message:"An error occurred"})]}),e.jsx("button",{onClick:()=>j(),className:"text-sm text-primary hover:underline",children:"Try again"})]})}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"fixed inset-0 bg-grid opacity-20 pointer-events-none"}),e.jsx(wr,{user:s,isConnected:!p,lastRefreshed:a,fetchTimeMs:i}),e.jsxs("main",{className:"relative mx-auto max-w-[1600px] px-4 py-6 sm:px-6 lg:px-8",children:[e.jsx("section",{className:"mb-8",children:e.jsx(kr,{stats:d==null?void 0:d.stats,isLoading:m})}),e.jsxs(fs,{defaultValue:"endpoints",className:"space-y-6",children:[e.jsxs(ss,{className:"grid w-full grid-cols-5 lg:w-auto lg:inline-grid",children:[e.jsxs(G,{value:"endpoints",className:"gap-2",children:[e.jsx(za,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Endpoints"})]}),e.jsxs(G,{value:"models",className:"gap-2",children:[e.jsx(os,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Models"})]}),e.jsxs(G,{value:"statistics",className:"gap-2",children:[e.jsx(Oa,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Statistics"})]}),e.jsxs(G,{value:"history",className:"gap-2",children:[e.jsx(ze,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"History"})]}),e.jsxs(G,{value:"logs",className:"gap-2",children:[e.jsx(lt,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Logs"})]})]}),e.jsx(B,{value:"endpoints",className:"animate-fade-in",children:e.jsx(Er,{endpoints:y||[],isLoading:S})}),e.jsx(B,{value:"models",className:"animate-fade-in",children:e.jsx(Ur,{})}),e.jsx(B,{value:"statistics",className:"animate-fade-in",children:e.jsx(Or,{})}),e.jsx(B,{value:"history",className:"animate-fade-in",children:e.jsx(Pr,{history:k,isLoading:v})}),e.jsx(B,{value:"logs",className:"animate-fade-in",children:e.jsx(qr,{})})]})]})]})}function $r(){const{isLoading:s}=Ts();return r.useEffect(()=>{!s&&!Vs()&&(window.location.href="/dashboard/login.html")},[s]),s?e.jsx("div",{className:"flex h-screen w-full items-center justify-center bg-background",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"h-12 w-12 rounded-full border-4 border-primary/20"}),e.jsx("div",{className:"absolute inset-0 h-12 w-12 animate-spin rounded-full border-4 border-transparent border-t-primary"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading..."})]})}):e.jsx(zr,{})}const Hr=new Ea({defaultOptions:{queries:{staleTime:5e3,refetchInterval:5e3,retry:1}}});ea.createRoot(document.getElementById("root")).render(e.jsx(r.StrictMode,{children:e.jsx(Ma,{client:Hr,children:e.jsx(Ia,{children:e.jsxs(sa,{children:[e.jsx($r,{}),e.jsx(ta,{})]})})})}));
