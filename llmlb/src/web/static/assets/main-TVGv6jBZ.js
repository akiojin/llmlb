var Hs=s=>{throw TypeError(s)};var bs=(s,t,a)=>t.has(s)||Hs("Cannot "+a);var I=(s,t,a)=>(bs(s,t,"read from private field"),a?a.call(s):t.get(s)),ke=(s,t,a)=>t.has(s)?Hs("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(s):t.set(s,a),Se=(s,t,a,n)=>(bs(s,t,"write to private field"),n?n.call(s,a):t.set(s,a),a),_e=(s,t,a)=>(bs(s,t,"access private method"),a);import{r,i as Js,a as ws,b as Yt,j as e,c as M,g as ea,d as Is,P as Xs,e as we,u as Ys,f as ps,h as Re,k as sa,l as D,m as ta,n as et,B as N,o as me,L as F,I as L,t as A,p as Cs,U as st,q as is,s as ks,C as Fs,v as U,w as Ss,x as Ms,y as be,z as Me,A as Ae,D as aa,T as ra,E as na}from"./index--YjWXSSi.js";import{S as ia,s as la,h as Bs,g as ca,n as tt,u as ge,a as oa,b as da,c as ha,C as xe,d as at,O as ua,P as ma,W as xa,e as pa,T as ga,D as ja,f as rt,R as fa,i as va,j as ie,k as Z,l as J,m as X,o as Y,p as ee,q as Ve,r as Ce,t as He,v as Te,B as _,w as Qe,x as pe,y as De,z as Ie,A as Fe,E as qe,F as P,M as ds,G as ya,H as Na,I as ba,J as wa,K as Ca,L as ka,N as _s,Q as Ue,U as Gs,V as Sa,X as nt,Y as _a,Z as Aa,_ as it,$ as Ra,a0 as Ma,a1 as Ea,a2 as Ta,a3 as Da,a4 as Ia,a5 as Fa}from"./switch-COqQk_8P.js";import{T as Es,C as hs}from"./ticket-CkYi1Xsm.js";import{C as ae,a as re,b as ye,c as Ne}from"./card-T3m8DZuE.js";var de,fe,V,he,ue,cs,Ts,Zs,qa=(Zs=class extends ia{constructor(t,a){super();ke(this,ue);ke(this,de);ke(this,fe);ke(this,V);ke(this,he);Se(this,de,t),this.setOptions(a),this.bindMethods(),_e(this,ue,cs).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var n;const a=this.options;this.options=I(this,de).defaultMutationOptions(t),la(this.options,a)||I(this,de).getMutationCache().notify({type:"observerOptionsUpdated",mutation:I(this,V),observer:this}),a!=null&&a.mutationKey&&this.options.mutationKey&&Bs(a.mutationKey)!==Bs(this.options.mutationKey)?this.reset():((n=I(this,V))==null?void 0:n.state.status)==="pending"&&I(this,V).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=I(this,V))==null||t.removeObserver(this)}onMutationUpdate(t){_e(this,ue,cs).call(this),_e(this,ue,Ts).call(this,t)}getCurrentResult(){return I(this,fe)}reset(){var t;(t=I(this,V))==null||t.removeObserver(this),Se(this,V,void 0),_e(this,ue,cs).call(this),_e(this,ue,Ts).call(this)}mutate(t,a){var n;return Se(this,he,a),(n=I(this,V))==null||n.removeObserver(this),Se(this,V,I(this,de).getMutationCache().build(I(this,de),this.options)),I(this,V).addObserver(this),I(this,V).execute(t)}},de=new WeakMap,fe=new WeakMap,V=new WeakMap,he=new WeakMap,ue=new WeakSet,cs=function(){var a;const t=((a=I(this,V))==null?void 0:a.state)??ca();Se(this,fe,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},Ts=function(t){tt.batch(()=>{var a,n,i,l,c,h,g,o;if(I(this,he)&&this.hasListeners()){const d=I(this,fe).variables,p=I(this,fe).context,j={client:I(this,de),meta:this.options.meta,mutationKey:this.options.mutationKey};if((t==null?void 0:t.type)==="success"){try{(n=(a=I(this,he)).onSuccess)==null||n.call(a,t.data,d,p,j)}catch(w){Promise.reject(w)}try{(l=(i=I(this,he)).onSettled)==null||l.call(i,t.data,null,d,p,j)}catch(w){Promise.reject(w)}}else if((t==null?void 0:t.type)==="error"){try{(h=(c=I(this,he)).onError)==null||h.call(c,t.error,d,p,j)}catch(w){Promise.reject(w)}try{(o=(g=I(this,he)).onSettled)==null||o.call(g,void 0,t.error,d,p,j)}catch(w){Promise.reject(w)}}}this.listeners.forEach(d=>{d(I(this,fe))})})},Zs);function Q(s,t){const a=ge(),[n]=r.useState(()=>new qa(a,s));r.useEffect(()=>{n.setOptions(s)},[n,s]);const i=r.useSyncExternalStore(r.useCallback(c=>n.subscribe(tt.batchCalls(c)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),l=r.useCallback((c,h)=>{n.mutate(c,h).catch(oa)},[n]);if(i.error&&da(n.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:l,mutateAsync:i.mutate}}const lt=r.createContext(null);function Pa({children:s}){const[t,a]=r.useState(null),[n,i]=r.useState(!0),l=r.useCallback(async()=>{if(!Js()){a(null),i(!1);return}try{const g=await ws.me();a(g)}catch{Yt(),a(null)}finally{i(!1)}},[]),c=r.useCallback(async(g,o)=>{await ws.login(g,o),await l()},[l]),h=r.useCallback(async()=>{await ws.logout(),a(null),window.location.href="/dashboard/login.html"},[]);return r.useEffect(()=>{l()},[l]),e.jsx(lt.Provider,{value:{user:t,isLoading:n,isLoggedIn:!!t,login:c,logout:h,checkAuth:l},children:s})}function qs(){const s=r.useContext(lt);if(!s)throw new Error("useAuth must be used within an AuthProvider");return s}/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const La=M("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oa=M("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=M("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ka=M("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ua=M("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=M("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=M("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=M("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=M("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ls=M("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=M("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const za=M("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $a=M("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=M("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ha=M("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=M("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=M("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=M("Hourglass",[["path",{d:"M5 22h14",key:"ehvnwv"}],["path",{d:"M5 2h14",key:"pdyrp9"}],["path",{d:"M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22",key:"1d314k"}],["path",{d:"M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2",key:"1vvvr6"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ga=M("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=M("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=M("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Va=M("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=M("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qa=M("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=M("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=M("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wa=M("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Za=M("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ja=M("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12a2 2 0 0 1-2-2V7",key:"6c3vgh"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xa=M("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ya=M("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=M("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const er=M("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function sr(s={}){const{onMessage:t,onConnect:a,onDisconnect:n,reconnectInterval:i=3e3}=s,l=ge(),c=r.useRef(null),h=r.useRef(null),[g,o]=r.useState(!1),[d,p]=r.useState(null),j=r.useCallback(()=>{const v=ea();if(!v){console.warn("No JWT token available for WebSocket connection"),h.current=setTimeout(j,i);return}const S=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws/dashboard?token=${encodeURIComponent(v)}`;try{const k=new WebSocket(S);c.current=k,k.onopen=()=>{o(!0),a==null||a()},k.onmessage=x=>{try{const R=JSON.parse(x.data);switch(p(R),t==null||t(R),R.type){case"NodeRegistered":case"NodeRemoved":case"NodeStatusChanged":l.invalidateQueries({queryKey:["dashboard-overview"]}),l.invalidateQueries({queryKey:["request-responses"]});break;case"MetricsUpdated":l.invalidateQueries({queryKey:["dashboard-overview"]});break}}catch(R){console.error("Failed to parse WebSocket message:",R)}},k.onclose=()=>{o(!1),n==null||n(),c.current=null,h.current&&clearTimeout(h.current),h.current=setTimeout(j,i)},k.onerror=x=>{console.error("WebSocket error:",x),k.close()}}catch(k){console.error("Failed to create WebSocket:",k),h.current=setTimeout(j,i)}},[t,a,n,i,l]),w=r.useCallback(()=>{h.current&&(clearTimeout(h.current),h.current=null),c.current&&(c.current.close(),c.current=null),o(!1)},[]);return r.useEffect(()=>(j(),()=>{w()}),[j,w]),{isConnected:g,lastEvent:d,reconnect:j,disconnect:w}}function tr(){const{isConnected:s,lastEvent:t,reconnect:a}=sr({onConnect:()=>{console.log("Dashboard WebSocket connected")},onDisconnect:()=>{console.log("Dashboard WebSocket disconnected")}});return{isConnected:s,lastEvent:t,reconnect:a}}const As="llmlb-theme";function ar(){const[s,t]=r.useState(()=>{if(typeof window>"u")return"dark";const n=localStorage.getItem(As);return n==="light"||n==="dark"?n:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"});r.useEffect(()=>{document.documentElement.classList.toggle("dark",s==="dark"),localStorage.setItem(As,s)},[s]),r.useEffect(()=>{const n=window.matchMedia("(prefers-color-scheme: dark)"),i=l=>{localStorage.getItem(As)||t(l.matches?"dark":"light")};return n.addEventListener("change",i),()=>n.removeEventListener("change",i)},[]);const a=r.useCallback(()=>{t(n=>n==="dark"?"light":"dark")},[]);return{theme:s,setTheme:t,toggleTheme:a}}var gs="Checkbox",[rr]=Is(gs),[nr,Ls]=rr(gs);function ir(s){const{__scopeCheckbox:t,checked:a,children:n,defaultChecked:i,disabled:l,form:c,name:h,onCheckedChange:g,required:o,value:d="on",internal_do_not_use_render:p}=s,[j,w]=Ys({prop:a,defaultProp:i??!1,onChange:g,caller:gs}),[v,y]=r.useState(null),[S,k]=r.useState(null),x=r.useRef(!1),R=v?!!c||!!v.closest("form"):!0,O={checked:j,disabled:l,setChecked:w,control:v,setControl:y,name:h,form:c,value:d,hasConsumerStoppedPropagationRef:x,required:o,defaultChecked:ve(i)?!1:i,isFormControl:R,bubbleInput:S,setBubbleInput:k};return e.jsx(nr,{scope:t,...O,children:lr(p)?p(O):n})}var mt="CheckboxTrigger",xt=r.forwardRef(({__scopeCheckbox:s,onKeyDown:t,onClick:a,...n},i)=>{const{control:l,value:c,disabled:h,checked:g,required:o,setControl:d,setChecked:p,hasConsumerStoppedPropagationRef:j,isFormControl:w,bubbleInput:v}=Ls(mt,s),y=ps(i,d),S=r.useRef(g);return r.useEffect(()=>{const k=l==null?void 0:l.form;if(k){const x=()=>p(S.current);return k.addEventListener("reset",x),()=>k.removeEventListener("reset",x)}},[l,p]),e.jsx(we.button,{type:"button",role:"checkbox","aria-checked":ve(g)?"mixed":g,"aria-required":o,"data-state":vt(g),"data-disabled":h?"":void 0,disabled:h,value:c,...n,ref:y,onKeyDown:Re(t,k=>{k.key==="Enter"&&k.preventDefault()}),onClick:Re(a,k=>{p(x=>ve(x)?!0:!x),v&&w&&(j.current=k.isPropagationStopped(),j.current||k.stopPropagation())})})});xt.displayName=mt;var Os=r.forwardRef((s,t)=>{const{__scopeCheckbox:a,name:n,checked:i,defaultChecked:l,required:c,disabled:h,value:g,onCheckedChange:o,form:d,...p}=s;return e.jsx(ir,{__scopeCheckbox:a,checked:i,defaultChecked:l,disabled:h,required:c,onCheckedChange:o,name:n,form:d,value:g,internal_do_not_use_render:({isFormControl:j})=>e.jsxs(e.Fragment,{children:[e.jsx(xt,{...p,ref:t,__scopeCheckbox:a}),j&&e.jsx(ft,{__scopeCheckbox:a})]})})});Os.displayName=gs;var pt="CheckboxIndicator",gt=r.forwardRef((s,t)=>{const{__scopeCheckbox:a,forceMount:n,...i}=s,l=Ls(pt,a);return e.jsx(Xs,{present:n||ve(l.checked)||l.checked===!0,children:e.jsx(we.span,{"data-state":vt(l.checked),"data-disabled":l.disabled?"":void 0,...i,ref:t,style:{pointerEvents:"none",...s.style}})})});gt.displayName=pt;var jt="CheckboxBubbleInput",ft=r.forwardRef(({__scopeCheckbox:s,...t},a)=>{const{control:n,hasConsumerStoppedPropagationRef:i,checked:l,defaultChecked:c,required:h,disabled:g,name:o,value:d,form:p,bubbleInput:j,setBubbleInput:w}=Ls(jt,s),v=ps(a,w),y=ha(l),S=sa(n);r.useEffect(()=>{const x=j;if(!x)return;const R=window.HTMLInputElement.prototype,K=Object.getOwnPropertyDescriptor(R,"checked").set,z=!i.current;if(y!==l&&K){const b=new Event("click",{bubbles:z});x.indeterminate=ve(l),K.call(x,ve(l)?!1:l),x.dispatchEvent(b)}},[j,y,l,i]);const k=r.useRef(ve(l)?!1:l);return e.jsx(we.input,{type:"checkbox","aria-hidden":!0,defaultChecked:c??k.current,required:h,disabled:g,name:o,value:d,form:p,...t,tabIndex:-1,ref:v,style:{...t.style,...S,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});ft.displayName=jt;function lr(s){return typeof s=="function"}function ve(s){return s==="indeterminate"}function vt(s){return ve(s)?"indeterminate":s?"checked":"unchecked"}const yt=r.forwardRef(({className:s,...t},a)=>e.jsx(Os,{ref:a,className:D("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...t,children:e.jsx(gt,{className:D("flex items-center justify-center text-current"),children:e.jsx(xe,{className:"h-4 w-4"})})}));yt.displayName=Os.displayName;const Pe=r.forwardRef(({className:s,...t},a)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:a,className:D("w-full caption-bottom text-sm",s),...t})}));Pe.displayName="Table";const Le=r.forwardRef(({className:s,...t},a)=>e.jsx("thead",{ref:a,className:D("[&_tr]:border-b",s),...t}));Le.displayName="TableHeader";const Oe=r.forwardRef(({className:s,...t},a)=>e.jsx("tbody",{ref:a,className:D("[&_tr:last-child]:border-0",s),...t}));Oe.displayName="TableBody";const cr=r.forwardRef(({className:s,...t},a)=>e.jsx("tfoot",{ref:a,className:D("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...t}));cr.displayName="TableFooter";const se=r.forwardRef(({className:s,...t},a)=>e.jsx("tr",{ref:a,className:D("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...t}));se.displayName="TableRow";const T=r.forwardRef(({className:s,...t},a)=>e.jsx("th",{ref:a,className:D("h-11 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...t}));T.displayName="TableHead";const E=r.forwardRef(({className:s,...t},a)=>e.jsx("td",{ref:a,className:D("p-4 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...t}));E.displayName="TableCell";const or=r.forwardRef(({className:s,...t},a)=>e.jsx("caption",{ref:a,className:D("mt-4 text-sm text-muted-foreground",s),...t}));or.displayName="TableCaption";var Nt="AlertDialog",[dr]=Is(Nt,[at]),je=at(),bt=s=>{const{__scopeAlertDialog:t,...a}=s,n=je(t);return e.jsx(fa,{...n,...a,modal:!0})};bt.displayName=Nt;var hr="AlertDialogTrigger",ur=r.forwardRef((s,t)=>{const{__scopeAlertDialog:a,...n}=s,i=je(a);return e.jsx(va,{...i,...n,ref:t})});ur.displayName=hr;var mr="AlertDialogPortal",wt=s=>{const{__scopeAlertDialog:t,...a}=s,n=je(t);return e.jsx(ma,{...n,...a})};wt.displayName=mr;var xr="AlertDialogOverlay",Ct=r.forwardRef((s,t)=>{const{__scopeAlertDialog:a,...n}=s,i=je(a);return e.jsx(ua,{...i,...n,ref:t})});Ct.displayName=xr;var Ee="AlertDialogContent",[pr,gr]=dr(Ee),jr=ta("AlertDialogContent"),kt=r.forwardRef((s,t)=>{const{__scopeAlertDialog:a,children:n,...i}=s,l=je(a),c=r.useRef(null),h=ps(t,c),g=r.useRef(null);return e.jsx(xa,{contentName:Ee,titleName:St,docsSlug:"alert-dialog",children:e.jsx(pr,{scope:a,cancelRef:g,children:e.jsxs(pa,{role:"alertdialog",...l,...i,ref:h,onOpenAutoFocus:Re(i.onOpenAutoFocus,o=>{var d;o.preventDefault(),(d=g.current)==null||d.focus({preventScroll:!0})}),onPointerDownOutside:o=>o.preventDefault(),onInteractOutside:o=>o.preventDefault(),children:[e.jsx(jr,{children:n}),e.jsx(vr,{contentRef:c})]})})})});kt.displayName=Ee;var St="AlertDialogTitle",_t=r.forwardRef((s,t)=>{const{__scopeAlertDialog:a,...n}=s,i=je(a);return e.jsx(ga,{...i,...n,ref:t})});_t.displayName=St;var At="AlertDialogDescription",Rt=r.forwardRef((s,t)=>{const{__scopeAlertDialog:a,...n}=s,i=je(a);return e.jsx(ja,{...i,...n,ref:t})});Rt.displayName=At;var fr="AlertDialogAction",Mt=r.forwardRef((s,t)=>{const{__scopeAlertDialog:a,...n}=s,i=je(a);return e.jsx(rt,{...i,...n,ref:t})});Mt.displayName=fr;var Et="AlertDialogCancel",Tt=r.forwardRef((s,t)=>{const{__scopeAlertDialog:a,...n}=s,{cancelRef:i}=gr(Et,a),l=je(a),c=ps(t,i);return e.jsx(rt,{...l,...n,ref:c})});Tt.displayName=Et;var vr=({contentRef:s})=>{const t=`\`${Ee}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Ee}\` by passing a \`${At}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Ee}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return r.useEffect(()=>{var n;document.getElementById((n=s.current)==null?void 0:n.getAttribute("aria-describedby"))||console.warn(t)},[t,s]),null},yr=bt,Nr=wt,Dt=Ct,It=kt,Ft=Mt,qt=Tt,Pt=_t,Lt=Rt;const js=yr,br=Nr,Ot=r.forwardRef(({className:s,...t},a)=>e.jsx(Dt,{className:D("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t,ref:a}));Ot.displayName=Dt.displayName;const We=r.forwardRef(({className:s,...t},a)=>e.jsxs(br,{children:[e.jsx(Ot,{}),e.jsx(It,{ref:a,className:D("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...t})]}));We.displayName=It.displayName;const Ze=({className:s,...t})=>e.jsx("div",{className:D("flex flex-col space-y-2 text-center sm:text-left",s),...t});Ze.displayName="AlertDialogHeader";const Je=({className:s,...t})=>e.jsx("div",{className:D("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t});Je.displayName="AlertDialogFooter";const Xe=r.forwardRef(({className:s,...t},a)=>e.jsx(Pt,{ref:a,className:D("text-lg font-semibold",s),...t}));Xe.displayName=Pt.displayName;const Ye=r.forwardRef(({className:s,...t},a)=>e.jsx(Lt,{ref:a,className:D("text-sm text-muted-foreground",s),...t}));Ye.displayName=Lt.displayName;const es=r.forwardRef(({className:s,...t},a)=>e.jsx(Ft,{ref:a,className:D(et(),s),...t}));es.displayName=Ft.displayName;const ss=r.forwardRef(({className:s,...t},a)=>e.jsx(qt,{ref:a,className:D(et({variant:"outline"}),"mt-2 sm:mt-0",s),...t}));ss.displayName=qt.displayName;function wr({open:s,onOpenChange:t}){const a=ge(),[n,i]=r.useState(!1),[l,c]=r.useState(null),[h,g]=r.useState(""),[o,d]=r.useState(""),[p,j]=r.useState(["api"]),[w,v]=r.useState(null),[y,S]=r.useState(null),[k,x]=r.useState(null),{data:R,isLoading:O,refetch:K}=ie({queryKey:["api-keys"],queryFn:Cs.list,enabled:s}),z=Q({mutationFn:f=>Cs.create(f),onSuccess:f=>{a.invalidateQueries({queryKey:["api-keys"]}),v(f.key),g(""),d(""),j(["api"]),A({title:"API key created"})},onError:f=>{A({title:"Failed to create API key",description:f instanceof Error?f.message:"Unknown error",variant:"destructive"})}}),b=Q({mutationFn:f=>Cs.delete(f),onSuccess:()=>{a.invalidateQueries({queryKey:["api-keys"]}),c(null),A({title:"API key deleted"})},onError:f=>{A({title:"Failed to delete API key",description:f instanceof Error?f.message:"Unknown error",variant:"destructive"})}});r.useEffect(()=>{s||(v(null),S(null))},[s]),r.useEffect(()=>{n||(g(""),d(""),j(["api"]))},[n]);const G=async(f,q)=>{try{await navigator.clipboard.writeText(f),x(q),setTimeout(()=>x(null),2e3),A({title:"Copied to clipboard"})}catch{A({title:"Failed to copy",variant:"destructive"})}},C=()=>{z.mutate({name:h,expires_at:o||void 0,scopes:p})},te=f=>f?new Date(f)<new Date:!1,le=(f,q)=>{j(u=>q?u.includes(f)?u:[...u,f]:u.filter($=>$!==f))},ce=[{value:"api",label:"api",description:"OpenAI-compatible API inference access"},{value:"node",label:"node",description:"Endpoint registration and sync"},{value:"admin",label:"admin",description:"Administrator (full access)"}];return e.jsxs(e.Fragment,{children:[e.jsx(Z,{open:s,onOpenChange:t,children:e.jsxs(J,{id:"api-keys-modal",className:"max-w-3xl max-h-[80vh] overflow-hidden",children:[e.jsxs(X,{children:[e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(xs,{className:"h-5 w-5"}),"API Keys"]}),e.jsx(ee,{children:"Manage your API keys for programmatic access."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(N,{id:"create-api-key",onClick:()=>i(!0),children:[e.jsx(Ve,{className:"mr-2 h-4 w-4"}),"Create Key"]}),e.jsx(N,{variant:"outline",size:"icon",onClick:()=>K(),children:e.jsx(Ce,{className:"h-4 w-4"})})]}),w&&e.jsxs("div",{className:"rounded-lg border border-success/50 bg-success/10 p-4",children:[e.jsx("p",{className:"text-sm font-medium text-success mb-2",children:"API Key Created Successfully"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Copy this key now. You won't be able to see it again."}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"flex-1 rounded bg-muted px-2 py-1 text-xs font-mono break-all",children:y==="created"?w:"•".repeat(32)}),e.jsx(N,{variant:"ghost",size:"icon",onClick:()=>S(y==="created"?null:"created"),children:y==="created"?e.jsx(za,{className:"h-4 w-4"}):e.jsx($a,{className:"h-4 w-4"})}),e.jsx(N,{id:"copy-api-key",variant:"ghost",size:"icon",onClick:()=>G(w,"created"),children:k==="created"?e.jsx(xe,{className:"h-4 w-4"}):e.jsx(He,{className:"h-4 w-4"})})]})]}),e.jsx(Te,{className:"h-64 rounded-md border",children:O?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(W,{className:"h-6 w-6 animate-spin"})}):!R||R.length===0?e.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-2 text-muted-foreground",children:[e.jsx(xs,{className:"h-8 w-8"}),e.jsx("p",{children:"No API keys"})]}):e.jsxs(Pe,{children:[e.jsx(Le,{children:e.jsxs(se,{children:[e.jsx(T,{children:"Name"}),e.jsx(T,{children:"Scopes"}),e.jsx(T,{children:"Key"}),e.jsx(T,{children:"Created"}),e.jsx(T,{children:"Expires"}),e.jsx(T,{className:"text-right",children:"Actions"})]})}),e.jsx(Oe,{children:R.map(f=>e.jsxs(se,{children:[e.jsx(E,{className:"font-medium",children:f.name}),e.jsx(E,{children:e.jsx("div",{className:"flex flex-wrap gap-1",children:f.scopes.map(q=>e.jsx(_,{variant:"secondary",children:q},q))})}),e.jsx(E,{children:f.key_prefix?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("code",{className:"text-xs font-mono",children:[f.key_prefix,"..."]}),e.jsx(N,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>G(f.key_prefix,f.id),children:k===f.id?e.jsx(xe,{className:"h-3 w-3"}):e.jsx(He,{className:"h-3 w-3"})})]}):e.jsxs("span",{className:"text-xs text-muted-foreground",children:[f.id.slice(0,8),"..."]})}),e.jsx(E,{className:"text-sm text-muted-foreground",children:me(f.created_at)}),e.jsx(E,{children:f.expires_at?e.jsx(_,{variant:te(f.expires_at)?"destructive":"outline",children:te(f.expires_at)?"Expired":me(f.expires_at)}):e.jsx(_,{variant:"secondary",children:"Never"})}),e.jsx(E,{className:"text-right",children:e.jsx(N,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>c(f),children:e.jsx(Qe,{className:"h-4 w-4 text-destructive"})})})]},f.id))})]})})]})]})}),e.jsx(Z,{open:n,onOpenChange:i,children:e.jsxs(J,{children:[e.jsxs(X,{children:[e.jsx(Y,{children:"Create API Key"}),e.jsx(ee,{children:"Create a new API key for programmatic access."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"api-key-name",children:"Name"}),e.jsx(L,{id:"api-key-name",placeholder:"My API Key",value:h,onChange:f=>g(f.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"key-expires",children:"Expires (optional)"}),e.jsx(L,{id:"key-expires",type:"datetime-local",value:o,onChange:f=>d(f.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{children:"Scopes"}),e.jsx("div",{className:"grid gap-2",children:ce.map(f=>{const q=`scope-${f.value.replace(/[^a-z0-9]/gi,"-")}`;return e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx(yt,{id:q,checked:p.includes(f.value),onCheckedChange:u=>le(f.value,!!u)}),e.jsxs("label",{htmlFor:q,className:"flex flex-col gap-1 cursor-pointer",children:[e.jsx("span",{className:"font-mono text-xs",children:f.label}),e.jsx("span",{className:"text-xs text-muted-foreground",children:f.description})]})]},f.value)})})]})]}),e.jsxs(pe,{children:[e.jsx(N,{variant:"outline",onClick:()=>i(!1),children:"Cancel"}),e.jsxs(N,{onClick:C,disabled:!h||p.length===0||z.isPending,children:[z.isPending&&e.jsx(W,{className:"mr-2 h-4 w-4 animate-spin"}),"Create"]})]})]})}),e.jsx(js,{open:!!l,onOpenChange:()=>c(null),children:e.jsxs(We,{children:[e.jsxs(Ze,{children:[e.jsx(Xe,{children:"Delete API Key"}),e.jsxs(Ye,{children:['Are you sure you want to delete "',l==null?void 0:l.name,'"? This action cannot be undone.']})]}),e.jsxs(Je,{children:[e.jsx(ss,{children:"Cancel"}),e.jsxs(es,{onClick:()=>l&&b.mutate(l.id),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:[b.isPending&&e.jsx(W,{className:"mr-2 h-4 w-4 animate-spin"}),"Delete"]})]})]})})]})}function Cr({open:s,onOpenChange:t}){const a=ge(),[n,i]=r.useState(!1),[l,c]=r.useState(null),[h,g]=r.useState(null),[o,d]=r.useState(""),[p,j]=r.useState(""),[w,v]=r.useState("user"),{data:y,isLoading:S,refetch:k}=ie({queryKey:["users"],queryFn:is.list,enabled:s}),x=Q({mutationFn:C=>is.create(C),onSuccess:()=>{a.invalidateQueries({queryKey:["users"]}),K(),i(!1),A({title:"User created"})},onError:C=>{A({title:"Failed to create user",description:C instanceof Error?C.message:"Unknown error",variant:"destructive"})}}),R=Q({mutationFn:({id:C,data:te})=>is.update(C,te),onSuccess:()=>{a.invalidateQueries({queryKey:["users"]}),K(),c(null),A({title:"User updated"})},onError:C=>{A({title:"Failed to update user",description:C instanceof Error?C.message:"Unknown error",variant:"destructive"})}}),O=Q({mutationFn:C=>is.delete(C),onSuccess:()=>{a.invalidateQueries({queryKey:["users"]}),g(null),A({title:"User deleted"})},onError:C=>{A({title:"Failed to delete user",description:C instanceof Error?C.message:"Unknown error",variant:"destructive"})}}),K=()=>{d(""),j(""),v("user")};r.useEffect(()=>{l?(d(l.username),j(""),v(l.role)):K()},[l]);const z=()=>{x.mutate({username:o,password:p,role:w})},b=()=>{if(!l)return;const C={};o!==l.username&&(C.username=o),p&&(C.password=p),w!==l.role&&(C.role=w),R.mutate({id:l.id,data:C})},G=C=>C==="admin"?e.jsxs(_,{variant:"default",className:"gap-1",children:[e.jsx(Wa,{className:"h-3 w-3"}),"Admin"]}):e.jsxs(_,{variant:"secondary",className:"gap-1",children:[e.jsx(st,{className:"h-3 w-3"}),"User"]});return e.jsxs(e.Fragment,{children:[e.jsx(Z,{open:s,onOpenChange:t,children:e.jsxs(J,{className:"max-w-2xl max-h-[80vh] overflow-hidden",children:[e.jsxs(X,{children:[e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(Ds,{className:"h-5 w-5"}),"User Management"]}),e.jsx(ee,{children:"Manage dashboard users and their permissions."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(N,{onClick:()=>i(!0),children:[e.jsx(Ve,{className:"mr-2 h-4 w-4"}),"Add User"]}),e.jsx(N,{variant:"outline",size:"icon",onClick:()=>k(),children:e.jsx(Ce,{className:"h-4 w-4"})})]}),e.jsx(Te,{className:"h-64 rounded-md border",children:S?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(W,{className:"h-6 w-6 animate-spin"})}):!y||y.length===0?e.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-2 text-muted-foreground",children:[e.jsx(Ds,{className:"h-8 w-8"}),e.jsx("p",{children:"No users"})]}):e.jsxs(Pe,{children:[e.jsx(Le,{children:e.jsxs(se,{children:[e.jsx(T,{children:"Username"}),e.jsx(T,{children:"Role"}),e.jsx(T,{children:"Created"}),e.jsx(T,{className:"text-right",children:"Actions"})]})}),e.jsx(Oe,{children:y.map(C=>e.jsxs(se,{children:[e.jsx(E,{className:"font-medium",children:C.username}),e.jsx(E,{children:G(C.role)}),e.jsx(E,{className:"text-sm text-muted-foreground",children:me(C.created_at)}),e.jsx(E,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx(N,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>c(C),children:e.jsx(Za,{className:"h-4 w-4"})}),e.jsx(N,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>g(C),children:e.jsx(Qe,{className:"h-4 w-4 text-destructive"})})]})})]},C.id))})]})})]})]})}),e.jsx(Z,{open:n,onOpenChange:i,children:e.jsxs(J,{children:[e.jsxs(X,{children:[e.jsx(Y,{children:"Create User"}),e.jsx(ee,{children:"Add a new dashboard user."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"create-username",children:"Username"}),e.jsx(L,{id:"create-username",placeholder:"johndoe",value:o,onChange:C=>d(C.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"create-password",children:"Password"}),e.jsx(L,{id:"create-password",type:"password",placeholder:"••••••••",value:p,onChange:C=>j(C.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"create-role",children:"Role"}),e.jsxs(De,{value:w,onValueChange:C=>v(C),children:[e.jsx(Ie,{children:e.jsx(Fe,{})}),e.jsxs(qe,{children:[e.jsx(P,{value:"user",children:"User"}),e.jsx(P,{value:"admin",children:"Admin"})]})]})]})]}),e.jsxs(pe,{children:[e.jsx(N,{variant:"outline",onClick:()=>i(!1),children:"Cancel"}),e.jsxs(N,{onClick:z,disabled:!o||!p||x.isPending,children:[x.isPending&&e.jsx(W,{className:"mr-2 h-4 w-4 animate-spin"}),"Create"]})]})]})}),e.jsx(Z,{open:!!l,onOpenChange:()=>c(null),children:e.jsxs(J,{children:[e.jsxs(X,{children:[e.jsx(Y,{children:"Edit User"}),e.jsxs(ee,{children:['Update user "',l==null?void 0:l.username,'".']})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"edit-username",children:"Username"}),e.jsx(L,{id:"edit-username",value:o,onChange:C=>d(C.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"edit-password",children:"Password (leave blank to keep)"}),e.jsx(L,{id:"edit-password",type:"password",placeholder:"••••••••",value:p,onChange:C=>j(C.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"edit-role",children:"Role"}),e.jsxs(De,{value:w,onValueChange:C=>v(C),children:[e.jsx(Ie,{children:e.jsx(Fe,{})}),e.jsxs(qe,{children:[e.jsx(P,{value:"user",children:"User"}),e.jsx(P,{value:"admin",children:"Admin"})]})]})]})]}),e.jsxs(pe,{children:[e.jsx(N,{variant:"outline",onClick:()=>c(null),children:"Cancel"}),e.jsxs(N,{onClick:b,disabled:!o||R.isPending,children:[R.isPending&&e.jsx(W,{className:"mr-2 h-4 w-4 animate-spin"}),"Update"]})]})]})}),e.jsx(js,{open:!!h,onOpenChange:()=>g(null),children:e.jsxs(We,{children:[e.jsxs(Ze,{children:[e.jsx(Xe,{children:"Delete User"}),e.jsxs(Ye,{children:['Are you sure you want to delete "',h==null?void 0:h.username,'"? This action cannot be undone.']})]}),e.jsxs(Je,{children:[e.jsx(ss,{children:"Cancel"}),e.jsxs(es,{onClick:()=>h&&O.mutate(h.id),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:[O.isPending&&e.jsx(W,{className:"mr-2 h-4 w-4 animate-spin"}),"Delete"]})]})]})})]})}function kr({open:s,onOpenChange:t}){const a=ge(),[n,i]=r.useState(!1),[l,c]=r.useState(72),[h,g]=r.useState(null),[o,d]=r.useState(null),[p,j]=r.useState(!1),{data:w,isLoading:v,refetch:y}=ie({queryKey:["invitations"],queryFn:ks.list,enabled:s}),S=Q({mutationFn:b=>ks.create(b),onSuccess:b=>{a.invalidateQueries({queryKey:["invitations"]}),d(b),A({title:"Invitation code created"})},onError:b=>{A({title:"Failed to create invitation code",description:b instanceof Error?b.message:"Unknown error",variant:"destructive"})}}),k=Q({mutationFn:b=>ks.revoke(b),onSuccess:()=>{a.invalidateQueries({queryKey:["invitations"]}),g(null),A({title:"Invitation code revoked"})},onError:b=>{A({title:"Failed to revoke invitation code",description:b instanceof Error?b.message:"Unknown error",variant:"destructive"})}}),x=()=>{S.mutate(l)},R=async()=>{o!=null&&o.code&&(await navigator.clipboard.writeText(o.code),j(!0),setTimeout(()=>j(!1),2e3))},O=()=>{d(null),i(!1),j(!1)},K=b=>{switch(b){case"active":return e.jsxs(_,{variant:"default",className:"gap-1 bg-green-600",children:[e.jsx(Be,{className:"h-3 w-3"}),"Active"]});case"used":return e.jsxs(_,{variant:"secondary",className:"gap-1",children:[e.jsx(hs,{className:"h-3 w-3"}),"Used"]});case"revoked":return e.jsxs(_,{variant:"destructive",className:"gap-1",children:[e.jsx(us,{className:"h-3 w-3"}),"Revoked"]});default:return e.jsx(_,{variant:"outline",children:b})}},z=b=>new Date(b)<new Date;return e.jsxs(e.Fragment,{children:[e.jsx(Z,{open:s,onOpenChange:t,children:e.jsxs(J,{className:"max-w-3xl max-h-[80vh] overflow-hidden",children:[e.jsxs(X,{children:[e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(Es,{className:"h-5 w-5"}),"Invitation Codes"]}),e.jsx(ee,{children:"Create and manage invitation codes for user registration."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(N,{onClick:()=>i(!0),children:[e.jsx(Ve,{className:"mr-2 h-4 w-4"}),"Create Code"]}),e.jsx(N,{variant:"outline",size:"icon",onClick:()=>y(),children:e.jsx(Ce,{className:"h-4 w-4"})})]}),e.jsx(Te,{className:"h-80 rounded-md border",children:v?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(W,{className:"h-6 w-6 animate-spin"})}):!w||w.length===0?e.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-2 text-muted-foreground",children:[e.jsx(Es,{className:"h-8 w-8"}),e.jsx("p",{children:"No invitation codes"})]}):e.jsxs(Pe,{children:[e.jsx(Le,{children:e.jsxs(se,{children:[e.jsx(T,{children:"ID"}),e.jsx(T,{children:"Status"}),e.jsx(T,{children:"Created"}),e.jsx(T,{children:"Expires"}),e.jsx(T,{children:"Used By"}),e.jsx(T,{className:"text-right",children:"Actions"})]})}),e.jsx(Oe,{children:w.map(b=>e.jsxs(se,{children:[e.jsxs(E,{className:"font-mono text-xs",children:[b.id.slice(0,8),"..."]}),e.jsx(E,{children:b.status==="active"&&z(b.expires_at)?e.jsxs(_,{variant:"outline",className:"gap-1",children:[e.jsx(us,{className:"h-3 w-3"}),"Expired"]}):K(b.status)}),e.jsx(E,{className:"text-sm text-muted-foreground",children:me(b.created_at)}),e.jsx(E,{className:"text-sm text-muted-foreground",children:me(b.expires_at)}),e.jsx(E,{className:"font-mono text-xs text-muted-foreground",children:b.used_by?`${b.used_by.slice(0,8)}...`:"-"}),e.jsx(E,{className:"text-right",children:b.status==="active"&&!z(b.expires_at)&&e.jsx(N,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>g(b),children:e.jsx(Oa,{className:"h-4 w-4 text-destructive"})})})]},b.id))})]})})]})]})}),e.jsx(Z,{open:n&&!o,onOpenChange:b=>!b&&i(!1),children:e.jsxs(J,{children:[e.jsxs(X,{children:[e.jsx(Y,{children:"Create Invitation Code"}),e.jsx(ee,{children:"Generate a new invitation code for user registration."})]}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"expires-in",children:"Expires In"}),e.jsxs(De,{value:String(l),onValueChange:b=>c(Number(b)),children:[e.jsx(Ie,{children:e.jsx(Fe,{})}),e.jsxs(qe,{children:[e.jsx(P,{value:"24",children:"24 hours (1 day)"}),e.jsx(P,{value:"48",children:"48 hours (2 days)"}),e.jsx(P,{value:"72",children:"72 hours (3 days)"}),e.jsx(P,{value:"168",children:"168 hours (1 week)"}),e.jsx(P,{value:"720",children:"720 hours (30 days)"})]})]})]})}),e.jsxs(pe,{children:[e.jsx(N,{variant:"outline",onClick:()=>i(!1),children:"Cancel"}),e.jsxs(N,{onClick:x,disabled:S.isPending,children:[S.isPending&&e.jsx(W,{className:"mr-2 h-4 w-4 animate-spin"}),"Create"]})]})]})}),e.jsx(Z,{open:!!o,onOpenChange:O,children:e.jsxs(J,{children:[e.jsxs(X,{children:[e.jsxs(Y,{className:"flex items-center gap-2 text-green-600",children:[e.jsx(hs,{className:"h-5 w-5"}),"Invitation Code Created"]}),e.jsx(ee,{children:"Copy this code and share it with the user. This code will only be shown once."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{children:"Invitation Code"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("code",{className:"flex-1 rounded-md bg-muted px-4 py-3 font-mono text-sm break-all",children:o==null?void 0:o.code}),e.jsx(N,{variant:"outline",size:"icon",onClick:R,className:"shrink-0",children:p?e.jsx(xe,{className:"h-4 w-4 text-green-600"}):e.jsx(He,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:e.jsxs("p",{children:["Expires: ",o&&new Date(o.expires_at).toLocaleString()]})})]}),e.jsx(pe,{children:e.jsx(N,{onClick:O,children:"Done"})})]})}),e.jsx(js,{open:!!h,onOpenChange:()=>g(null),children:e.jsxs(We,{children:[e.jsxs(Ze,{children:[e.jsx(Xe,{children:"Revoke Invitation Code"}),e.jsx(Ye,{children:"Are you sure you want to revoke this invitation code? It will no longer be usable for registration."})]}),e.jsxs(Je,{children:[e.jsx(ss,{children:"Cancel"}),e.jsxs(es,{onClick:()=>h&&k.mutate(h.id),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:[k.isPending&&e.jsx(W,{className:"mr-2 h-4 w-4 animate-spin"}),"Revoke"]})]})]})})]})}function Sr({user:s,isConnected:t=!0,lastRefreshed:a,fetchTimeMs:n}){const{logout:i}=qs(),{theme:l,toggleTheme:c}=ar(),[h,g]=r.useState(!1),[o,d]=r.useState(!1),[p,j]=r.useState(!1),[w,v]=r.useState(!1),y=()=>{v(!0),window.location.reload()},S=()=>{window.open("/dashboard/playground.html","_blank")};return e.jsxs(e.Fragment,{children:[e.jsx("header",{className:"sticky top-0 z-40 border-b border-border/50 bg-background/80 backdrop-blur-xl",children:e.jsxs("div",{className:"mx-auto flex h-16 max-w-[1600px] items-center justify-between px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-lg bg-primary/10 glow-sm",children:e.jsx(Fs,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-display text-lg font-semibold tracking-tight",children:"LLM Load Balancer"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Dashboard"})]})]}),e.jsxs("div",{className:"hidden md:flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{id:"connection-status",className:"flex items-center gap-1.5",children:[e.jsx("span",{className:`h-2 w-2 rounded-full ${t?"bg-green-500":"bg-red-500"}`}),"Connection: ",t?"Online":"Offline"]}),a&&e.jsxs("span",{id:"last-refreshed",children:["Last updated: ",a.toLocaleTimeString()]}),!a&&e.jsx("span",{id:"last-refreshed",children:"Last updated: --:--:--"}),n!=null&&e.jsxs("span",{id:"refresh-metrics",children:["Fetch time: ",n,"ms"]}),n==null&&e.jsx("span",{id:"refresh-metrics",children:"Fetch time: --ms"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(N,{id:"chat-open",variant:"outline",size:"sm",onClick:S,className:"hidden sm:inline-flex",children:[e.jsx(ds,{className:"mr-2 h-4 w-4"}),"Playground"]}),e.jsxs(N,{id:"api-keys-button",variant:"outline",size:"sm",onClick:()=>g(!0),className:"hidden sm:inline-flex",children:[e.jsx(xs,{className:"mr-2 h-4 w-4"}),"API Keys"]}),e.jsx(N,{id:"refresh-button",variant:"ghost",size:"icon",onClick:y,disabled:w,children:e.jsx(Ce,{className:`h-4 w-4 ${w?"animate-spin":""}`})}),e.jsx(N,{id:"theme-toggle",variant:"ghost",size:"icon",onClick:c,children:l==="dark"?e.jsx(ya,{className:"h-4 w-4"}):e.jsx(Na,{className:"h-4 w-4"})}),e.jsxs(ba,{children:[e.jsx(wa,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"icon",className:"relative",children:e.jsx(st,{className:"h-4 w-4"})})}),e.jsxs(Ca,{align:"end",className:"w-56",children:[e.jsx(ka,{children:e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:s==null?void 0:s.username}),e.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:s==null?void 0:s.role})]})}),e.jsx(_s,{}),e.jsxs(Ue,{onClick:S,className:"sm:hidden",children:[e.jsx(ds,{className:"mr-2 h-4 w-4"}),"Playground"]}),e.jsxs(Ue,{onClick:()=>g(!0),className:"sm:hidden",children:[e.jsx(xs,{className:"mr-2 h-4 w-4"}),"API Keys"]}),e.jsx(_s,{className:"sm:hidden"}),(s==null?void 0:s.role)==="admin"&&e.jsxs(e.Fragment,{children:[e.jsxs(Ue,{onClick:()=>d(!0),children:[e.jsx(Ds,{className:"mr-2 h-4 w-4"}),"Manage Users"]}),e.jsxs(Ue,{onClick:()=>j(!0),children:[e.jsx(Es,{className:"mr-2 h-4 w-4"}),"Invitation Codes"]}),e.jsx(_s,{})]}),e.jsxs(Ue,{onClick:i,className:"text-destructive",children:[e.jsx(Va,{className:"mr-2 h-4 w-4"}),"Sign out"]})]})]})]})]})}),e.jsx(wr,{open:h,onOpenChange:g}),e.jsx(Cr,{open:o,onOpenChange:d}),e.jsx(kr,{open:p,onOpenChange:j})]})}const Vs={primary:"bg-primary/10 group-hover:bg-primary/20","chart-1":"bg-chart-1/10 group-hover:bg-chart-1/20","chart-2":"bg-chart-2/10 group-hover:bg-chart-2/20","chart-3":"bg-chart-3/10 group-hover:bg-chart-3/20","chart-4":"bg-chart-4/10 group-hover:bg-chart-4/20","chart-5":"bg-chart-5/10 group-hover:bg-chart-5/20",success:"bg-success/10 group-hover:bg-success/20",warning:"bg-warning/10 group-hover:bg-warning/20",destructive:"bg-destructive/10 group-hover:bg-destructive/20"};function _r({title:s,value:t,subtitle:a,icon:n,accentColor:i="primary",isLoading:l,delay:c=0,dataStat:h}){return e.jsx(ae,{className:"stat-card group overflow-hidden animate-fade-up",style:{animationDelay:`${c}ms`},"data-stat":h,children:e.jsx(re,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:s}),l?e.jsx("div",{className:"h-8 w-24 shimmer rounded"}):e.jsx("p",{className:"text-3xl font-bold tracking-tight",children:t}),a&&!l&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a})]}),e.jsx("div",{className:`flex h-10 w-10 items-center justify-center rounded-lg transition-colors ${Vs[i]||Vs.primary}`,children:n})]})})})}function Ar({stats:s,isLoading:t}){const a=[{title:"Total Nodes",value:s?U(s.total_nodes):"—",subtitle:s?`${s.online_nodes} online, ${s.pending_nodes} pending, ${s.registering_nodes} registering, ${s.offline_nodes} offline`:void 0,icon:e.jsx(Ge,{className:"h-5 w-5 text-primary"}),accentColor:"primary",dataStat:"total-nodes"},{title:"Total Requests",value:s?U(s.total_requests):"—",subtitle:s?`${U(s.successful_requests)} successful`:void 0,icon:e.jsx(La,{className:"h-5 w-5 text-chart-2"}),accentColor:"chart-2",dataStat:"total-requests"},{title:"Total Tokens",value:s?U(s.total_tokens):"—",subtitle:s?`In: ${U(s.total_input_tokens)} / Out: ${U(s.total_output_tokens)}`:void 0,icon:e.jsx(ds,{className:"h-5 w-5 text-chart-5"}),accentColor:"chart-5",dataStat:"total-tokens"},{title:"Active Requests",value:s?U(s.total_active_requests):"—",icon:e.jsx(Fs,{className:"h-5 w-5 text-chart-1"}),accentColor:"chart-1",dataStat:"active-requests"},{title:"Queued Requests",value:s?U(s.queued_requests):"—",icon:e.jsx(Ba,{className:"h-5 w-5 text-chart-5"}),accentColor:"chart-5",dataStat:"queued-requests"},{title:"Success Rate",value:s&&s.total_requests>0?Ss(s.successful_requests/s.total_requests*100):"—",subtitle:s?`${U(s.failed_requests)} failed`:void 0,icon:s&&s.failed_requests>0?e.jsx(us,{className:"h-5 w-5 text-destructive"}):e.jsx(hs,{className:"h-5 w-5 text-success"}),accentColor:s&&s.failed_requests>0?"destructive":"success",dataStat:"success-rate"},{title:"Avg Response Time",value:s?Ms(s.average_response_time_ms):"—",icon:e.jsx(Be,{className:"h-5 w-5 text-warning"}),accentColor:"warning",dataStat:"average-response-time-ms"},{title:"Avg GPU Usage",value:s?Ss(s.average_gpu_usage):"—",icon:e.jsx(er,{className:"h-5 w-5 text-chart-3"}),accentColor:"chart-3",dataStat:"average-gpu-usage"},{title:"Avg GPU Memory",value:s?Ss(s.average_gpu_memory_usage):"—",icon:e.jsx(ht,{className:"h-5 w-5 text-chart-4"}),accentColor:"chart-4",dataStat:"average-gpu-memory-usage"}];return e.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6",children:a.map((n,i)=>e.jsx(_r,{...n,isLoading:t,delay:i*50},n.title))})}function Rr(s){switch(s){case"online":return"default";case"pending":return"secondary";case"offline":return"outline";case"error":return"destructive";default:return"outline"}}function Mr(s){switch(s){case"online":return"Online";case"pending":return"Pending";case"offline":return"Offline";case"error":return"Error";default:return s}}function Er({endpoint:s,open:t,onOpenChange:a}){var S,k;const n=ge(),[i,l]=r.useState((s==null?void 0:s.name)||""),[c,h]=r.useState((s==null?void 0:s.notes)||""),[g,o]=r.useState(((S=s==null?void 0:s.health_check_interval_secs)==null?void 0:S.toString())||"30"),[d,p]=r.useState(((k=s==null?void 0:s.inference_timeout_secs)==null?void 0:k.toString())||"120"),j=Q({mutationFn:x=>be.update(s.id,x),onSuccess:()=>{n.invalidateQueries({queryKey:["dashboard-endpoints"]}),A({title:"Update Complete",description:"Endpoint settings updated"})},onError:x=>{A({title:"Update Failed",description:String(x),variant:"destructive"})}}),w=Q({mutationFn:()=>be.test(s.id),onSuccess:x=>{n.invalidateQueries({queryKey:["dashboard-endpoints"]}),A({title:x.success?"Connection Successful":"Connection Failed",description:x.message||(x.latency_ms?`Latency: ${x.latency_ms}ms`:""),variant:x.success?"default":"destructive"})},onError:x=>{A({title:"Connection Test Failed",description:String(x),variant:"destructive"})}}),v=Q({mutationFn:()=>be.sync(s.id),onSuccess:x=>{n.invalidateQueries({queryKey:["dashboard-endpoints"]}),A({title:"Sync Complete",description:`Synced ${x.synced_models} models`})},onError:x=>{A({title:"Sync Failed",description:String(x),variant:"destructive"})}}),y=()=>{j.mutate({name:i!==(s==null?void 0:s.name)?i:void 0,notes:c!==(s==null?void 0:s.notes)?c:void 0,health_check_interval_secs:parseInt(g)!==(s==null?void 0:s.health_check_interval_secs)?parseInt(g):void 0,inference_timeout_secs:parseInt(d)!==(s==null?void 0:s.inference_timeout_secs)?parseInt(d):void 0})};return s?e.jsx(Z,{open:t,onOpenChange:a,children:e.jsxs(J,{className:"max-w-2xl",children:[e.jsxs(X,{children:[e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"h-5 w-5"}),s.name]}),e.jsx(ee,{children:s.base_url})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(_,{variant:Rr(s.status),children:Mr(s.status)}),s.supports_responses_api&&e.jsx(_,{variant:"outline",children:"Responses API"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Models: ",s.model_count]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(N,{variant:"outline",size:"sm",onClick:()=>w.mutate(),disabled:w.isPending,children:[e.jsx(ut,{className:"h-4 w-4 mr-1"}),"Test Connection"]}),e.jsxs(N,{variant:"outline",size:"sm",onClick:()=>v.mutate(),disabled:v.isPending||s.status!=="online",children:[e.jsx(Ce,{className:`h-4 w-4 mr-1 ${v.isPending?"animate-spin":""}`}),"Sync Models"]})]})]}),e.jsx(Gs,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Latency:"}),e.jsx("span",{className:"ml-2",children:s.latency_ms!=null?`${s.latency_ms}ms`:"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Registered:"}),e.jsx("span",{className:"ml-2",children:me(s.registered_at)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Last Seen:"}),e.jsx("span",{className:"ml-2",children:s.last_seen?me(s.last_seen):"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Error Count:"}),e.jsx("span",{className:"ml-2",children:s.error_count})]})]}),s.last_error&&e.jsxs("div",{className:"bg-destructive/10 border border-destructive/20 rounded-md p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-destructive",children:[e.jsx(ot,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Last Error"})]}),e.jsx("p",{className:"text-sm text-destructive/80 mt-1",children:s.last_error})]}),e.jsx(Gs,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"name",children:"Display Name"}),e.jsx(L,{id:"name",value:i,onChange:x=>l(x.target.value),placeholder:"Endpoint name"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(F,{htmlFor:"healthCheckInterval",children:[e.jsx(Be,{className:"h-4 w-4 inline mr-1"}),"Health Check Interval (sec)"]}),e.jsx(L,{id:"healthCheckInterval",type:"number",min:"5",max:"3600",value:g,onChange:x=>o(x.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(F,{htmlFor:"inferenceTimeout",children:[e.jsx(Be,{className:"h-4 w-4 inline mr-1"}),"Inference Timeout (sec)"]}),e.jsx(L,{id:"inferenceTimeout",type:"number",min:"10",max:"600",value:d,onChange:x=>p(x.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"notes",children:"Notes"}),e.jsx(Sa,{id:"notes",value:c,onChange:x=>h(x.target.value),placeholder:"Notes about this endpoint...",rows:3})]})]})]}),e.jsxs(pe,{children:[e.jsx(N,{variant:"outline",onClick:()=>a(!1),children:"Close"}),e.jsxs(N,{onClick:y,disabled:j.isPending,children:[e.jsx(Qa,{className:"h-4 w-4 mr-1"}),j.isPending?"Saving...":"Save"]})]})]})}):null}const ze=10;function Tr(s){switch(s){case"online":return"default";case"pending":return"secondary";case"offline":return"outline";case"error":return"destructive";default:return"outline"}}function Dr(s){switch(s){case"online":return"Online";case"pending":return"Pending";case"offline":return"Offline";case"error":return"Error";default:return s}}function Ir({endpoints:s,isLoading:t}){const a=ge(),[n,i]=r.useState(""),[l,c]=r.useState("all"),[h,g]=r.useState("status"),[o,d]=r.useState("desc"),[p,j]=r.useState(1),[w,v]=r.useState(null),[y,S]=r.useState(null),[k,x]=r.useState(!1),[R,O]=r.useState(null),[K,z]=r.useState(null),[b,G]=r.useState(!1),[C,te]=r.useState(!1),[le,ce]=r.useState(null),[f,q]=r.useState({name:"",base_url:"",api_key:"",notes:""}),u=async()=>{if(!(!f.name||!f.base_url)){te(!0),ce(null);try{await be.create({name:f.name,base_url:f.base_url,api_key:f.api_key||void 0,notes:f.notes||void 0}),await a.invalidateQueries({queryKey:["dashboard-endpoints"]}),G(!1),q({name:"",base_url:"",api_key:"",notes:""})}catch(m){console.error("Failed to create endpoint:",m),ce(m instanceof Error?m.message:"Failed to create endpoint")}finally{te(!1)}}},$=async()=>{if(y){x(!0);try{await be.delete(y.id),await a.invalidateQueries({queryKey:["dashboard-endpoints"]})}catch(m){console.error("Failed to delete endpoint:",m)}finally{x(!1),S(null)}}},Us=async m=>{O(m.id);try{await be.test(m.id),await a.invalidateQueries({queryKey:["dashboard-endpoints"]})}catch(ne){console.error("Failed to test endpoint:",ne)}finally{O(null)}},ys=async m=>{z(m.id);try{await be.sync(m.id),await a.invalidateQueries({queryKey:["dashboard-endpoints"]})}catch(ne){console.error("Failed to sync endpoint:",ne)}finally{z(null)}},Ns=r.useMemo(()=>s.filter(m=>{const ne=m.name.toLowerCase().includes(n.toLowerCase())||m.base_url.toLowerCase().includes(n.toLowerCase()),oe=l==="all"||m.status===l;return ne&&oe}),[s,n,l]),Ke=r.useMemo(()=>[...Ns].sort((m,ne)=>{let oe=0;switch(h){case"name":oe=m.name.localeCompare(ne.name);break;case"status":{const $s={online:0,pending:1,offline:2,error:3};oe=$s[m.status]-$s[ne.status];break}case"latency_ms":oe=(m.latency_ms??1/0)-(ne.latency_ms??1/0);break;case"model_count":oe=m.model_count-ne.model_count;break;case"registered_at":oe=new Date(m.registered_at).getTime()-new Date(ne.registered_at).getTime();break}return o==="asc"?oe:-oe}),[Ns,h,o]),zs=r.useMemo(()=>{const m=(p-1)*ze;return Ke.slice(m,m+ze)},[Ke,p]),as=Math.ceil(Ke.length/ze),rs=m=>{h===m?d(o==="asc"?"desc":"asc"):(g(m),d("desc"))},ns=({field:m})=>h!==m?null:o==="asc"?e.jsx(_a,{className:"ml-1 h-4 w-4 inline"}):e.jsx(Aa,{className:"ml-1 h-4 w-4 inline"});return t&&s.length===0?e.jsxs(ae,{children:[e.jsx(ye,{children:e.jsxs(Ne,{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"h-5 w-5"}),"Endpoints"]})}),e.jsx(re,{children:e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(ae,{children:[e.jsx(ye,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Ne,{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"h-5 w-5"}),"Endpoints",e.jsx(_,{variant:"secondary",className:"ml-2",children:Ns.length})]}),e.jsxs(N,{onClick:()=>G(!0),children:[e.jsx(Ve,{className:"h-4 w-4 mr-2"}),"Add Endpoint"]})]})}),e.jsxs(re,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ps,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(L,{placeholder:"Search by name or URL...",value:n,onChange:m=>{i(m.target.value),j(1)},className:"pl-10"})]}),e.jsxs(De,{value:l,onValueChange:m=>{c(m),j(1)},children:[e.jsx(Ie,{className:"w-[180px]",children:e.jsx(Fe,{placeholder:"Status"})}),e.jsxs(qe,{children:[e.jsx(P,{value:"all",children:"All"}),e.jsx(P,{value:"online",children:"Online"}),e.jsx(P,{value:"pending",children:"Pending"}),e.jsx(P,{value:"offline",children:"Offline"}),e.jsx(P,{value:"error",children:"Error"})]})]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(Pe,{children:[e.jsx(Le,{children:e.jsxs(se,{children:[e.jsxs(T,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>rs("name"),children:["Name",e.jsx(ns,{field:"name"})]}),e.jsx(T,{children:"URL"}),e.jsxs(T,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>rs("status"),children:["Status",e.jsx(ns,{field:"status"})]}),e.jsxs(T,{className:"cursor-pointer hover:bg-muted/50 text-right",onClick:()=>rs("latency_ms"),children:["Latency",e.jsx(ns,{field:"latency_ms"})]}),e.jsxs(T,{className:"cursor-pointer hover:bg-muted/50 text-right",onClick:()=>rs("model_count"),children:["Models",e.jsx(ns,{field:"model_count"})]}),e.jsx(T,{children:"Last Seen"}),e.jsx(T,{className:"text-right",children:"Actions"})]})}),e.jsx(Oe,{children:zs.length===0?e.jsx(se,{children:e.jsx(E,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:n||l!=="all"?"No endpoints match the filter criteria":"No endpoints registered"})}):zs.map(m=>e.jsxs(se,{children:[e.jsx(E,{className:"font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:m.name}),m.supports_responses_api&&e.jsx(_,{variant:"outline",className:"text-xs",children:"Responses API"})]})}),e.jsx(E,{children:e.jsx("span",{className:"text-muted-foreground font-mono text-sm",children:m.base_url})}),e.jsxs(E,{children:[e.jsx(_,{variant:Tr(m.status),children:Dr(m.status)}),m.last_error&&e.jsxs("span",{className:"ml-2 text-xs text-destructive",children:["(",m.error_count," errors)"]})]}),e.jsx(E,{className:"text-right",children:m.latency_ms!=null?`${m.latency_ms}ms`:"-"}),e.jsx(E,{className:"text-right",children:m.model_count}),e.jsx(E,{children:m.last_seen?me(m.last_seen):"-"}),e.jsx(E,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(N,{variant:"ghost",size:"icon",onClick:()=>v(m),title:"Details",children:e.jsx(Ga,{className:"h-4 w-4"})}),e.jsx(N,{variant:"ghost",size:"icon",onClick:()=>Us(m),disabled:R===m.id,title:"Test Connection",children:e.jsx(ut,{className:D("h-4 w-4",R===m.id&&"animate-pulse")})}),e.jsx(N,{variant:"ghost",size:"icon",onClick:()=>ys(m),disabled:K===m.id||m.status!=="online",title:"Sync Models",children:e.jsx(Ce,{className:D("h-4 w-4",K===m.id&&"animate-spin")})}),e.jsx(N,{variant:"ghost",size:"icon",onClick:()=>S(m),title:"Delete",children:e.jsx(Qe,{className:"h-4 w-4 text-destructive"})})]})})]},m.id))})]})}),as>1&&e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",(p-1)*ze+1," -"," ",Math.min(p*ze,Ke.length)," of ",Ke.length]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{variant:"outline",size:"sm",onClick:()=>j(m=>Math.max(1,m-1)),disabled:p===1,children:e.jsx(ct,{className:"h-4 w-4"})}),e.jsxs("span",{className:"text-sm",children:[p," / ",as]}),e.jsx(N,{variant:"outline",size:"sm",onClick:()=>j(m=>Math.min(as,m+1)),disabled:p===as,children:e.jsx(nt,{className:"h-4 w-4"})})]})]})]})]}),w&&e.jsx(Er,{endpoint:w,open:!!w,onOpenChange:m=>!m&&v(null)}),e.jsx(js,{open:!!y,onOpenChange:m=>!m&&S(null),children:e.jsxs(We,{children:[e.jsxs(Ze,{children:[e.jsx(Xe,{children:"Delete Endpoint?"}),e.jsxs(Ye,{children:['This will delete "',y==null?void 0:y.name,'". This action cannot be undone. Models associated with this endpoint will no longer be available.']})]}),e.jsxs(Je,{children:[e.jsx(ss,{disabled:k,children:"Cancel"}),e.jsx(es,{onClick:$,disabled:k,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:k?"Deleting...":"Delete"})]})]})}),e.jsx(Z,{open:b,onOpenChange:m=>{m||(ce(null),q({name:"",base_url:"",api_key:"",notes:""})),G(m)},children:e.jsxs(J,{className:"sm:max-w-[500px]",children:[e.jsxs(X,{children:[e.jsx(Y,{children:"Add New Endpoint"}),e.jsx(ee,{children:"Register a new inference service endpoint (Ollama, vLLM, etc.)"})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(F,{htmlFor:"endpoint-name",children:"Name *"}),e.jsx(L,{id:"endpoint-name",placeholder:"e.g., Production Ollama",value:f.name,onChange:m=>q({...f,name:m.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(F,{htmlFor:"endpoint-url",children:"Base URL *"}),e.jsx(L,{id:"endpoint-url",placeholder:"e.g., http://localhost:11434",value:f.base_url,onChange:m=>q({...f,base_url:m.target.value})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"The base URL of the OpenAI-compatible API endpoint"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(F,{htmlFor:"endpoint-api-key",children:"API Key (optional)"}),e.jsx(L,{id:"endpoint-api-key",type:"password",placeholder:"sk-...",value:f.api_key,onChange:m=>q({...f,api_key:m.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(F,{htmlFor:"endpoint-notes",children:"Notes (optional)"}),e.jsx(L,{id:"endpoint-notes",placeholder:"Description or notes about this endpoint",value:f.notes,onChange:m=>q({...f,notes:m.target.value})})]}),le&&e.jsx("p",{className:"text-sm text-destructive",children:le})]}),e.jsxs(pe,{children:[e.jsx(N,{variant:"outline",onClick:()=>G(!1),disabled:C,children:"Cancel"}),e.jsx(N,{onClick:u,disabled:C||!f.name||!f.base_url,children:C?"Creating...":"Create Endpoint"})]})]})})]})}var fs="Tabs",[Fr]=Is(fs,[it]),Kt=it(),[qr,Ks]=Fr(fs),Ut=r.forwardRef((s,t)=>{const{__scopeTabs:a,value:n,onValueChange:i,defaultValue:l,orientation:c="horizontal",dir:h,activationMode:g="automatic",...o}=s,d=Ea(h),[p,j]=Ys({prop:n,onChange:i,defaultProp:l??"",caller:fs});return e.jsx(qr,{scope:a,baseId:Ta(),value:p,onValueChange:j,orientation:c,dir:d,activationMode:g,children:e.jsx(we.div,{dir:d,"data-orientation":c,...o,ref:t})})});Ut.displayName=fs;var zt="TabsList",$t=r.forwardRef((s,t)=>{const{__scopeTabs:a,loop:n=!0,...i}=s,l=Ks(zt,a),c=Kt(a);return e.jsx(Ra,{asChild:!0,...c,orientation:l.orientation,dir:l.dir,loop:n,children:e.jsx(we.div,{role:"tablist","aria-orientation":l.orientation,...i,ref:t})})});$t.displayName=zt;var Ht="TabsTrigger",Bt=r.forwardRef((s,t)=>{const{__scopeTabs:a,value:n,disabled:i=!1,...l}=s,c=Ks(Ht,a),h=Kt(a),g=Qt(c.baseId,n),o=Wt(c.baseId,n),d=n===c.value;return e.jsx(Ma,{asChild:!0,...h,focusable:!i,active:d,children:e.jsx(we.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":o,"data-state":d?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:g,...l,ref:t,onMouseDown:Re(s.onMouseDown,p=>{!i&&p.button===0&&p.ctrlKey===!1?c.onValueChange(n):p.preventDefault()}),onKeyDown:Re(s.onKeyDown,p=>{[" ","Enter"].includes(p.key)&&c.onValueChange(n)}),onFocus:Re(s.onFocus,()=>{const p=c.activationMode!=="manual";!d&&!i&&p&&c.onValueChange(n)})})})});Bt.displayName=Ht;var Gt="TabsContent",Vt=r.forwardRef((s,t)=>{const{__scopeTabs:a,value:n,forceMount:i,children:l,...c}=s,h=Ks(Gt,a),g=Qt(h.baseId,n),o=Wt(h.baseId,n),d=n===h.value,p=r.useRef(d);return r.useEffect(()=>{const j=requestAnimationFrame(()=>p.current=!1);return()=>cancelAnimationFrame(j)},[]),e.jsx(Xs,{present:i||d,children:({present:j})=>e.jsx(we.div,{"data-state":d?"active":"inactive","data-orientation":h.orientation,role:"tabpanel","aria-labelledby":g,hidden:!j,id:o,tabIndex:0,...c,ref:t,style:{...s.style,animationDuration:p.current?"0s":void 0},children:j&&l})})});Vt.displayName=Gt;function Qt(s,t){return`${s}-trigger-${t}`}function Wt(s,t){return`${s}-content-${t}`}var Pr=Ut,Zt=$t,Jt=Bt,Xt=Vt;const vs=Pr,ts=r.forwardRef(({className:s,...t},a)=>e.jsx(Zt,{ref:a,className:D("inline-flex h-10 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",s),...t}));ts.displayName=Zt.displayName;const H=r.forwardRef(({className:s,...t},a)=>e.jsx(Jt,{ref:a,className:D("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...t}));H.displayName=Jt.displayName;const B=r.forwardRef(({className:s,...t},a)=>e.jsx(Xt,{ref:a,className:D("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...t}));B.displayName=Xt.displayName;const Lr=[25,50,100];function Or({history:s,isLoading:t}){var w;const[a,n]=r.useState(25),[i,l]=r.useState(1),[c,h]=r.useState(null),[g,o]=r.useState(null),d=Math.ceil(s.length/a),p=s.slice((i-1)*a,i*a),j=async(v,y)=>{try{await navigator.clipboard.writeText(v),o(y),setTimeout(()=>o(null),2e3),A({title:"Copied to clipboard"})}catch{A({title:"Failed to copy",variant:"destructive"})}};return t?e.jsxs(ae,{children:[e.jsx(ye,{children:e.jsxs(Ne,{className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-5 w-5"}),"Request History"]})}),e.jsx(re,{children:e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((v,y)=>e.jsx("div",{className:"h-12 shimmer rounded"},y))})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(ae,{children:[e.jsx(ye,{className:"pb-4",children:e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs(Ne,{className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-5 w-5"}),"Request History",e.jsx(_,{variant:"secondary",className:"ml-2",children:s.length})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Show"}),e.jsxs(De,{value:a.toString(),onValueChange:v=>{n(Number(v)),l(1)},children:[e.jsx(Ie,{id:"history-per-page",className:"w-20",children:e.jsx(Fe,{})}),e.jsx(qe,{children:Lr.map(v=>e.jsx(P,{value:v.toString(),children:v},v))})]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"entries"})]})]})}),e.jsxs(re,{className:"px-0",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Pe,{children:[e.jsx(Le,{children:e.jsxs(se,{children:[e.jsx(T,{children:"Time"}),e.jsx(T,{children:"Model"}),e.jsx(T,{children:"Node"}),e.jsx(T,{children:"Status"}),e.jsx(T,{children:"Duration"}),e.jsx(T,{children:"Tokens"})]})}),e.jsx(Oe,{id:"request-history-tbody",children:p.length===0?e.jsx(se,{children:e.jsx(E,{colSpan:6,className:"h-32 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2 text-muted-foreground",children:[e.jsx($e,{className:"h-8 w-8"}),e.jsx("p",{children:"No request history"})]})})}):p.map(v=>{var y,S;return e.jsxs(se,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>h(v),children:[e.jsx(E,{className:"font-mono text-xs",children:me(v.timestamp)}),e.jsx(E,{children:e.jsx(_,{variant:"secondary",children:v.model})}),e.jsx(E,{className:"text-sm",children:v.node_name||((y=v.node_id)==null?void 0:y.slice(0,8))||"—"}),e.jsx(E,{children:e.jsxs(_,{variant:v.status==="success"?"online":"destructive",className:"gap-1",children:[v.status==="success"?e.jsx(hs,{className:"h-3 w-3"}):e.jsx(us,{className:"h-3 w-3"}),v.status]})}),e.jsx(E,{children:e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(Be,{className:"h-3 w-3 text-muted-foreground"}),Ms(v.duration_ms)]})}),e.jsx(E,{className:"text-sm",children:((S=v.total_tokens)==null?void 0:S.toLocaleString())||"—"})]},v.request_id)})})]})}),d>1&&e.jsxs("div",{className:"flex items-center justify-between border-t px-6 py-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",(i-1)*a+1," to"," ",Math.min(i*a,s.length)," of ",s.length]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{id:"history-page-prev",variant:"outline",size:"sm",onClick:()=>l(v=>Math.max(1,v-1)),disabled:i===1,children:e.jsx(ct,{className:"h-4 w-4"})}),e.jsxs("span",{id:"history-page-info",className:"text-sm",children:["Page ",i," of ",d]}),e.jsx(N,{id:"history-page-next",variant:"outline",size:"sm",onClick:()=>l(v=>Math.min(d,v+1)),disabled:i===d,children:e.jsx(nt,{className:"h-4 w-4"})})]})]})]})]}),e.jsx(Z,{open:!!c,onOpenChange:()=>h(null),children:e.jsxs(J,{id:"request-modal",className:"max-w-2xl max-h-[80vh] overflow-hidden",children:[e.jsxs(X,{children:[e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-5 w-5"}),"Request Details"]}),e.jsxs(ee,{children:["Request ID: ",e.jsx("code",{className:"text-xs",children:c==null?void 0:c.request_id})]})]}),c&&e.jsxs(vs,{defaultValue:"overview",className:"mt-4",children:[e.jsxs(ts,{className:"grid w-full grid-cols-3",children:[e.jsx(H,{value:"overview",children:"Overview"}),e.jsx(H,{value:"request",children:"Request"}),e.jsx(H,{value:"response",children:"Response"})]}),e.jsxs(B,{value:"overview",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Model"}),e.jsx(_,{variant:"secondary",children:c.model})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Status"}),e.jsx(_,{variant:c.status==="success"?"online":"destructive",children:c.status})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Node"}),e.jsx("p",{className:"text-sm",children:c.node_name||c.node_id||"—"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Duration"}),e.jsx("p",{className:"text-sm",children:Ms(c.duration_ms)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Timestamp"}),e.jsx("p",{className:"text-sm",children:new Date(c.timestamp).toLocaleString()})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Tokens"}),e.jsx("p",{className:"text-sm",children:((w=c.total_tokens)==null?void 0:w.toLocaleString())||"—"})]})]}),c.error&&e.jsxs("div",{className:"rounded-lg border border-destructive/50 bg-destructive/10 p-4",children:[e.jsx("p",{className:"text-sm font-medium text-destructive",children:"Error"}),e.jsx("p",{className:"mt-1 text-sm",children:c.error})]})]}),e.jsx(B,{value:"request",className:"mt-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(N,{variant:"ghost",size:"sm",className:"absolute right-2 top-2",onClick:()=>j(JSON.stringify(c.request_body,null,2),"request"),children:g==="request"?e.jsx(xe,{className:"h-4 w-4"}):e.jsx(He,{className:"h-4 w-4"})}),e.jsx(Te,{className:"h-64 rounded-md border",children:e.jsx("pre",{className:"p-4 text-xs",children:JSON.stringify(c.request_body,null,2)||"No request body"})})]})}),e.jsx(B,{value:"response",className:"mt-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(N,{variant:"ghost",size:"sm",className:"absolute right-2 top-2",onClick:()=>j(JSON.stringify(c.response_body,null,2),"response"),children:g==="response"?e.jsx(xe,{className:"h-4 w-4"}):e.jsx(He,{className:"h-4 w-4"})}),e.jsx(Te,{className:"h-64 rounded-md border",children:e.jsx("pre",{className:"p-4 text-xs",children:JSON.stringify(c.response_body,null,2)||"No response body"})})]})})]})]})})]})}function Kr({nodes:s}){const[t,a]=r.useState("all"),[n,i]=r.useState(!0),l=r.useRef(null),{data:c,refetch:h,isRefetching:g}=ie({queryKey:["router-logs"],queryFn:()=>Me.getRouterLogs({limit:200}),refetchInterval:5e3}),o=c==null?void 0:c.entries,d=o==null?void 0:o.filter(y=>t==="all"?!0:y.level.toLowerCase()===t);r.useEffect(()=>{if(n&&l.current){const y=l.current.querySelector("[data-radix-scroll-area-viewport]");y&&(y.scrollTop=y.scrollHeight)}},[d,n]);const p=()=>{h()},j=()=>{A({title:"Log clearing is handled on the server side"})},w=()=>{if(!d||d.length===0){A({title:"No logs to download",variant:"destructive"});return}const y=d.map(R=>`[${R.timestamp}] [${R.level}] ${R.target?`[${R.target}] `:""}${R.message||""}`).join(`
`),S=new Blob([y],{type:"text/plain"}),k=URL.createObjectURL(S),x=document.createElement("a");x.href=k,x.download=`logs-router-${new Date().toISOString().slice(0,10)}.txt`,x.click(),URL.revokeObjectURL(k),A({title:"Logs downloaded"})},v=y=>{const S=y.toLowerCase();return S==="error"?"text-destructive":S==="warn"||S==="warning"?"text-warning":S==="info"?"text-primary":S==="debug"?"text-muted-foreground":"text-foreground"};return e.jsxs(ae,{children:[e.jsx(ye,{className:"pb-4",children:e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs(Ne,{className:"flex items-center gap-2",children:[e.jsx(dt,{className:"h-5 w-5"}),"Log Viewer",d&&e.jsx(_,{variant:"secondary",className:"ml-2",children:d.length})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 border rounded-md bg-muted/30",children:[e.jsx(Ge,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Router"})]}),e.jsxs(De,{value:t,onValueChange:y=>a(y),children:[e.jsx(Ie,{className:"w-28",children:e.jsx(Fe,{})}),e.jsxs(qe,{children:[e.jsx(P,{value:"all",children:"All"}),e.jsx(P,{value:"error",children:"Error"}),e.jsx(P,{value:"warn",children:"Warn"}),e.jsx(P,{value:"info",children:"Info"}),e.jsx(P,{value:"debug",children:"Debug"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Da,{id:"auto-scroll",checked:n,onCheckedChange:i}),e.jsx(F,{htmlFor:"auto-scroll",className:"text-sm",children:"Auto-scroll"})]})]})]})}),e.jsxs(re,{children:[e.jsxs("div",{className:"mb-4 flex gap-2",children:[e.jsxs(N,{id:"logs-router-refresh",variant:"outline",size:"sm",onClick:p,disabled:g,children:[e.jsx(Ce,{className:D("mr-2 h-4 w-4",g&&"animate-spin")}),"Refresh"]}),e.jsxs(N,{variant:"outline",size:"sm",onClick:w,children:[e.jsx(ms,{className:"mr-2 h-4 w-4"}),"Download"]}),e.jsxs(N,{variant:"outline",size:"sm",onClick:j,children:[e.jsx(Qe,{className:"mr-2 h-4 w-4"}),"Clear"]})]}),e.jsx(Te,{className:"h-96 rounded-md border bg-muted/30",ref:l,children:e.jsx("div",{id:"logs-router-list",className:"p-4 font-mono text-xs space-y-0.5",children:!d||d.length===0?e.jsx("div",{className:"flex h-32 items-center justify-center text-muted-foreground",children:"No logs available"}):d.map((y,S)=>e.jsxs("div",{className:"flex gap-2 py-0.5 hover:bg-muted/50 rounded px-1 -mx-1",children:[e.jsx("span",{className:"text-muted-foreground shrink-0",children:new Date(y.timestamp).toLocaleTimeString()}),e.jsx("span",{className:D("uppercase w-12 shrink-0 font-semibold",v(y.level)),children:y.level}),y.target&&e.jsxs("span",{className:"text-muted-foreground shrink-0",children:["[",y.target,"]"]}),e.jsx("span",{className:"break-all",children:y.message||""})]},S))})})]})]})}function Ur(){const{data:s,isLoading:t}=ie({queryKey:["token-stats-daily"],queryFn:()=>Me.getDailyTokenStats(7)}),{data:a,isLoading:n}=ie({queryKey:["token-stats-monthly"],queryFn:()=>Me.getMonthlyTokenStats(6)});return e.jsxs(ae,{children:[e.jsx(ye,{children:e.jsxs(Ne,{className:"flex items-center gap-2",children:[e.jsx(ds,{className:"h-5 w-5"}),"Token Statistics"]})}),e.jsx(re,{children:e.jsxs(vs,{defaultValue:"daily",className:"space-y-4",children:[e.jsxs(ts,{children:[e.jsxs(H,{value:"daily",className:"gap-2",children:[e.jsx(Ya,{className:"h-4 w-4"}),"Daily"]}),e.jsxs(H,{value:"monthly",className:"gap-2",children:[e.jsx(Ka,{className:"h-4 w-4"}),"Monthly"]})]}),e.jsx(B,{value:"daily",children:t?e.jsx("div",{className:"space-y-2",children:[...Array(5)].map((i,l)=>e.jsx("div",{className:"h-10 shimmer rounded"},l))}):s&&s.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-5 gap-2 text-sm font-medium text-muted-foreground border-b pb-2",children:[e.jsx("div",{children:"Date"}),e.jsx("div",{className:"text-right",children:"Requests"}),e.jsx("div",{className:"text-right",children:"Input"}),e.jsx("div",{className:"text-right",children:"Output"}),e.jsx("div",{className:"text-right",children:"Total"})]}),s.map(i=>e.jsxs("div",{className:"grid grid-cols-5 gap-2 text-sm py-2 border-b border-border/50",children:[e.jsx("div",{className:"font-medium",children:i.date}),e.jsx("div",{className:"text-right",children:U(i.request_count)}),e.jsx("div",{className:"text-right text-muted-foreground",children:U(i.total_input_tokens)}),e.jsx("div",{className:"text-right text-muted-foreground",children:U(i.total_output_tokens)}),e.jsx("div",{className:"text-right font-medium",children:U(i.total_tokens)})]},i.date))]}):e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No daily statistics available"})}),e.jsx(B,{value:"monthly",children:n?e.jsx("div",{className:"space-y-2",children:[...Array(3)].map((i,l)=>e.jsx("div",{className:"h-10 shimmer rounded"},l))}):a&&a.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-5 gap-2 text-sm font-medium text-muted-foreground border-b pb-2",children:[e.jsx("div",{children:"Month"}),e.jsx("div",{className:"text-right",children:"Requests"}),e.jsx("div",{className:"text-right",children:"Input"}),e.jsx("div",{className:"text-right",children:"Output"}),e.jsx("div",{className:"text-right",children:"Total"})]}),a.map(i=>e.jsxs("div",{className:"grid grid-cols-5 gap-2 text-sm py-2 border-b border-border/50",children:[e.jsx("div",{className:"font-medium",children:i.month}),e.jsx("div",{className:"text-right",children:U(i.request_count)}),e.jsx("div",{className:"text-right text-muted-foreground",children:U(i.total_input_tokens)}),e.jsx("div",{className:"text-right text-muted-foreground",children:U(i.total_output_tokens)}),e.jsx("div",{className:"text-right font-medium",children:U(i.total_tokens)})]},i.month))]}):e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No monthly statistics available"})})]})})]})}function Rs(s){return s<1024?`${s} B`:s<1024*1024?`${(s/1024).toFixed(1)} KB`:s<1024*1024*1024?`${(s/(1024*1024)).toFixed(1)} MB`:`${(s/(1024*1024*1024)).toFixed(1)} GB`}function zr(s){return s?s>=1e6?`${(s/1e6).toFixed(1)}M`:s>=1e3?`${(s/1e3).toFixed(1)}K`:String(s):"—"}function $r(s,t){switch(s){case"downloading":return e.jsx(_,{variant:"secondary","data-model-status":"downloading",children:"Preparing"});case"downloaded":return e.jsxs(_,{variant:"online",className:"gap-1","data-model-status":"ready",children:[e.jsx(xe,{className:"h-3 w-3"}),"Ready"]});default:return t==="registered"?e.jsx(_,{variant:"secondary","data-model-status":"registered",children:"Registered"}):e.jsx(_,{variant:"outline","data-model-status":"available",children:"Available"})}}function Hr({model:s,onRegister:t,isRegistering:a}){var l,c;const n=s.lifecycle_status==="registered",i=s.status==="available"&&!n;return e.jsx(ae,{className:"model-card overflow-hidden transition-shadow hover:shadow-md","data-model-card":"true","data-model-id":s.id,"data-testid":"model-card",children:e.jsxs(re,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0 space-y-1",children:[e.jsx("h4",{className:"truncate font-medium","data-model-name":s.name,children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2","data-model-description":s.description,children:s.description})]}),$r(s.status,s.lifecycle_status)]}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-x-4 gap-y-1 text-xs text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1","data-model-size":Rs(s.size_bytes),children:[e.jsx(ht,{className:"h-3 w-3"}),Rs(s.size_bytes)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Fs,{className:"h-3 w-3"}),Rs(s.required_memory_bytes)," VRAM"]}),((l=s.hf_info)==null?void 0:l.downloads)&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ms,{className:"h-3 w-3"}),zr(s.hf_info.downloads)]}),((c=s.hf_info)==null?void 0:c.likes)&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Xa,{className:"h-3 w-3"}),s.hf_info.likes]})]}),s.tags.length>0&&e.jsx("div",{className:"mt-3 flex flex-wrap gap-1",children:s.tags.map(h=>e.jsx(_,{variant:"outline",className:"text-xs",children:h},h))}),e.jsxs("div",{className:"mt-4",children:[i&&e.jsxs(N,{size:"sm",onClick:()=>t(s),disabled:a,className:"w-full",children:[a?e.jsx(W,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(ms,{className:"mr-2 h-4 w-4"}),"Register"]}),s.status==="downloaded"&&e.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-muted-foreground",children:[e.jsx(xe,{className:"h-4 w-4 text-green-500"}),"Ready to use"]}),n&&s.status!=="downloaded"&&e.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-muted-foreground",children:[e.jsx(xe,{className:"h-4 w-4 text-green-500"}),"Registered"]})]})]})})}function Br(){const s=ge(),[t,a]=r.useState(""),[n,i]=r.useState(null),{data:l,isLoading:c}=ie({queryKey:["models-hub"],queryFn:Ae.getHub,refetchInterval:5e3}),h=Q({mutationFn:o=>(i(o.id),Ae.register({repo:o.repo,filename:o.recommended_filename})),onSuccess:(o,d)=>{s.invalidateQueries({queryKey:["models-hub"]}),s.invalidateQueries({queryKey:["registered-models"]}),A({title:`Model ${d.name} registered`}),i(null)},onError:(o,d)=>{A({title:`Failed to register ${d.name}`,description:o instanceof Error?o.message:"Unknown error",variant:"destructive"}),i(null)}}),g=l==null?void 0:l.filter(o=>o.name.toLowerCase().includes(t.toLowerCase())||o.description.toLowerCase().includes(t.toLowerCase())||o.tags.some(d=>d.toLowerCase().includes(t.toLowerCase())));return c?e.jsx("div",{className:"space-y-4",children:[...Array(6)].map((o,d)=>e.jsx("div",{className:"h-40 shimmer rounded"},d))}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ps,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(L,{id:"hub-search",placeholder:"Search models...",value:t,onChange:o=>a(o.target.value),className:"pl-9"})]}),e.jsx("div",{id:"hub-models-list",children:!g||g.length===0?e.jsxs("div",{className:"flex h-32 flex-col items-center justify-center gap-2 text-muted-foreground",children:[e.jsx(ms,{className:"h-8 w-8"}),e.jsx("p",{children:"No models found"})]}):e.jsx("div",{className:D("grid gap-4 sm:grid-cols-2 lg:grid-cols-3"),children:g.map(o=>e.jsx(Hr,{model:o,onRegister:d=>h.mutate(d),isRegistering:n===o.id},o.id))})})]})}function Qs(s){return s==null||Number.isNaN(s)?"—":`${s.toFixed(1)} GB`}function Gr(s){return s==null||Number.isNaN(s)?"—":`${(s/(1024*1024*1024)).toFixed(1)} GB`}function Vr(s,t){if(t)return e.jsx(_,{variant:"online",children:"Ready"});switch(s){case"registered":return e.jsx(_,{variant:"online",children:"Registered"});case"pending":return e.jsx(_,{variant:"outline",children:"Pending"});case"error":return e.jsx(_,{variant:"destructive",children:"Error"});default:return e.jsx(_,{variant:"outline",children:s})}}const Ws={openai:{name:"OpenAI",color:"text-green-600"},anthropic:{name:"Anthropic",color:"text-orange-600"},google:{name:"Google",color:"text-blue-600"}};function Qr(){const s=ge(),[t,a]=r.useState(""),[n,i]=r.useState(!1),[l,c]=r.useState(""),[h,g]=r.useState(""),[o,d]=r.useState(""),[p,j]=r.useState(!1),[w,v]=r.useState(""),[y,S]=r.useState([]);function k(){c(""),g(""),d(""),j(!1),v(""),S([])}const{data:x,isLoading:R}=ie({queryKey:["registered-models"],queryFn:Ae.getRegistered,refetchInterval:1e4}),O=Q({mutationFn:u=>Ae.register(u),onSuccess:()=>{s.invalidateQueries({queryKey:["registered-models"]}),A({title:"Model registered"}),i(!1),k()},onError:u=>{A({title:"Failed to register model",description:u instanceof Error?u.message:"Unknown error",variant:"destructive"})}}),K=Q({mutationFn:u=>Ae.discoverGguf(u),onSuccess:u=>{v(u.base_model),S(u.gguf_alternatives),j(!0)},onError:u=>{A({title:"Failed to discover GGUF alternatives",description:u instanceof Error?u.message:"Unknown error",variant:"destructive"})}}),z=Q({mutationFn:u=>Ae.delete(u),onSuccess:()=>{s.invalidateQueries({queryKey:["registered-models"]}),s.invalidateQueries({queryKey:["models-hub"]}),A({title:"Model deleted"})},onError:u=>{A({title:"Failed to delete model",description:u instanceof Error?u.message:"Unknown error",variant:"destructive"})}}),b=x,G=b==null?void 0:b.filter(u=>u.owned_by==="router"||!u.owned_by),C=b==null?void 0:b.filter(u=>u.owned_by==="openai"),te=b==null?void 0:b.filter(u=>u.owned_by==="anthropic"),le=b==null?void 0:b.filter(u=>u.owned_by==="google"),ce=G==null?void 0:G.filter(u=>u.name.toLowerCase().includes(t.toLowerCase())),f=u=>e.jsx(ae,{className:"overflow-hidden",children:e.jsxs(re,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0 space-y-1",children:[e.jsx("h4",{className:"truncate font-medium",children:u.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:u.owned_by||"cloud"})]}),e.jsx(_,{variant:"online",children:"Ready"})]}),u.description&&e.jsx("p",{className:"mt-2 text-sm text-muted-foreground line-clamp-2",children:u.description})]})},u.name),q=(u,$)=>R?e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((Us,ys)=>e.jsx("div",{className:"h-24 shimmer rounded"},ys))}):!u||u.length===0?e.jsxs("div",{className:"flex h-32 flex-col items-center justify-center gap-2 text-muted-foreground",children:[e.jsx(ls,{className:"h-8 w-8"}),e.jsxs("p",{children:["No ",Ws[$].name," models available"]}),e.jsxs("p",{className:"text-sm",children:["Configure ",Ws[$].name," API key to access models"]})]}):e.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:u.map(f)});return e.jsxs(e.Fragment,{children:[e.jsxs(ae,{children:[e.jsx(ye,{children:e.jsxs(Ne,{className:"flex items-center gap-2",children:[e.jsx(os,{className:"h-5 w-5"}),"Models"]})}),e.jsx(re,{children:e.jsxs(vs,{defaultValue:"local",className:"space-y-4",children:[e.jsxs(ts,{className:"flex-wrap",children:[e.jsxs(H,{value:"local",className:"gap-2",children:[e.jsx(os,{className:"h-4 w-4"}),"Local",G&&e.jsx(_,{variant:"secondary",className:"ml-1",children:G.length})]}),e.jsxs(H,{value:"hub",className:"gap-2",children:[e.jsx(Ja,{className:"h-4 w-4"}),"Model Hub"]}),C&&C.length>0&&e.jsxs(H,{value:"openai",className:"gap-2",children:[e.jsx(ls,{className:"h-4 w-4 text-green-600"}),"OpenAI",e.jsx(_,{variant:"secondary",className:"ml-1",children:C.length})]}),te&&te.length>0&&e.jsxs(H,{value:"anthropic",className:"gap-2",children:[e.jsx(ls,{className:"h-4 w-4 text-orange-600"}),"Anthropic",e.jsx(_,{variant:"secondary",className:"ml-1",children:te.length})]}),le&&le.length>0&&e.jsxs(H,{value:"google",className:"gap-2",children:[e.jsx(ls,{className:"h-4 w-4 text-blue-600"}),"Google",e.jsx(_,{variant:"secondary",className:"ml-1",children:le.length})]})]}),e.jsxs(B,{value:"local",className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ps,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(L,{placeholder:"Search local models...",value:t,onChange:u=>a(u.target.value),className:"pl-9"})]}),e.jsxs(N,{id:"register-model",variant:"outline",onClick:()=>i(!0),children:[e.jsx(Ve,{className:"mr-2 h-4 w-4"}),"Register"]})]}),R?e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((u,$)=>e.jsx("div",{className:"h-24 shimmer rounded"},$))}):!ce||ce.length===0?e.jsxs("div",{className:"flex h-32 flex-col items-center justify-center gap-2 text-muted-foreground",children:[e.jsx(os,{className:"h-8 w-8"}),e.jsx("p",{children:"No local models"}),e.jsx("p",{className:"text-sm",children:"Register from the Model Hub or add a Hugging Face repo"})]}):e.jsx("div",{id:"local-models-list",className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:ce.map(u=>e.jsx(ae,{className:"overflow-hidden",children:e.jsxs(re,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0 space-y-1",children:[e.jsx("h4",{className:"truncate font-medium",children:u.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[u.source||"local",u.repo?` • ${u.repo}`:""]})]}),Vr(u.lifecycle_status,u.ready)]}),e.jsxs("div",{className:"mt-3 space-y-1 text-sm",children:[e.jsxs("p",{className:"text-muted-foreground",children:["Size: ",Qs(u.size_gb)]}),e.jsxs("p",{className:"text-muted-foreground",children:["Required VRAM: ",Qs(u.required_memory_gb)]})]}),e.jsx("div",{className:"mt-4 flex gap-2",children:e.jsx(N,{variant:"ghost",size:"sm",onClick:()=>z.mutate(u.name),disabled:z.isPending,children:e.jsx(Qe,{className:"h-4 w-4 text-destructive"})})})]})},u.name))})]}),e.jsx(B,{value:"hub",children:e.jsx(Br,{})}),e.jsx(B,{value:"openai",className:"space-y-4",children:q(C,"openai")}),e.jsx(B,{value:"anthropic",className:"space-y-4",children:q(te,"anthropic")}),e.jsx(B,{value:"google",className:"space-y-4",children:q(le,"google")})]})})]}),e.jsx(Z,{open:n,onOpenChange:u=>{i(u),u||k()},children:e.jsxs(J,{id:"register-modal",children:[e.jsxs(X,{children:[e.jsx(Y,{children:"Register Model"}),e.jsxs(ee,{children:["Register a model from Hugging Face. If a repository contains multiple artifacts, specify the exact filename to use. Nodes download artifacts directly. Browse models at"," ",e.jsx("a",{href:"https://huggingface.co/models",target:"_blank",rel:"noopener noreferrer",className:"text-primary underline",children:"huggingface.co"})]})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"register-repo",children:"Repo"}),e.jsx(L,{id:"register-repo",placeholder:"nvidia/NVIDIA-Nemotron-3-Nano-30B-A3B-BF16",value:l,onChange:u=>c(u.target.value)})]}),e.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-md border bg-muted/30 px-3 py-2",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"If the repo you entered is a base model repo (safetensors), you can discover GGUF alternatives."}),e.jsxs(N,{id:"discover-gguf",variant:"outline",size:"sm",disabled:!l.trim()||K.isPending,onClick:()=>K.mutate(l.trim()),children:[K.isPending?e.jsx(W,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Discover"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"register-filename",children:"Filename (optional)"}),e.jsx(L,{id:"register-filename",placeholder:"model.safetensors or model.Q4_K_M.gguf",value:h,onChange:u=>g(u.target.value)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"If the repo has multiple artifacts, specify the exact filename you want the node to download."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"register-display-name",children:"Display name (optional)"}),e.jsx(L,{id:"register-display-name",placeholder:"Optional display name",value:o,onChange:u=>d(u.target.value)})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"The router stores metadata only. Nodes download model artifacts directly from Hugging Face."})]}),e.jsxs(pe,{children:[e.jsx(N,{id:"register-modal-close",variant:"outline",onClick:()=>i(!1),children:"Cancel"}),e.jsxs(N,{id:"register-submit",onClick:()=>O.mutate({repo:l.trim(),filename:h.trim()?h.trim():void 0,display_name:o.trim()?o.trim():void 0}),disabled:!l.trim()||O.isPending,children:[O.isPending?e.jsx(W,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Register"]})]})]})}),e.jsx(Z,{open:p,onOpenChange:j,children:e.jsxs(J,{id:"discover-gguf-modal",className:"max-w-3xl max-h-[80vh] overflow-hidden",children:[e.jsxs(X,{children:[e.jsx(Y,{children:"GGUF alternatives"}),e.jsxs(ee,{children:["Discover GGUF repos for ",e.jsx("code",{children:w||l||"model"})," and pick an exact file."]})]}),e.jsx("div",{className:"max-h-[60vh] space-y-3 overflow-y-auto pr-1",children:y.length===0?e.jsx("div",{className:"rounded-md border bg-muted/30 p-4 text-sm text-muted-foreground",children:"No GGUF alternatives found. Try a different search term or check Hugging Face manually."}):y.map(u=>e.jsxs(ae,{className:"border-border/50",children:[e.jsxs(ye,{className:"pb-3",children:[e.jsxs(Ne,{className:"text-base",children:[u.repo," ",u.trusted?e.jsx(_,{variant:"secondary",className:"ml-2",children:"trusted"}):null]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Provider: ",u.provider]})]}),e.jsx(re,{className:"space-y-2",children:u.files.map($=>e.jsxs("div",{className:"flex flex-col gap-2 rounded-md border bg-background px-3 py-2 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-medium",children:$.filename}),e.jsxs("div",{className:"mt-0.5 text-xs text-muted-foreground",children:[$.quantization?e.jsxs("span",{children:[$.quantization," - "]}):null,Gr($.size_bytes)]})]}),e.jsx(N,{size:"sm",variant:"outline",onClick:()=>{c(u.repo),g($.filename),j(!1),A({title:"Selected GGUF file",description:`${u.repo} - ${$.filename}`})},children:"Use"})]},`${u.repo}/${$.filename}`))})]},u.repo))}),e.jsx(pe,{children:e.jsx(N,{variant:"outline",onClick:()=>j(!1),children:"Close"})})]})})]})}function Wr(){const{user:s}=qs(),{isConnected:t}=tr(),[a,n]=r.useState(null),[i,l]=r.useState(null),c=r.useRef(null),h=t?1e4:5e3,g=r.useCallback(async()=>{c.current=performance.now();const x=await Me.getOverview(),R=performance.now();return l(Math.round(R-(c.current||R))),n(new Date),x},[]),{data:o,isLoading:d,error:p,refetch:j}=ie({queryKey:["dashboard-overview"],queryFn:g,refetchInterval:h}),{data:w,isLoading:v}=ie({queryKey:["request-responses"],queryFn:()=>Me.getRequestResponses({limit:100}),refetchInterval:h}),{data:y,isLoading:S}=ie({queryKey:["dashboard-endpoints"],queryFn:()=>Me.getEndpoints(),refetchInterval:h}),k=r.useMemo(()=>w!=null&&w.records?w.records.map(x=>({request_id:x.id,timestamp:x.timestamp,model:x.model,node_id:x.node_id,node_name:x.node_machine_name,status:x.status.type,duration_ms:x.duration_ms,error:x.status.type==="error"?x.status.message:void 0,request_body:x.request_body,response_body:x.response_body})):[],[w]);return p?e.jsx("div",{className:"flex h-screen w-full items-center justify-center bg-background",children:e.jsxs("div",{className:"flex flex-col items-center gap-4 text-center",children:[e.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-full bg-destructive/10",children:e.jsx(ot,{className:"h-8 w-8 text-destructive"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Failed to load dashboard"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:p instanceof Error?p.message:"An error occurred"})]}),e.jsx("button",{onClick:()=>j(),className:"text-sm text-primary hover:underline",children:"Try again"})]})}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"fixed inset-0 bg-grid opacity-20 pointer-events-none"}),e.jsx(Sr,{user:s,isConnected:!p,lastRefreshed:a,fetchTimeMs:i}),e.jsxs("main",{className:"relative mx-auto max-w-[1600px] px-4 py-6 sm:px-6 lg:px-8",children:[e.jsx("section",{className:"mb-8",children:e.jsx(Ar,{stats:o==null?void 0:o.stats,isLoading:d})}),e.jsxs(vs,{defaultValue:"endpoints",className:"space-y-6",children:[e.jsxs(ts,{className:"grid w-full grid-cols-5 lg:w-auto lg:inline-grid",children:[e.jsxs(H,{value:"endpoints",className:"gap-2",children:[e.jsx(Ha,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Endpoints"})]}),e.jsxs(H,{value:"models",className:"gap-2",children:[e.jsx(os,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Models"})]}),e.jsxs(H,{value:"statistics",className:"gap-2",children:[e.jsx(Ua,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Statistics"})]}),e.jsxs(H,{value:"history",className:"gap-2",children:[e.jsx($e,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"History"})]}),e.jsxs(H,{value:"logs",className:"gap-2",children:[e.jsx(dt,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Logs"})]})]}),e.jsx(B,{value:"endpoints",className:"animate-fade-in",children:e.jsx(Ir,{endpoints:y||[],isLoading:S})}),e.jsx(B,{value:"models",className:"animate-fade-in",children:e.jsx(Qr,{})}),e.jsx(B,{value:"statistics",className:"animate-fade-in",children:e.jsx(Ur,{})}),e.jsx(B,{value:"history",className:"animate-fade-in",children:e.jsx(Or,{history:k,isLoading:v})}),e.jsx(B,{value:"logs",className:"animate-fade-in",children:e.jsx(Kr,{})})]})]})]})}function Zr(){const{isLoading:s}=qs();return r.useEffect(()=>{!s&&!Js()&&(window.location.href="/dashboard/login.html")},[s]),s?e.jsx("div",{className:"flex h-screen w-full items-center justify-center bg-background",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"h-12 w-12 rounded-full border-4 border-primary/20"}),e.jsx("div",{className:"absolute inset-0 h-12 w-12 animate-spin rounded-full border-4 border-transparent border-t-primary"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading..."})]})}):e.jsx(Wr,{})}const Jr=new Ia({defaultOptions:{queries:{staleTime:5e3,refetchInterval:5e3,retry:1}}});aa.createRoot(document.getElementById("root")).render(e.jsx(r.StrictMode,{children:e.jsx(Fa,{client:Jr,children:e.jsx(Pa,{children:e.jsxs(ra,{children:[e.jsx(Zr,{}),e.jsx(na,{})]})})})}));
