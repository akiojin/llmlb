import{c,r as a,J as et,t as f,j as e,k,C as tt,B as i,U as st,X as ge,I as te,L as C,F as at,K as rt,G as nt,T as it,H as lt}from"./index--aTWbe2T.js";import{u as ot,j as fe,q as ct,v as se,M as ye,I as dt,J as mt,K as ut,Q as ht,w as pt,G as xt,H as gt,y as ft,z as yt,A as jt,E as vt,F as je,B as ve,r as wt,k as we,l as be,m as Ne,o as ke,p as Ce,_,$ as bt,a3 as Nt,x as Se,C as kt,t as Ct,a4 as St,a5 as Mt}from"./switch-WWAXcJpN.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=c("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=c("CircleDot",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=c("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=c("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=c("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=c("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=c("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pt=c("PanelLeftClose",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=c("PanelLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=c("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=c("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=c("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=c("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]);function Ae(I){switch(I){case 401:return"APIキーが無効です。設定を確認してください。";case 403:return"このリソースへのアクセス権がありません。";case 404:return"APIエンドポイントが見つかりません。";case 503:return"利用可能なノードがありません。ノードを起動してください。";case 504:return"リクエストがタイムアウトしました。";default:return`サーバーエラーが発生しました (HTTP ${I})`}}function Lt(){ot();const[I,Te]=a.useState("dark"),[De,v]=a.useState([]),[m,B]=a.useState(null),[w,p]=a.useState([]),[A,ae]=a.useState(""),[K,U]=a.useState(!1),[Re,q]=a.useState(!1),[Ee,$]=a.useState(!1),[Pe,re]=a.useState(!1),[J,Oe]=a.useState(!1),[Q,W]=a.useState("all"),[u,G]=a.useState(""),[T,_e]=a.useState(""),[z,qe]=a.useState(!0),[D,ze]=a.useState(.7),[L,Le]=a.useState(2048),[y,Fe]=a.useState(()=>{if(typeof window<"u"){const t=localStorage.getItem("llm-router-api-key");if(t)return t;if(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")return"sk_debug"}return""}),ne=a.useRef(null),R=a.useRef(null),ie=a.useRef(null),le=a.useRef(null),oe=a.useRef(null),[S,F]=a.useState([]),{data:H,error:E}=fe({queryKey:["registered-models"],queryFn:at.getRegistered,retry:!1});a.useEffect(()=>{if(E){let t="モデル一覧の取得に失敗しました";if(E instanceof et)switch(E.status){case 401:t="APIキーが無効です。設定を確認してください。";break;case 503:t="利用可能なノードがありません。ノードを起動してください。";break;case 404:t="APIエンドポイントが見つかりません。";break;default:t=E.message}f({title:"エラー",description:t,variant:"destructive"})}},[E]);const{data:X}=fe({queryKey:["chat-sessions"],queryFn:rt.getSessions});a.useEffect(()=>{X&&v(X)},[X]),a.useEffect(()=>{if(H&&!u){const s=H.filter(r=>r.lifecycle_status==="registered"||r.state==="ready");s.length>0&&G(s[0].name)}},[H,u]),a.useEffect(()=>{var t;(t=ne.current)==null||t.scrollIntoView({behavior:"smooth"})},[w]);const He=()=>{const t=I==="dark"?"light":"dark";Te(t),document.documentElement.classList.toggle("dark",t==="dark")},Ve=t=>{Fe(t),localStorage.setItem("llm-router-api-key",t)},Be=a.useCallback(()=>{const t={id:crypto.randomUUID(),title:"New Chat",messages:[],model:u,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};v(s=>[t,...s]),B(t.id),p([])},[u]),Ke=t=>{B(t.id),p(t.messages||[]),t.model&&G(t.model)},Ue=t=>{v(s=>s.filter(r=>r.id!==t)),m===t&&(B(null),p([])),f({title:"Session deleted"})},$e=()=>{p([]),F([]),m&&v(t=>t.map(s=>s.id===m?{...s,messages:[],updated_at:new Date().toISOString()}:s)),f({title:"Chat cleared"})},Y=async(t,s)=>{if(t){if(t.size>4*1024*1024){f({title:"File too large",description:"Maximum size is 4MB",variant:"destructive"});return}try{const r=new FileReader;r.onload=n=>{var P;const o=(P=n.target)==null?void 0:P.result,x={type:s,name:t.name,data:o,mimeType:t.type};F(V=>[...V,x]),f({title:`${s==="image"?"Image":"Audio"} attached`})},r.readAsDataURL(t)}catch{f({title:"Failed to read file",variant:"destructive"})}}},ce=t=>{F(s=>s.filter((r,n)=>n!==t))},Je=t=>{const s=/(data:image\/[^;]+;base64,[^\s"'<>]+|https?:\/\/[^\s"'<>]+\.(png|jpg|jpeg|gif|webp))/gi,r=/(data:audio\/[^;]+;base64,[^\s"'<>]+|https?:\/\/[^\s"'<>]+\.(mp3|wav|ogg|m4a))/gi,n=t.match(s)||[],o=t.match(r)||[];return{imageMatches:n,audioMatches:o}},Qe=()=>{Oe(t=>!t)},de=async()=>{var r,n,o,x,P,V,he,pe;if(!A.trim()&&S.length===0||!u||K)return;const t={role:"user",content:A.trim(),attachments:S.length>0?S:void 0},s=[...w,t];p(s),ae(""),F([]),m&&v(j=>j.map(b=>b.id===m?{...b,messages:s,title:s.length===1?A.trim().slice(0,30):b.title,updated_at:new Date().toISOString()}:b)),U(!0),R.current=new AbortController;try{const j=l=>{if(!l.attachments||l.attachments.length===0)return{role:l.role,content:l.content};const d=[];return l.content.trim()&&d.push({type:"text",text:l.content}),l.attachments.forEach(h=>{if(h.type==="image")d.push({type:"image_url",image_url:{url:h.data}});else if(h.type==="audio"){const M=h.data.startsWith("data:")?h.data.split(",")[1]:h.data;d.push({type:"input_audio",input_audio:{data:M,format:"wav"}})}}),{role:l.role,content:d}},b=T?[{role:"system",content:T},...s.map(j)]:s.map(j);if(z){const l={"Content-Type":"application/json"};y&&(l.Authorization=`Bearer ${y}`);const d=await fetch("/v1/chat/completions",{method:"POST",headers:l,body:JSON.stringify({model:u,messages:b,stream:!0,temperature:D,max_tokens:L}),signal:R.current.signal});if(!d.ok)throw new Error(Ae(d.status));const h=(r=d.body)==null?void 0:r.getReader();if(!h)throw new Error("レスポンスボディがありません");const M=new TextDecoder;let N="";for(p(g=>[...g,{role:"assistant",content:""}]);;){const{done:g,value:O}=await h.read();if(g)break;const Xe=M.decode(O,{stream:!0}).split(`
`).filter(Z=>Z.startsWith("data: "));for(const Z of Xe){const xe=Z.slice(6);if(xe!=="[DONE]")try{const Ye=((x=(o=(n=JSON.parse(xe).choices)==null?void 0:n[0])==null?void 0:o.delta)==null?void 0:x.content)||"";N+=Ye,p(Ze=>{const ee=[...Ze];return ee[ee.length-1]={role:"assistant",content:N},ee})}catch{}}}m&&v(g=>g.map(O=>O.id===m?{...O,messages:[...s,{role:"assistant",content:N}],updated_at:new Date().toISOString()}:O))}else{const l={"Content-Type":"application/json"};y&&(l.Authorization=`Bearer ${y}`);const d=await fetch("/v1/chat/completions",{method:"POST",headers:l,body:JSON.stringify({model:u,messages:b,stream:!1,temperature:D,max_tokens:L}),signal:R.current.signal});if(!d.ok)throw new Error(Ae(d.status));const M={role:"assistant",content:((he=(V=(P=(await d.json()).choices)==null?void 0:P[0])==null?void 0:V.message)==null?void 0:he.content)||""};p(N=>[...N,M]),m&&v(N=>N.map(g=>g.id===m?{...g,messages:[...s,M],updated_at:new Date().toISOString()}:g))}}catch(j){j.name!=="AbortError"&&(f({title:"メッセージの送信に失敗しました",description:j instanceof Error?j.message:"不明なエラー",variant:"destructive"}),p(w))}finally{U(!1),R.current=null,(pe=ie.current)==null||pe.focus()}},We=()=>{var t;(t=R.current)==null||t.abort(),U(!1)},me=()=>{const t=T?[{role:"system",content:T},...w]:w;return`curl -X POST 'http://localhost:32768/v1/chat/completions' \\
  -H 'Content-Type: application/json' \\${y?`
  -H 'Authorization: Bearer ${y}' \\`:""}
  -d '${JSON.stringify({model:u,messages:t,stream:z,temperature:D,max_tokens:L},null,2)}'`},Ge=async t=>{try{await navigator.clipboard.writeText(t),re(!0),setTimeout(()=>re(!1),2e3),f({title:"Copied to clipboard"})}catch{f({title:"Failed to copy",variant:"destructive"})}},ue=(H||[]).filter(t=>t.lifecycle_status==="registered");return e.jsxs("div",{className:"flex h-screen bg-background",children:[e.jsxs("div",{id:"sidebar",className:k("border-r flex flex-col transition-all duration-300",J?"w-0 overflow-hidden":"w-64"),children:[e.jsx("div",{className:"p-4 border-b",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-primary/10",children:e.jsx(tt,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-semibold text-sm",children:"LLM Router"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Playground"})]})]})}),e.jsx("div",{className:"p-3",children:e.jsxs(i,{id:"new-chat",className:"w-full",onClick:Be,children:[e.jsx(ct,{className:"mr-2 h-4 w-4"}),"New Chat"]})}),e.jsx(se,{className:"flex-1",children:e.jsx("div",{id:"session-list",className:"p-2 space-y-1",children:De.map(t=>e.jsxs("div",{className:k("group flex items-center gap-2 rounded-lg px-3 py-2 cursor-pointer hover:bg-muted/50",m===t.id&&"bg-muted"),onClick:()=>Ke(t),children:[e.jsx(ye,{className:"h-4 w-4 shrink-0 text-muted-foreground"}),e.jsx("span",{className:"flex-1 truncate text-sm",children:t.title}),e.jsxs(dt,{children:[e.jsx(mt,{asChild:!0,children:e.jsx(i,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100",onClick:s=>s.stopPropagation(),children:e.jsx(Dt,{className:"h-3 w-3"})})}),e.jsx(ut,{align:"end",children:e.jsxs(ht,{onClick:s=>{s.stopPropagation(),Ue(t.id)},className:"text-destructive",children:[e.jsx(pt,{className:"mr-2 h-4 w-4"}),"Delete"]})})]})]},t.id))})}),e.jsxs("div",{className:"p-3 border-t space-y-2",children:[e.jsxs(i,{variant:"outline",className:"w-full justify-start",onClick:()=>window.location.href="/dashboard/",children:[e.jsx(Rt,{className:"mr-2 h-4 w-4"}),"Dashboard"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{variant:"ghost",size:"icon",onClick:He,children:I==="dark"?e.jsx(xt,{className:"h-4 w-4"}):e.jsx(gt,{className:"h-4 w-4"})}),e.jsx(i,{id:"settings-toggle",variant:"ghost",size:"icon",onClick:()=>q(!0),children:e.jsx(zt,{className:"h-4 w-4"})})]})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsxs("div",{className:"h-14 border-b flex items-center justify-between px-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(i,{id:"sidebar-toggle",variant:"ghost",size:"icon",onClick:Qe,title:J?"Show sidebar":"Hide sidebar",children:J?e.jsx(Ot,{className:"h-4 w-4"}):e.jsx(Pt,{className:"h-4 w-4"})}),e.jsxs(ft,{value:u,onValueChange:G,children:[e.jsx(yt,{id:"model-select",className:"w-64",children:e.jsx(jt,{placeholder:"Select a model"})}),e.jsx(vt,{children:ue.length===0?e.jsx(je,{value:"__no_models__",disabled:!0,children:"No models available"}):ue.filter(t=>t.name&&t.name.length>0).map(t=>e.jsx(je,{value:t.name,children:t.name},t.name))})]}),e.jsxs("span",{id:"router-status",className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[e.jsx(At,{className:"h-3 w-3 text-green-500"}),"Router: Online"]}),z&&e.jsx(ve,{variant:"secondary",className:"text-xs",children:"Streaming"}),!y&&e.jsx(ve,{variant:"destructive",className:"text-xs cursor-pointer",onClick:()=>q(!0),children:"API Key Required"})]}),e.jsxs(i,{id:"copy-curl",variant:"outline",size:"sm",onClick:()=>$(!0),children:[e.jsx(Tt,{className:"mr-2 h-4 w-4"}),"cURL"]})]}),e.jsx(se,{className:"flex-1 p-4",children:e.jsxs("div",{id:"chat-log",className:"max-w-3xl mx-auto space-y-4",children:[w.length===0?e.jsxs("div",{className:"chat-welcome flex flex-col items-center justify-center h-64 text-center",children:[e.jsx(ye,{className:"h-12 w-12 text-muted-foreground/50 mb-4"}),e.jsx("h2",{className:"text-lg font-medium",children:"Start a conversation"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Select a model and send a message to get started."})]}):w.map((t,s)=>e.jsxs("div",{className:k("flex gap-3",t.role==="user"?"message--user justify-end":"message--assistant"),children:[t.role==="assistant"&&e.jsx("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-primary/10",children:e.jsx(It,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{className:k("rounded-lg px-4 py-3 max-w-[80%] space-y-2",t.role==="user"?"bg-primary text-primary-foreground":"bg-muted"),children:[t.content&&e.jsx("p",{className:"message-text text-sm whitespace-pre-wrap",children:t.content}),t.attachments&&t.attachments.length>0&&e.jsx("div",{className:"grid grid-cols-2 gap-2 mt-2",children:t.attachments.map((r,n)=>e.jsxs("div",{className:"rounded-md overflow-hidden bg-black/20 p-1",children:[r.type==="image"&&e.jsx("img",{src:r.data,alt:r.name,className:"w-full h-32 object-cover rounded-sm"}),r.type==="audio"&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-32 gap-2",children:[e.jsx(Ie,{className:"h-6 w-6"}),e.jsx("audio",{src:r.data,controls:!0,className:"w-full max-w-[120px]"})]})]},n))}),t.role==="assistant"&&(()=>{const{imageMatches:r,audioMatches:n}=Je(t.content);return e.jsxs(e.Fragment,{children:[r.length>0&&e.jsx("div",{className:"grid grid-cols-2 gap-2 mt-2",children:r.map((o,x)=>e.jsx("div",{className:"rounded-md overflow-hidden bg-black/20 p-1",children:e.jsx("img",{src:o,alt:`assistant-image-${x}`,"data-testid":"playground-assistant-image",className:"w-full h-32 object-cover rounded-sm"})},x))}),n.length>0&&e.jsx("div",{className:"space-y-2 mt-2",children:n.map((o,x)=>e.jsxs("div",{className:"rounded-md overflow-hidden bg-black/20 p-2 flex flex-col items-center justify-center gap-2",children:[e.jsx(Ie,{className:"h-4 w-4"}),e.jsx("audio",{src:o,controls:!0,"data-testid":"playground-assistant-audio",className:"w-full max-w-[200px]"})]},x))})]})})()]}),t.role==="user"&&e.jsx("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-muted",children:e.jsx(st,{className:"h-4 w-4"})})]},s)),e.jsx("div",{ref:ne})]})}),e.jsx("div",{className:"border-t p-4 bg-gradient-to-b from-background via-background to-muted/5",children:e.jsxs("div",{id:"chat-form",className:"max-w-3xl mx-auto space-y-3",children:[S.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 p-3 rounded-lg bg-muted/40 border border-muted-foreground/10","data-testid":"playground-attachment-preview",children:S.map((t,s)=>e.jsxs("div",{className:"relative group inline-block rounded-md overflow-hidden bg-background border border-border","data-testid":t.type==="image"?"playground-attachment-image":"playground-attachment-audio",children:[t.type==="image"&&e.jsxs(e.Fragment,{children:[e.jsx("img",{src:t.data,alt:t.name,className:"h-16 w-16 object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/40 transition-colors flex items-center justify-center opacity-0 group-hover:opacity-100",children:e.jsx("button",{onClick:()=>ce(s),className:"text-white bg-destructive rounded-full p-1 hover:bg-destructive/80","data-testid":"playground-attachment-remove",children:e.jsx(ge,{className:"h-3 w-3"})})})]}),t.type==="audio"&&e.jsxs("div",{className:"h-16 w-16 flex flex-col items-center justify-center bg-muted gap-1",children:[e.jsx(Me,{className:"h-5 w-5 text-muted-foreground"}),e.jsx("button",{onClick:()=>ce(s),className:"absolute -top-2 -right-2 text-white bg-destructive rounded-full p-0.5 hover:bg-destructive/80","data-testid":"playground-attachment-remove",children:e.jsx(ge,{className:"h-3 w-3"})})]})]},s))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{ref:le,id:"playground-image-input","data-testid":"playground-image-input",type:"file",accept:"image/*",className:"hidden",onChange:t=>{var s;return((s=t.target.files)==null?void 0:s[0])&&Y(t.target.files[0],"image")}}),e.jsx("input",{ref:oe,id:"playground-audio-input","data-testid":"playground-audio-input",type:"file",accept:"audio/*",className:"hidden",onChange:t=>{var s;return((s=t.target.files)==null?void 0:s[0])&&Y(t.target.files[0],"audio")}}),e.jsx(i,{variant:"outline",size:"icon",onClick:()=>{var t;return(t=le.current)==null?void 0:t.click()},title:"Attach image",className:"shrink-0",children:e.jsx(Et,{className:"h-4 w-4"})}),e.jsx(i,{variant:"outline",size:"icon",onClick:()=>{var t;return(t=oe.current)==null?void 0:t.click()},title:"Attach audio",className:"shrink-0",children:e.jsx(Me,{className:"h-4 w-4"})}),e.jsx(te,{ref:ie,id:"chat-input","data-testid":"playground-chat-input",placeholder:"Type a message or attach files...",value:A,onChange:t=>ae(t.target.value),onKeyDown:t=>{t.key==="Enter"&&!t.shiftKey&&!t.nativeEvent.isComposing&&(t.preventDefault(),de())},onPaste:t=>{var r;const s=(r=t.clipboardData)==null?void 0:r.files;if(s)for(const n of Array.from(s)){const o=n.type.startsWith("audio/")?"audio":n.type.startsWith("image/")?"image":null;o&&Y(n,o)}},disabled:K,className:"flex-1"}),K?e.jsxs(i,{id:"stop-button",variant:"destructive",onClick:We,className:"shrink-0",children:[e.jsx(wt,{className:"mr-2 h-4 w-4 animate-spin"}),"Stop"]}):e.jsxs(i,{id:"send-button","data-testid":"playground-send",onClick:de,disabled:!A.trim()&&S.length===0||!u,className:"shrink-0",children:[e.jsx(qt,{className:"mr-2 h-4 w-4"}),"Send"]})]})]})})]}),e.jsx(we,{open:Re,onOpenChange:q,children:e.jsxs(be,{id:"settings-modal",children:[e.jsxs(Ne,{children:[e.jsx(ke,{children:"Settings"}),e.jsx(Ce,{children:"Configure your chat preferences."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"API Key"}),e.jsx(te,{id:"api-key-input",type:"password",placeholder:"sk-...",value:y,onChange:t=>Ve(t.target.value)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Required for OpenAI compatible API authentication"})]}),e.jsx(_,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Model Provider Filter"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:k("provider-btn flex-1 px-3 py-1.5 text-sm rounded-md border transition-colors",Q==="local"?"provider-btn--active bg-primary text-primary-foreground":"bg-muted"),"data-provider":"local",onClick:()=>W("local"),children:"Local"}),e.jsx("button",{className:k("provider-btn flex-1 px-3 py-1.5 text-sm rounded-md border transition-colors",Q==="cloud"?"provider-btn--active bg-primary text-primary-foreground":"bg-muted"),"data-provider":"cloud",onClick:()=>W("cloud"),children:"Cloud"}),e.jsx("button",{className:k("provider-btn flex-1 px-3 py-1.5 text-sm rounded-md border transition-colors",Q==="all"?"provider-btn--active bg-primary text-primary-foreground":"bg-muted"),"data-provider":"all",onClick:()=>W("all"),children:"All"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Filter models by provider type"})]}),e.jsx(_,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"System Prompt"}),e.jsx(bt,{id:"system-prompt",placeholder:"You are a helpful assistant...",value:T,onChange:t=>_e(t.target.value),rows:3})]}),e.jsx(_,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Streaming"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Stream responses as they're generated"})]}),e.jsx(Nt,{id:"stream-toggle",checked:z,onCheckedChange:qe})]}),e.jsx(_,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(C,{children:["Temperature: ",D]}),e.jsx("input",{type:"range",min:"0",max:"2",step:"0.1",value:D,onChange:t=>ze(parseFloat(t.target.value)),className:"w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Max Tokens"}),e.jsx(te,{type:"number",value:L,onChange:t=>Le(parseInt(t.target.value)||2048),min:1,max:32e3})]}),e.jsx(_,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Clear Chat"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Clear all messages in current session"})]}),e.jsxs(i,{id:"reset-chat",variant:"outline",size:"sm",onClick:$e,children:[e.jsx(_t,{className:"mr-2 h-4 w-4"}),"Reset"]})]})]}),e.jsx(Se,{children:e.jsx(i,{onClick:()=>q(!1),children:"Done"})})]})}),e.jsx(we,{open:Ee,onOpenChange:$,children:e.jsxs(be,{className:"max-w-2xl",children:[e.jsxs(Ne,{children:[e.jsx(ke,{children:"cURL Command"}),e.jsx(Ce,{children:"Copy this command to replicate the API call."})]}),e.jsxs("div",{className:"relative",children:[e.jsx(i,{variant:"ghost",size:"sm",className:"absolute right-2 top-2",onClick:()=>Ge(me()),children:Pe?e.jsx(kt,{className:"h-4 w-4"}):e.jsx(Ct,{className:"h-4 w-4"})}),e.jsx(se,{className:"h-64 rounded-md border bg-muted",children:e.jsx("pre",{className:"p-4 text-xs font-mono",children:me()})})]}),e.jsx(Se,{children:e.jsx(i,{variant:"outline",onClick:()=>$(!1),children:"Close"})})]})})]})}const Ft=new St({defaultOptions:{queries:{staleTime:3e4,retry:1}}});nt.createRoot(document.getElementById("root")).render(e.jsx(a.StrictMode,{children:e.jsx(Mt,{client:Ft,children:e.jsxs(it,{children:[e.jsx(Lt,{}),e.jsx(lt,{})]})})}));
