# SPEC-08d2b908: モデル管理（統合仕様）

**ステータス**: 実装完了

## この仕様の役割（初見向け）
この仕様は**モデル管理の入口ガイド**です。  
「登録/配布/保存/同期」の責務境界と禁止事項をまとめ、詳細は下記の個別SPECに委譲します。

## 背景 / 問題
モデル管理に関する要件が複数SPECに分散しており、重複や矛盾が起きやすい。
登録・配布・保存・同期の責務を統合的に定義し、実行エンジン領域と明確に分離する必要がある。

## 目的
- モデル管理（登録/配布/保存/同期）の責務境界を明確化する
- safetensors/GGUF/Metal などの**アーティファクト選択はNode側**に集約する
- /v1/models の可視性や削除・重複の扱いを一貫させる

## スコープ
- ルーター側の登録フロー（URL入力・重複・削除・一覧）
- Node側のモデル解決・キャッシュルール
- /v1/models の ready 判定と削除整合

## 非ゴール
- 推論エンジンの選択/実装
- 自動変換（非GGUF→GGUF）や量子化生成
- ルーター側のモデルバイナリキャッシュ

## 原則
- ルーターは**登録メタデータとマニフェストのみ**を保持する
- **モデルキャッシュはNode主導**（GPU差分に応じて必要アーティファクトを選択・取得）
- ルーター側の**変換パイプラインは廃止**（登録時に変換しない）
- `config.json` や `tokenizer.json` などHF由来メタデータを正とする

## 決定事項（共有用サマリ）
- **ルーターは形式選択を行わない**。Nodeがruntime/GPU要件に応じて選択する。
- **ダウンロード主体**: Node が外部ソース（HF等）から直接ダウンロードし、
  ルーターはバイナリを保持しない。
- **マニフェスト**: ルーターはHFのファイル一覧をマニフェストとして提供する。
- **ready判定**: /v1/models の ready は Node の同期結果に基づく。

## 詳細仕様（参照）
- **モデルストレージと解決**: `SPEC-dcaeaec4`, `SPEC-48678000`
- **HF URL登録**: `SPEC-11106000`
- **ready判定/削除整合**: `SPEC-6c2d9f1e`
- **旧仕様（形式選択）**: `SPEC-a61b24f2`（廃止）

## 受け入れ条件
1. 登録・保存・同期のルールが相互に矛盾しない。
2. /v1/models は登録済みモデルを返し、ready はNode同期結果に従う。
3. 変換やルーター側のバイナリ保持が行われない。

## 依存関係
- `SPEC-dcaeaec4`（モデルストレージ）
- `SPEC-11106000`（登録フロー）
- `SPEC-48678000`（モデル解決）
- `SPEC-6c2d9f1e`（ready/削除の整合）
