# 技術リサーチ: SPEC-68551ec8 Hugging Face URL 登録（変換なし）

## リサーチ課題
1. HF API へのアクセス方法と認証要否（repoメタ/ファイル一覧）。
2. 対応モデルIDの命名規則（repo / ファイル名の組み立て）。
3. ロードバランサー側のメタデータ取得とキャッシュ戦略。

## 調査結果と決定

### 1) HF API アクセス / 認証
- HF Hub 公開モデルは匿名でも取得可能だが、レートリミット回避のため
  `Authorization: Bearer <HF_TOKEN>` を許可する。
- 取得対象は **repoメタデータとファイル一覧（siblings）** のみ。
  カタログ一覧APIは利用しない。
- トークン未設定時は匿名で試行し、429/401 時に「トークン設定を推奨」メッセージを返す。

### 2) モデルID命名規則
- 対応モデルIDは衝突回避と一意性を優先し、`hf/<repo>` を基本形とする。
- ファイルURL登録時は `hf/<repo>/<filename>` を採用する。
- UI表示名は repo をベースに短縮表示し、IDはフルパスで保持する。

### 3) メタデータ取得とキャッシュ
- HF API 呼び出しは登録時のみ実行（1操作=1リクエストを目安）。
- 失敗時は直近のキャッシュを返し、最新でないことを明示する。
- キャッシュはメモリ + TTL 5分を推奨（実装詳細はrouter側で決定）。

## 検討した代替案
- **モデルIDを repo:tag 形式にする**: ファイル名を区別できず誤解を生むため却下。
- **常時匿名アクセスのみ**: レートリミット回避の余地がなく運用で詰まるため却下。

## 未決事項（要明確化）
- ファイル一覧の取得失敗時に、登録をブロックするか警告で通すか。
