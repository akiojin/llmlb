# 機能仕様書: 管理ダッシュボード

**機能ID**: `SPEC-712c20cf`
**作成日**: 2025-10-30
**ステータス**: 未実装
**元のSPEC**: SPEC-32e2b31a から分割
**依存SPEC**: SPEC-94621a1f, SPEC-63acef08, SPEC-443acc8c

## 概要

WebブラウザからアクセスできるリアルタイムダッシュボードUI。エージェントの状態、リクエスト処理状況、パフォーマンスメトリクスを可視化する。

## ユーザーシナリオ＆テスト

### ユーザーストーリー - 管理ダッシュボードとリアルタイム監視

ユーザーはWebブラウザからコーディネーターのダッシュボードにアクセスし、すべてのエージェントの状態、リクエスト処理状況、パフォーマンスメトリクスをリアルタイムで確認できる。

**この優先度の理由**: システムがAPI経由で動作していれば、ダッシュボードは可視化のための追加機能。運用初期はログやAPIレスポンスで状態確認が可能。

**独立テスト**: ブラウザでダッシュボードにアクセスし、エージェント情報が表示されることで価値を提供する。

**受け入れシナリオ**:

1. **前提** コーディネーターが起動している、**実行** ブラウザで`http://coordinator:8080/dashboard`にアクセスする、**結果** ダッシュボードが表示され、登録済みエージェントの一覧が確認できる
2. **前提** 複数のエージェントが登録されている、**実行** ダッシュボードでエージェント一覧を確認する、**結果** 各エージェントのマシン名、IPアドレス、Ollamaバージョン、稼働時間、状態（オンライン/オフライン）が表示される
3. **前提** エージェントがリクエストを処理中、**実行** ダッシュボードをリロードする、**結果** リアルタイムでリクエスト処理数、レスポンスタイム、エラー数が更新される
4. **前提** ダッシュボードを表示中、**実行** 新しいエージェントが登録される、**結果** ページをリロードせずに新しいエージェントが一覧に自動追加される

## 機能要件

### FR-017: ダッシュボードUI

Webブラウザでアクセス可能なダッシュボード画面を提供する。

- エンドポイント: `GET /dashboard`
- 技術スタック: HTML + JavaScript + CSS（フレームワークはシンプルさを優先）
- レスポンシブデザイン対応

### FR-018: エージェント一覧表示

登録されたすべてのエージェントを一覧表示する。

- 表示項目:
  - マシン名
  - IPアドレス
  - Ollamaバージョン
  - ステータス（オンライン/オフライン）
  - 最終確認時刻
  - 稼働時間
- ソート機能: マシン名、ステータスでソート可能

### FR-019: リアルタイム更新

ダッシュボードの情報を自動的に更新する。

- 更新間隔: 5秒ごと
- 更新方法: WebSocketまたはポーリング
- ページリロード不要

### FR-020: パフォーマンスメトリクス表示

各エージェントのパフォーマンス情報を可視化する。

- 表示メトリクス:
  - CPU使用率（グラフ）
  - メモリ使用率（グラフ）
  - 処理中のリクエスト数
  - 総リクエスト処理数
  - 平均レスポンスタイム
  - エラー率

### FR-021: システム統計

システム全体の統計情報を表示する。

- 統計項目:
  - 登録エージェント総数
  - オンラインエージェント数
  - 総リクエスト処理数
  - 平均レスポンスタイム
  - エラー総数

### FR-022: エージェント詳細ビュー

特定のエージェントの詳細情報を表示する。

- 詳細情報:
  - システム情報（OS、CPU、メモリ）
  - Ollama設定
  - 処理履歴
  - エラーログ

## 非機能要件

### NFR-010: ユーザビリティ

- 直感的なUI設計
- 5秒以内にシステム全体の状態を把握可能
- モバイルデバイスからもアクセス可能

### NFR-011: パフォーマンス

- 初回ロード時間: 2秒以内
- リアルタイム更新のレイテンシ: 100ms以内

### NFR-012: アクセシビリティ

- WCAG 2.1 Level AAに準拠
- スクリーンリーダー対応

## 実装状態

### 🚧 未実装（将来の拡張）

すべての機能が未実装です。以下の順序で実装を推奨：

1. **Phase 1: 基本UI**
   - 静的HTMLダッシュボード
   - エージェント一覧表示
   - 手動リフレッシュ

2. **Phase 2: リアルタイム更新**
   - 自動ポーリング
   - WebSocket統合
   - リアルタイムステータス更新

3. **Phase 3: メトリクス可視化**
   - パフォーマンスグラフ
   - 統計サマリー
   - 履歴データ表示

4. **Phase 4: 高度な機能**
   - エージェント詳細ビュー
   - フィルタリング＆検索
   - エクスポート機能

## 技術提案

### フロントエンド
- **オプション1**: Vanilla JS + Chart.js（シンプル、依存少ない）
- **オプション2**: React + Recharts（リッチなUI、保守性高い）
- **オプション3**: Vue.js + ECharts（学習コスト低い、日本語ドキュメント豊富）

### リアルタイム通信
- **オプション1**: WebSocket（双方向通信、低レイテンシ）
- **オプション2**: Server-Sent Events（シンプル、片方向通信）
- **オプション3**: ポーリング（実装簡単、レイテンシ高い）

### 推奨スタック
初期実装は**Vanilla JS + Chart.js + ポーリング**で開始し、必要に応じてWebSocketに移行することを推奨します。
